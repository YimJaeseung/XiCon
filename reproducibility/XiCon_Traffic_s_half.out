Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.0001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.5, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.1108
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2226713
	speed: 0.0231s/iter; left time: 360.8515s
Epoch: 1 cost time: 3.2262625694274902
Epoch: 1, Steps: 157 Train Loss: 0.3032 (Forecasting Loss:0.3029 + XiCon Loss:2.5220 x Lambda(0.0001)), Vali MSE Loss: 0.2370 Test MSE Loss: 0.3368
Validation loss decreased (inf --> 0.236991).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1325103
	speed: 0.0196s/iter; left time: 302.8035s
Epoch: 2 cost time: 2.854901075363159
Epoch: 2, Steps: 157 Train Loss: 0.1433 (Forecasting Loss:0.1430 + XiCon Loss:2.5270 x Lambda(0.0001)), Vali MSE Loss: 0.1462 Test MSE Loss: 0.2002
Validation loss decreased (0.236991 --> 0.146178).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1108246
	speed: 0.0158s/iter; left time: 241.3701s
Epoch: 3 cost time: 2.3762636184692383
Epoch: 3, Steps: 157 Train Loss: 0.1131 (Forecasting Loss:0.1129 + XiCon Loss:2.5243 x Lambda(0.0001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1845
Validation loss decreased (0.146178 --> 0.130425).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1225417
	speed: 0.0169s/iter; left time: 256.3755s
Epoch: 4 cost time: 2.5107221603393555
Epoch: 4, Steps: 157 Train Loss: 0.1053 (Forecasting Loss:0.1051 + XiCon Loss:2.5225 x Lambda(0.0001)), Vali MSE Loss: 0.1261 Test MSE Loss: 0.1780
Validation loss decreased (0.130425 --> 0.126095).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1004087
	speed: 0.0172s/iter; left time: 257.2570s
Epoch: 5 cost time: 2.6147897243499756
Epoch: 5, Steps: 157 Train Loss: 0.1016 (Forecasting Loss:0.1014 + XiCon Loss:2.5307 x Lambda(0.0001)), Vali MSE Loss: 0.1242 Test MSE Loss: 0.1743
Validation loss decreased (0.126095 --> 0.124169).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0844271
	speed: 0.0170s/iter; left time: 251.5920s
Epoch: 6 cost time: 2.648869514465332
Epoch: 6, Steps: 157 Train Loss: 0.0998 (Forecasting Loss:0.0995 + XiCon Loss:2.5367 x Lambda(0.0001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1740
Validation loss decreased (0.124169 --> 0.123302).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0931110
	speed: 0.0175s/iter; left time: 256.6107s
Epoch: 7 cost time: 2.558840036392212
Epoch: 7, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0984 + XiCon Loss:2.5449 x Lambda(0.0001)), Vali MSE Loss: 0.1226 Test MSE Loss: 0.1724
Validation loss decreased (0.123302 --> 0.122598).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.0939853
	speed: 0.0172s/iter; left time: 249.3205s
Epoch: 8 cost time: 2.530665397644043
Epoch: 8, Steps: 157 Train Loss: 0.0981 (Forecasting Loss:0.0979 + XiCon Loss:2.5405 x Lambda(0.0001)), Vali MSE Loss: 0.1231 Test MSE Loss: 0.1725
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0972828
	speed: 0.0166s/iter; left time: 237.5465s
Epoch: 9 cost time: 2.526027202606201
Epoch: 9, Steps: 157 Train Loss: 0.0980 (Forecasting Loss:0.0977 + XiCon Loss:2.5485 x Lambda(0.0001)), Vali MSE Loss: 0.1221 Test MSE Loss: 0.1713
Validation loss decreased (0.122598 --> 0.122104).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0977202
	speed: 0.0169s/iter; left time: 240.0269s
Epoch: 10 cost time: 2.5516574382781982
Epoch: 10, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0975 + XiCon Loss:2.5451 x Lambda(0.0001)), Vali MSE Loss: 0.1229 Test MSE Loss: 0.1714
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0980140
	speed: 0.0161s/iter; left time: 225.6666s
Epoch: 11 cost time: 2.386591672897339
Epoch: 11, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5477 x Lambda(0.0001)), Vali MSE Loss: 0.1225 Test MSE Loss: 0.1714
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1021308
	speed: 0.0161s/iter; left time: 223.9291s
Epoch: 12 cost time: 2.431644916534424
Epoch: 12, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5432 x Lambda(0.0001)), Vali MSE Loss: 0.1224 Test MSE Loss: 0.1712
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0982616
	speed: 0.0175s/iter; left time: 239.5754s
Epoch: 13 cost time: 2.5972683429718018
Epoch: 13, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5489 x Lambda(0.0001)), Vali MSE Loss: 0.1225 Test MSE Loss: 0.1712
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1178308
	speed: 0.0159s/iter; left time: 216.1345s
Epoch: 14 cost time: 2.358386993408203
Epoch: 14, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5434 x Lambda(0.0001)), Vali MSE Loss: 0.1226 Test MSE Loss: 0.1713
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1053889
	speed: 0.0164s/iter; left time: 219.4430s
Epoch: 15 cost time: 2.418764352798462
Epoch: 15, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5494 x Lambda(0.0001)), Vali MSE Loss: 0.1226 Test MSE Loss: 0.1712
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1008270
	speed: 0.0171s/iter; left time: 226.0446s
Epoch: 16 cost time: 2.54776668548584
Epoch: 16, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5474 x Lambda(0.0001)), Vali MSE Loss: 0.1225 Test MSE Loss: 0.1712
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0945326
	speed: 0.0164s/iter; left time: 214.5845s
Epoch: 17 cost time: 2.444775342941284
Epoch: 17, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5488 x Lambda(0.0001)), Vali MSE Loss: 0.1225 Test MSE Loss: 0.1712
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1090490
	speed: 0.0163s/iter; left time: 211.1646s
Epoch: 18 cost time: 2.459571123123169
Epoch: 18, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5506 x Lambda(0.0001)), Vali MSE Loss: 0.1226 Test MSE Loss: 0.1712
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0878408
	speed: 0.0183s/iter; left time: 234.1957s
Epoch: 19 cost time: 2.698930025100708
Epoch: 19, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5536 x Lambda(0.0001)), Vali MSE Loss: 0.1224 Test MSE Loss: 0.1712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.1330537348985672, mae:0.20960542559623718, mape:0.4914204478263855, mspe:13.169573783874512 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8698
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2256693
	speed: 0.0183s/iter; left time: 285.8066s
Epoch: 1 cost time: 2.8636958599090576
Epoch: 1, Steps: 157 Train Loss: 0.2948 (Forecasting Loss:0.2946 + XiCon Loss:2.5122 x Lambda(0.0001)), Vali MSE Loss: 0.2281 Test MSE Loss: 0.3268
Validation loss decreased (inf --> 0.228131).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1401943
	speed: 0.0182s/iter; left time: 280.6443s
Epoch: 2 cost time: 2.6929280757904053
Epoch: 2, Steps: 157 Train Loss: 0.1420 (Forecasting Loss:0.1418 + XiCon Loss:2.5527 x Lambda(0.0001)), Vali MSE Loss: 0.1403 Test MSE Loss: 0.1999
Validation loss decreased (0.228131 --> 0.140319).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1193457
	speed: 0.0164s/iter; left time: 250.4303s
Epoch: 3 cost time: 2.4501445293426514
Epoch: 3, Steps: 157 Train Loss: 0.1114 (Forecasting Loss:0.1111 + XiCon Loss:2.5441 x Lambda(0.0001)), Vali MSE Loss: 0.1238 Test MSE Loss: 0.1781
Validation loss decreased (0.140319 --> 0.123787).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.0879436
	speed: 0.0173s/iter; left time: 261.0244s
Epoch: 4 cost time: 2.544241428375244
Epoch: 4, Steps: 157 Train Loss: 0.1042 (Forecasting Loss:0.1040 + XiCon Loss:2.5399 x Lambda(0.0001)), Vali MSE Loss: 0.1183 Test MSE Loss: 0.1713
Validation loss decreased (0.123787 --> 0.118290).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0866628
	speed: 0.0180s/iter; left time: 269.4710s
Epoch: 5 cost time: 2.641726016998291
Epoch: 5, Steps: 157 Train Loss: 0.1007 (Forecasting Loss:0.1005 + XiCon Loss:2.5511 x Lambda(0.0001)), Vali MSE Loss: 0.1153 Test MSE Loss: 0.1676
Validation loss decreased (0.118290 --> 0.115312).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0943045
	speed: 0.0178s/iter; left time: 263.4123s
Epoch: 6 cost time: 2.6438751220703125
Epoch: 6, Steps: 157 Train Loss: 0.0990 (Forecasting Loss:0.0987 + XiCon Loss:2.5468 x Lambda(0.0001)), Vali MSE Loss: 0.1143 Test MSE Loss: 0.1654
Validation loss decreased (0.115312 --> 0.114296).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1100061
	speed: 0.0166s/iter; left time: 243.6446s
Epoch: 7 cost time: 2.487665891647339
Epoch: 7, Steps: 157 Train Loss: 0.0980 (Forecasting Loss:0.0978 + XiCon Loss:2.5505 x Lambda(0.0001)), Vali MSE Loss: 0.1137 Test MSE Loss: 0.1645
Validation loss decreased (0.114296 --> 0.113713).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1017918
	speed: 0.0162s/iter; left time: 234.5387s
Epoch: 8 cost time: 2.436169385910034
Epoch: 8, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5403 x Lambda(0.0001)), Vali MSE Loss: 0.1134 Test MSE Loss: 0.1641
Validation loss decreased (0.113713 --> 0.113353).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1007358
	speed: 0.0174s/iter; left time: 249.1969s
Epoch: 9 cost time: 2.5389435291290283
Epoch: 9, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0970 + XiCon Loss:2.5426 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1640
Validation loss decreased (0.113353 --> 0.112996).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0917522
	speed: 0.0163s/iter; left time: 231.7130s
Epoch: 10 cost time: 2.48432993888855
Epoch: 10, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0969 + XiCon Loss:2.5526 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1640
Validation loss decreased (0.112996 --> 0.112948).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0994680
	speed: 0.0167s/iter; left time: 233.8558s
Epoch: 11 cost time: 2.5522468090057373
Epoch: 11, Steps: 157 Train Loss: 0.0971 (Forecasting Loss:0.0969 + XiCon Loss:2.5455 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1639
Validation loss decreased (0.112948 --> 0.112946).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1064512
	speed: 0.0176s/iter; left time: 244.7873s
Epoch: 12 cost time: 2.594104290008545
Epoch: 12, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0968 + XiCon Loss:2.5533 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
Validation loss decreased (0.112946 --> 0.112850).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0969320
	speed: 0.0174s/iter; left time: 238.6186s
Epoch: 13 cost time: 2.583315134048462
Epoch: 13, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0968 + XiCon Loss:2.5488 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0923624
	speed: 0.0165s/iter; left time: 223.8593s
Epoch: 14 cost time: 2.498227834701538
Epoch: 14, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5543 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1639
Validation loss decreased (0.112850 --> 0.112744).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.0930216
	speed: 0.0174s/iter; left time: 233.6249s
Epoch: 15 cost time: 2.603126287460327
Epoch: 15, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5470 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1033051
	speed: 0.0186s/iter; left time: 245.8885s
Epoch: 16 cost time: 3.3579137325286865
Epoch: 16, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5485 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1639
Validation loss decreased (0.112744 --> 0.112694).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0952285
	speed: 0.0492s/iter; left time: 643.7710s
Epoch: 17 cost time: 6.763006925582886
Epoch: 17, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5443 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1639
Validation loss decreased (0.112694 --> 0.112669).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1035177
	speed: 0.0159s/iter; left time: 206.2265s
Epoch: 18 cost time: 2.373990535736084
Epoch: 18, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0965 + XiCon Loss:2.5540 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1639
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1082844
	speed: 0.0145s/iter; left time: 185.7233s
Epoch: 19 cost time: 2.1150283813476562
Epoch: 19, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5463 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.0803800
	speed: 0.0147s/iter; left time: 185.5383s
Epoch: 20 cost time: 2.3484132289886475
Epoch: 20, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5540 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1639
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1129853
	speed: 0.0166s/iter; left time: 206.4676s
Epoch: 21 cost time: 2.4694972038269043
Epoch: 21, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5513 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.0945594
	speed: 0.0167s/iter; left time: 205.7108s
Epoch: 22 cost time: 2.5085794925689697
Epoch: 22, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5492 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1639
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1051444
	speed: 0.0169s/iter; left time: 204.8968s
Epoch: 23 cost time: 2.479600667953491
Epoch: 23, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5475 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1639
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1018586
	speed: 0.0185s/iter; left time: 221.4765s
Epoch: 24 cost time: 2.65401554107666
Epoch: 24, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5570 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.0899443
	speed: 0.0180s/iter; left time: 213.5544s
Epoch: 25 cost time: 2.7339746952056885
Epoch: 25, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5477 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1639
Validation loss decreased (0.112669 --> 0.112660).  Saving model ...
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.0988439
	speed: 0.0168s/iter; left time: 196.2059s
Epoch: 26 cost time: 2.5275402069091797
Epoch: 26, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5514 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1030622
	speed: 0.0171s/iter; left time: 197.1431s
Epoch: 27 cost time: 2.5358035564422607
Epoch: 27, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5536 x Lambda(0.0001)), Vali MSE Loss: 0.1126 Test MSE Loss: 0.1639
Validation loss decreased (0.112660 --> 0.112636).  Saving model ...
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.0889647
	speed: 0.0172s/iter; left time: 195.0833s
Epoch: 28 cost time: 2.5343921184539795
Epoch: 28, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5524 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1639
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1050611
	speed: 0.0170s/iter; left time: 190.9592s
Epoch: 29 cost time: 2.5583927631378174
Epoch: 29, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0968 + XiCon Loss:2.5494 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.0986256
	speed: 0.0163s/iter; left time: 180.4346s
Epoch: 30 cost time: 2.4314563274383545
Epoch: 30, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5494 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1639
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.0936671
	speed: 0.0179s/iter; left time: 195.2965s
Epoch: 31 cost time: 2.6108500957489014
Epoch: 31, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5552 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1639
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.0909424
	speed: 0.0175s/iter; left time: 188.0836s
Epoch: 32 cost time: 2.598649024963379
Epoch: 32, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5504 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.0990943
	speed: 0.0167s/iter; left time: 176.1403s
Epoch: 33 cost time: 2.5397305488586426
Epoch: 33, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5484 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1639
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.0830198
	speed: 0.0173s/iter; left time: 180.1277s
Epoch: 34 cost time: 2.5548999309539795
Epoch: 34, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5519 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1639
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.820766091346741e-13
	iters: 100, epoch: 35 | loss: 0.1080526
	speed: 0.0171s/iter; left time: 175.1009s
Epoch: 35 cost time: 2.5172693729400635
Epoch: 35, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5492 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.9103830456733704e-13
	iters: 100, epoch: 36 | loss: 0.1050583
	speed: 0.0178s/iter; left time: 179.8457s
Epoch: 36 cost time: 2.609846830368042
Epoch: 36, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5536 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4551915228366852e-13
	iters: 100, epoch: 37 | loss: 0.1058818
	speed: 0.0176s/iter; left time: 174.6711s
Epoch: 37 cost time: 2.5780446529388428
Epoch: 37, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5544 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.12828515470027924, mae:0.1994360238313675, mape:0.44371700286865234, mspe:8.021966934204102 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7992
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2274423
	speed: 0.0175s/iter; left time: 272.9332s
Epoch: 1 cost time: 2.589570999145508
Epoch: 1, Steps: 157 Train Loss: 0.3187 (Forecasting Loss:0.3184 + XiCon Loss:2.5376 x Lambda(0.0001)), Vali MSE Loss: 0.2324 Test MSE Loss: 0.3325
Validation loss decreased (inf --> 0.232378).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1345910
	speed: 0.0180s/iter; left time: 278.4433s
Epoch: 2 cost time: 2.731069564819336
Epoch: 2, Steps: 157 Train Loss: 0.1451 (Forecasting Loss:0.1448 + XiCon Loss:2.6068 x Lambda(0.0001)), Vali MSE Loss: 0.1423 Test MSE Loss: 0.2003
Validation loss decreased (0.232378 --> 0.142315).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1094802
	speed: 0.0174s/iter; left time: 266.1790s
Epoch: 3 cost time: 2.6411190032958984
Epoch: 3, Steps: 157 Train Loss: 0.1130 (Forecasting Loss:0.1127 + XiCon Loss:2.5659 x Lambda(0.0001)), Vali MSE Loss: 0.1287 Test MSE Loss: 0.1810
Validation loss decreased (0.142315 --> 0.128701).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1041091
	speed: 0.0177s/iter; left time: 267.9920s
Epoch: 4 cost time: 2.632166624069214
Epoch: 4, Steps: 157 Train Loss: 0.1063 (Forecasting Loss:0.1061 + XiCon Loss:2.5605 x Lambda(0.0001)), Vali MSE Loss: 0.1273 Test MSE Loss: 0.1771
Validation loss decreased (0.128701 --> 0.127274).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0946719
	speed: 0.0176s/iter; left time: 263.1594s
Epoch: 5 cost time: 2.567394733428955
Epoch: 5, Steps: 157 Train Loss: 0.1027 (Forecasting Loss:0.1025 + XiCon Loss:2.5411 x Lambda(0.0001)), Vali MSE Loss: 0.1241 Test MSE Loss: 0.1737
Validation loss decreased (0.127274 --> 0.124108).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0994529
	speed: 0.0179s/iter; left time: 264.8806s
Epoch: 6 cost time: 2.6140098571777344
Epoch: 6, Steps: 157 Train Loss: 0.1009 (Forecasting Loss:0.1007 + XiCon Loss:2.5388 x Lambda(0.0001)), Vali MSE Loss: 0.1243 Test MSE Loss: 0.1720
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0986205
	speed: 0.0171s/iter; left time: 250.6545s
Epoch: 7 cost time: 2.6189920902252197
Epoch: 7, Steps: 157 Train Loss: 0.0999 (Forecasting Loss:0.0996 + XiCon Loss:2.5257 x Lambda(0.0001)), Vali MSE Loss: 0.1209 Test MSE Loss: 0.1691
Validation loss decreased (0.124108 --> 0.120865).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.0868379
	speed: 0.0199s/iter; left time: 288.8543s
Epoch: 8 cost time: 2.8425445556640625
Epoch: 8, Steps: 157 Train Loss: 0.0994 (Forecasting Loss:0.0991 + XiCon Loss:2.5273 x Lambda(0.0001)), Vali MSE Loss: 0.1230 Test MSE Loss: 0.1710
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0902809
	speed: 0.0174s/iter; left time: 249.2604s
Epoch: 9 cost time: 2.5430333614349365
Epoch: 9, Steps: 157 Train Loss: 0.0991 (Forecasting Loss:0.0988 + XiCon Loss:2.5311 x Lambda(0.0001)), Vali MSE Loss: 0.1223 Test MSE Loss: 0.1698
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0985195
	speed: 0.0167s/iter; left time: 236.5516s
Epoch: 10 cost time: 2.4987339973449707
Epoch: 10, Steps: 157 Train Loss: 0.0989 (Forecasting Loss:0.0986 + XiCon Loss:2.5329 x Lambda(0.0001)), Vali MSE Loss: 0.1218 Test MSE Loss: 0.1691
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1021144
	speed: 0.0178s/iter; left time: 249.8239s
Epoch: 11 cost time: 2.5527565479278564
Epoch: 11, Steps: 157 Train Loss: 0.0989 (Forecasting Loss:0.0986 + XiCon Loss:2.5301 x Lambda(0.0001)), Vali MSE Loss: 0.1220 Test MSE Loss: 0.1694
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1071353
	speed: 0.0180s/iter; left time: 249.5088s
Epoch: 12 cost time: 2.600579023361206
Epoch: 12, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0986 + XiCon Loss:2.5289 x Lambda(0.0001)), Vali MSE Loss: 0.1224 Test MSE Loss: 0.1698
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0884782
	speed: 0.0169s/iter; left time: 231.6754s
Epoch: 13 cost time: 2.552469491958618
Epoch: 13, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0984 + XiCon Loss:2.5238 x Lambda(0.0001)), Vali MSE Loss: 0.1224 Test MSE Loss: 0.1697
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1013087
	speed: 0.0176s/iter; left time: 239.3334s
Epoch: 14 cost time: 2.6381020545959473
Epoch: 14, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0985 + XiCon Loss:2.5311 x Lambda(0.0001)), Vali MSE Loss: 0.1224 Test MSE Loss: 0.1698
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.0943045
	speed: 0.0179s/iter; left time: 240.0483s
Epoch: 15 cost time: 2.6259756088256836
Epoch: 15, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0985 + XiCon Loss:2.5379 x Lambda(0.0001)), Vali MSE Loss: 0.1225 Test MSE Loss: 0.1697
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0925660
	speed: 0.0212s/iter; left time: 280.6302s
Epoch: 16 cost time: 3.12145733833313
Epoch: 16, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0984 + XiCon Loss:2.5283 x Lambda(0.0001)), Vali MSE Loss: 0.1223 Test MSE Loss: 0.1697
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0962214
	speed: 0.0194s/iter; left time: 253.6707s
Epoch: 17 cost time: 2.854353904724121
Epoch: 17, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5280 x Lambda(0.0001)), Vali MSE Loss: 0.1224 Test MSE Loss: 0.1697
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.13138605654239655, mae:0.20679336786270142, mape:0.5009099841117859, mspe:14.657689094543457 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0070
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2473930
	speed: 0.0178s/iter; left time: 277.7817s
Epoch: 1 cost time: 2.5853686332702637
Epoch: 1, Steps: 157 Train Loss: 0.3234 (Forecasting Loss:0.3232 + XiCon Loss:2.5248 x Lambda(0.0001)), Vali MSE Loss: 0.2383 Test MSE Loss: 0.3411
Validation loss decreased (inf --> 0.238345).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1153424
	speed: 0.0161s/iter; left time: 249.3037s
Epoch: 2 cost time: 2.4503960609436035
Epoch: 2, Steps: 157 Train Loss: 0.1441 (Forecasting Loss:0.1439 + XiCon Loss:2.6034 x Lambda(0.0001)), Vali MSE Loss: 0.1417 Test MSE Loss: 0.2007
Validation loss decreased (0.238345 --> 0.141710).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1077934
	speed: 0.0166s/iter; left time: 254.5012s
Epoch: 3 cost time: 2.4740140438079834
Epoch: 3, Steps: 157 Train Loss: 0.1127 (Forecasting Loss:0.1125 + XiCon Loss:2.6018 x Lambda(0.0001)), Vali MSE Loss: 0.1261 Test MSE Loss: 0.1821
Validation loss decreased (0.141710 --> 0.126092).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.0962243
	speed: 0.0182s/iter; left time: 275.0577s
Epoch: 4 cost time: 2.675614833831787
Epoch: 4, Steps: 157 Train Loss: 0.1048 (Forecasting Loss:0.1045 + XiCon Loss:2.5904 x Lambda(0.0001)), Vali MSE Loss: 0.1198 Test MSE Loss: 0.1769
Validation loss decreased (0.126092 --> 0.119844).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0991525
	speed: 0.0176s/iter; left time: 263.3764s
Epoch: 5 cost time: 2.6082499027252197
Epoch: 5, Steps: 157 Train Loss: 0.1016 (Forecasting Loss:0.1014 + XiCon Loss:2.6008 x Lambda(0.0001)), Vali MSE Loss: 0.1171 Test MSE Loss: 0.1714
Validation loss decreased (0.119844 --> 0.117115).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0945602
	speed: 0.0175s/iter; left time: 259.4692s
Epoch: 6 cost time: 2.6164393424987793
Epoch: 6, Steps: 157 Train Loss: 0.0998 (Forecasting Loss:0.0996 + XiCon Loss:2.5927 x Lambda(0.0001)), Vali MSE Loss: 0.1148 Test MSE Loss: 0.1680
Validation loss decreased (0.117115 --> 0.114765).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1034608
	speed: 0.0167s/iter; left time: 245.3869s
Epoch: 7 cost time: 2.5359508991241455
Epoch: 7, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0985 + XiCon Loss:2.5906 x Lambda(0.0001)), Vali MSE Loss: 0.1139 Test MSE Loss: 0.1675
Validation loss decreased (0.114765 --> 0.113943).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1088943
	speed: 0.0170s/iter; left time: 246.1577s
Epoch: 8 cost time: 2.493720769882202
Epoch: 8, Steps: 157 Train Loss: 0.0983 (Forecasting Loss:0.0981 + XiCon Loss:2.5915 x Lambda(0.0001)), Vali MSE Loss: 0.1136 Test MSE Loss: 0.1663
Validation loss decreased (0.113943 --> 0.113562).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0863153
	speed: 0.0179s/iter; left time: 256.7599s
Epoch: 9 cost time: 2.591238021850586
Epoch: 9, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0977 + XiCon Loss:2.5914 x Lambda(0.0001)), Vali MSE Loss: 0.1133 Test MSE Loss: 0.1663
Validation loss decreased (0.113562 --> 0.113280).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0903577
	speed: 0.0165s/iter; left time: 233.6947s
Epoch: 10 cost time: 2.48211932182312
Epoch: 10, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0976 + XiCon Loss:2.5851 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
Validation loss decreased (0.113280 --> 0.113229).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0872940
	speed: 0.0164s/iter; left time: 230.6882s
Epoch: 11 cost time: 2.475403070449829
Epoch: 11, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5930 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1661
Validation loss decreased (0.113229 --> 0.113201).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.0997738
	speed: 0.0181s/iter; left time: 250.7104s
Epoch: 12 cost time: 2.6697723865509033
Epoch: 12, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0975 + XiCon Loss:2.5956 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1660
Validation loss decreased (0.113201 --> 0.113100).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1179759
	speed: 0.0170s/iter; left time: 232.5274s
Epoch: 13 cost time: 2.4559414386749268
Epoch: 13, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5982 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0981011
	speed: 0.0189s/iter; left time: 256.9373s
Epoch: 14 cost time: 2.718675136566162
Epoch: 14, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5913 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1100418
	speed: 0.0171s/iter; left time: 229.0626s
Epoch: 15 cost time: 2.505855083465576
Epoch: 15, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.6001 x Lambda(0.0001)), Vali MSE Loss: 0.1133 Test MSE Loss: 0.1660
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0984688
	speed: 0.0181s/iter; left time: 239.6988s
Epoch: 16 cost time: 2.678924560546875
Epoch: 16, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5892 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1660
Validation loss decreased (0.113100 --> 0.113064).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0862916
	speed: 0.0307s/iter; left time: 401.8364s
Epoch: 17 cost time: 6.196533679962158
Epoch: 17, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.6007 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.0940847
	speed: 0.0367s/iter; left time: 473.9783s
Epoch: 18 cost time: 4.51518702507019
Epoch: 18, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5965 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1010975
	speed: 0.0161s/iter; left time: 205.7338s
Epoch: 19 cost time: 2.3079116344451904
Epoch: 19, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5922 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.0930713
	speed: 0.0142s/iter; left time: 178.9472s
Epoch: 20 cost time: 2.097172975540161
Epoch: 20, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5885 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1118852
	speed: 0.0168s/iter; left time: 209.7981s
Epoch: 21 cost time: 2.5400190353393555
Epoch: 21, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5852 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1083680
	speed: 0.0174s/iter; left time: 214.5967s
Epoch: 22 cost time: 2.5733399391174316
Epoch: 22, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0972 + XiCon Loss:2.5856 x Lambda(0.0001)), Vali MSE Loss: 0.1133 Test MSE Loss: 0.1660
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.0868392
	speed: 0.0178s/iter; left time: 215.8155s
Epoch: 23 cost time: 2.6105363368988037
Epoch: 23, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5939 x Lambda(0.0001)), Vali MSE Loss: 0.1133 Test MSE Loss: 0.1660
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1023348
	speed: 0.0173s/iter; left time: 207.0224s
Epoch: 24 cost time: 2.5902395248413086
Epoch: 24, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5943 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1660
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.0962366
	speed: 0.0170s/iter; left time: 201.3809s
Epoch: 25 cost time: 2.5481925010681152
Epoch: 25, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5925 x Lambda(0.0001)), Vali MSE Loss: 0.1133 Test MSE Loss: 0.1660
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.0940074
	speed: 0.0176s/iter; left time: 205.2986s
Epoch: 26 cost time: 2.5319724082946777
Epoch: 26, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5863 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.13020426034927368, mae:0.20180600881576538, mape:0.4564615786075592, mspe:8.064428329467773 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8847
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2199585
	speed: 0.0165s/iter; left time: 256.6876s
Epoch: 1 cost time: 2.514542818069458
Epoch: 1, Steps: 157 Train Loss: 0.3219 (Forecasting Loss:0.3217 + XiCon Loss:2.5040 x Lambda(0.0001)), Vali MSE Loss: 0.2389 Test MSE Loss: 0.3414
Validation loss decreased (inf --> 0.238939).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1361501
	speed: 0.0172s/iter; left time: 265.3442s
Epoch: 2 cost time: 2.5890421867370605
Epoch: 2, Steps: 157 Train Loss: 0.1449 (Forecasting Loss:0.1446 + XiCon Loss:2.5265 x Lambda(0.0001)), Vali MSE Loss: 0.1432 Test MSE Loss: 0.1993
Validation loss decreased (0.238939 --> 0.143163).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.0963937
	speed: 0.0171s/iter; left time: 260.9885s
Epoch: 3 cost time: 2.521270751953125
Epoch: 3, Steps: 157 Train Loss: 0.1127 (Forecasting Loss:0.1125 + XiCon Loss:2.5346 x Lambda(0.0001)), Vali MSE Loss: 0.1265 Test MSE Loss: 0.1805
Validation loss decreased (0.143163 --> 0.126456).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.0955655
	speed: 0.0177s/iter; left time: 268.3177s
Epoch: 4 cost time: 2.594038724899292
Epoch: 4, Steps: 157 Train Loss: 0.1046 (Forecasting Loss:0.1043 + XiCon Loss:2.5294 x Lambda(0.0001)), Vali MSE Loss: 0.1193 Test MSE Loss: 0.1727
Validation loss decreased (0.126456 --> 0.119286).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1145823
	speed: 0.0170s/iter; left time: 255.2562s
Epoch: 5 cost time: 2.559697389602661
Epoch: 5, Steps: 157 Train Loss: 0.1014 (Forecasting Loss:0.1011 + XiCon Loss:2.5160 x Lambda(0.0001)), Vali MSE Loss: 0.1166 Test MSE Loss: 0.1700
Validation loss decreased (0.119286 --> 0.116585).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1059825
	speed: 0.0178s/iter; left time: 263.0776s
Epoch: 6 cost time: 2.690114736557007
Epoch: 6, Steps: 157 Train Loss: 0.0997 (Forecasting Loss:0.0995 + XiCon Loss:2.5074 x Lambda(0.0001)), Vali MSE Loss: 0.1141 Test MSE Loss: 0.1658
Validation loss decreased (0.116585 --> 0.114098).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0963197
	speed: 0.0174s/iter; left time: 254.4229s
Epoch: 7 cost time: 2.638221502304077
Epoch: 7, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5026 x Lambda(0.0001)), Vali MSE Loss: 0.1134 Test MSE Loss: 0.1654
Validation loss decreased (0.114098 --> 0.113397).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1117030
	speed: 0.0165s/iter; left time: 238.7954s
Epoch: 8 cost time: 2.4450082778930664
Epoch: 8, Steps: 157 Train Loss: 0.0982 (Forecasting Loss:0.0979 + XiCon Loss:2.4999 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1642
Validation loss decreased (0.113397 --> 0.112729).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0925129
	speed: 0.0171s/iter; left time: 245.0645s
Epoch: 9 cost time: 2.5047988891601562
Epoch: 9, Steps: 157 Train Loss: 0.0980 (Forecasting Loss:0.0977 + XiCon Loss:2.5037 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1639
Validation loss decreased (0.112729 --> 0.112312).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0830330
	speed: 0.0174s/iter; left time: 246.4803s
Epoch: 10 cost time: 2.5712316036224365
Epoch: 10, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0976 + XiCon Loss:2.4932 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0875337
	speed: 0.0166s/iter; left time: 232.7361s
Epoch: 11 cost time: 2.45857834815979
Epoch: 11, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5012 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1638
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1066467
	speed: 0.0175s/iter; left time: 242.5538s
Epoch: 12 cost time: 2.514658212661743
Epoch: 12, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5034 x Lambda(0.0001)), Vali MSE Loss: 0.1121 Test MSE Loss: 0.1637
Validation loss decreased (0.112312 --> 0.112139).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1067376
	speed: 0.0178s/iter; left time: 244.0524s
Epoch: 13 cost time: 2.570220470428467
Epoch: 13, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.4991 x Lambda(0.0001)), Vali MSE Loss: 0.1124 Test MSE Loss: 0.1636
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0961836
	speed: 0.0187s/iter; left time: 253.8528s
Epoch: 14 cost time: 2.7325778007507324
Epoch: 14, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5009 x Lambda(0.0001)), Vali MSE Loss: 0.1121 Test MSE Loss: 0.1636
Validation loss decreased (0.112139 --> 0.112068).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1069280
	speed: 0.0171s/iter; left time: 228.9219s
Epoch: 15 cost time: 2.548436403274536
Epoch: 15, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.4995 x Lambda(0.0001)), Vali MSE Loss: 0.1124 Test MSE Loss: 0.1636
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0852439
	speed: 0.0179s/iter; left time: 236.7680s
Epoch: 16 cost time: 2.6513447761535645
Epoch: 16, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.4970 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0841368
	speed: 0.0175s/iter; left time: 228.7425s
Epoch: 17 cost time: 2.5938756465911865
Epoch: 17, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.4979 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1033865
	speed: 0.0178s/iter; left time: 230.8225s
Epoch: 18 cost time: 2.624814987182617
Epoch: 18, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.4926 x Lambda(0.0001)), Vali MSE Loss: 0.1121 Test MSE Loss: 0.1636
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0857309
	speed: 0.0174s/iter; left time: 222.6902s
Epoch: 19 cost time: 2.537421703338623
Epoch: 19, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5007 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1008322
	speed: 0.0172s/iter; left time: 217.0155s
Epoch: 20 cost time: 2.5172858238220215
Epoch: 20, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5009 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1010174
	speed: 0.0174s/iter; left time: 216.7602s
Epoch: 21 cost time: 2.580899953842163
Epoch: 21, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5026 x Lambda(0.0001)), Vali MSE Loss: 0.1121 Test MSE Loss: 0.1636
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1013188
	speed: 0.0199s/iter; left time: 244.8533s
Epoch: 22 cost time: 2.8746373653411865
Epoch: 22, Steps: 157 Train Loss: 0.0974 (Forecasting Loss:0.0972 + XiCon Loss:2.5057 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.0857926
	speed: 0.0179s/iter; left time: 217.7684s
Epoch: 23 cost time: 2.675286054611206
Epoch: 23, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.4965 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.0892148
	speed: 0.0173s/iter; left time: 207.8003s
Epoch: 24 cost time: 2.5850942134857178
Epoch: 24, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5012 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.1283896565437317, mae:0.19888369739055634, mape:0.4407722055912018, mspe:7.678477764129639 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1303+-0.00252, MAE:0.2033+-0.00584, MAPE:0.4667+-0.03449, MSPE:10.3184+-4.13130, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.5, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9478
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2359088
	speed: 0.0206s/iter; left time: 301.2974s
Epoch: 1 cost time: 2.8500168323516846
Epoch: 1, Steps: 147 Train Loss: 0.3303 (Forecasting Loss:0.3278 + XiCon Loss:2.5459 x Lambda(0.001)), Vali MSE Loss: 0.2527 Test MSE Loss: 0.3559
Validation loss decreased (inf --> 0.252669).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1438849
	speed: 0.0202s/iter; left time: 292.5306s
Epoch: 2 cost time: 2.8740315437316895
Epoch: 2, Steps: 147 Train Loss: 0.1590 (Forecasting Loss:0.1565 + XiCon Loss:2.4840 x Lambda(0.001)), Vali MSE Loss: 0.1526 Test MSE Loss: 0.2158
Validation loss decreased (0.252669 --> 0.152567).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1376899
	speed: 0.0182s/iter; left time: 261.0718s
Epoch: 3 cost time: 2.5702779293060303
Epoch: 3, Steps: 147 Train Loss: 0.1276 (Forecasting Loss:0.1252 + XiCon Loss:2.4501 x Lambda(0.001)), Vali MSE Loss: 0.1411 Test MSE Loss: 0.2014
Validation loss decreased (0.152567 --> 0.141092).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1153782
	speed: 0.0188s/iter; left time: 266.5134s
Epoch: 4 cost time: 2.5911576747894287
Epoch: 4, Steps: 147 Train Loss: 0.1203 (Forecasting Loss:0.1178 + XiCon Loss:2.4583 x Lambda(0.001)), Vali MSE Loss: 0.1361 Test MSE Loss: 0.1923
Validation loss decreased (0.141092 --> 0.136127).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1217238
	speed: 0.0184s/iter; left time: 257.2908s
Epoch: 5 cost time: 2.6498265266418457
Epoch: 5, Steps: 147 Train Loss: 0.1167 (Forecasting Loss:0.1143 + XiCon Loss:2.4529 x Lambda(0.001)), Vali MSE Loss: 0.1343 Test MSE Loss: 0.1894
Validation loss decreased (0.136127 --> 0.134285).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1167690
	speed: 0.0190s/iter; left time: 263.5573s
Epoch: 6 cost time: 2.7142746448516846
Epoch: 6, Steps: 147 Train Loss: 0.1148 (Forecasting Loss:0.1123 + XiCon Loss:2.4410 x Lambda(0.001)), Vali MSE Loss: 0.1315 Test MSE Loss: 0.1841
Validation loss decreased (0.134285 --> 0.131531).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1176897
	speed: 0.0181s/iter; left time: 248.0077s
Epoch: 7 cost time: 2.5548152923583984
Epoch: 7, Steps: 147 Train Loss: 0.1138 (Forecasting Loss:0.1114 + XiCon Loss:2.4407 x Lambda(0.001)), Vali MSE Loss: 0.1305 Test MSE Loss: 0.1840
Validation loss decreased (0.131531 --> 0.130507).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1130806
	speed: 0.0182s/iter; left time: 246.5007s
Epoch: 8 cost time: 2.61358904838562
Epoch: 8, Steps: 147 Train Loss: 0.1132 (Forecasting Loss:0.1107 + XiCon Loss:2.4422 x Lambda(0.001)), Vali MSE Loss: 0.1305 Test MSE Loss: 0.1829
Validation loss decreased (0.130507 --> 0.130478).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1205335
	speed: 0.0177s/iter; left time: 238.0461s
Epoch: 9 cost time: 2.5061120986938477
Epoch: 9, Steps: 147 Train Loss: 0.1130 (Forecasting Loss:0.1105 + XiCon Loss:2.4487 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1840
Validation loss decreased (0.130478 --> 0.130413).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1044820
	speed: 0.0195s/iter; left time: 259.1536s
Epoch: 10 cost time: 2.881654977798462
Epoch: 10, Steps: 147 Train Loss: 0.1129 (Forecasting Loss:0.1104 + XiCon Loss:2.4508 x Lambda(0.001)), Vali MSE Loss: 0.1305 Test MSE Loss: 0.1832
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1130178
	speed: 0.0184s/iter; left time: 241.7206s
Epoch: 11 cost time: 2.6188883781433105
Epoch: 11, Steps: 147 Train Loss: 0.1128 (Forecasting Loss:0.1104 + XiCon Loss:2.4409 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
Validation loss decreased (0.130413 --> 0.130233).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1206506
	speed: 0.0206s/iter; left time: 267.3332s
Epoch: 12 cost time: 2.7797796726226807
Epoch: 12, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4471 x Lambda(0.001)), Vali MSE Loss: 0.1301 Test MSE Loss: 0.1829
Validation loss decreased (0.130233 --> 0.130124).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1098184
	speed: 0.0173s/iter; left time: 222.3312s
Epoch: 13 cost time: 2.4877283573150635
Epoch: 13, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4430 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1143043
	speed: 0.0186s/iter; left time: 235.9926s
Epoch: 14 cost time: 2.654493570327759
Epoch: 14, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4436 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1093179
	speed: 0.0185s/iter; left time: 231.6458s
Epoch: 15 cost time: 2.560091733932495
Epoch: 15, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4464 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1091025
	speed: 0.0179s/iter; left time: 221.6946s
Epoch: 16 cost time: 2.5233893394470215
Epoch: 16, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4392 x Lambda(0.001)), Vali MSE Loss: 0.1303 Test MSE Loss: 0.1830
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1208955
	speed: 0.0226s/iter; left time: 277.2334s
Epoch: 17 cost time: 2.99129319190979
Epoch: 17, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4392 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1072266
	speed: 0.0188s/iter; left time: 227.9081s
Epoch: 18 cost time: 2.790052890777588
Epoch: 18, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4419 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1116856
	speed: 0.0193s/iter; left time: 231.0941s
Epoch: 19 cost time: 2.7134926319122314
Epoch: 19, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4409 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1036210
	speed: 0.0193s/iter; left time: 227.9075s
Epoch: 20 cost time: 2.673853874206543
Epoch: 20, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4449 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1043595
	speed: 0.0195s/iter; left time: 227.4081s
Epoch: 21 cost time: 2.696676731109619
Epoch: 21, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4358 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1089785
	speed: 0.0191s/iter; left time: 220.3035s
Epoch: 22 cost time: 2.668944835662842
Epoch: 22, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4409 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14258143305778503, mae:0.22327235341072083, mape:0.5586608648300171, mspe:22.025386810302734 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7351
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2236777
	speed: 0.0185s/iter; left time: 269.5603s
Epoch: 1 cost time: 2.6978600025177
Epoch: 1, Steps: 147 Train Loss: 0.3193 (Forecasting Loss:0.3168 + XiCon Loss:2.5182 x Lambda(0.001)), Vali MSE Loss: 0.2435 Test MSE Loss: 0.3467
Validation loss decreased (inf --> 0.243474).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1453883
	speed: 0.0206s/iter; left time: 297.9743s
Epoch: 2 cost time: 2.7707126140594482
Epoch: 2, Steps: 147 Train Loss: 0.1586 (Forecasting Loss:0.1560 + XiCon Loss:2.5445 x Lambda(0.001)), Vali MSE Loss: 0.1511 Test MSE Loss: 0.2141
Validation loss decreased (0.243474 --> 0.151100).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1239415
	speed: 0.0194s/iter; left time: 277.3321s
Epoch: 3 cost time: 2.6783623695373535
Epoch: 3, Steps: 147 Train Loss: 0.1264 (Forecasting Loss:0.1239 + XiCon Loss:2.5046 x Lambda(0.001)), Vali MSE Loss: 0.1384 Test MSE Loss: 0.1939
Validation loss decreased (0.151100 --> 0.138366).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1166949
	speed: 0.0178s/iter; left time: 251.8536s
Epoch: 4 cost time: 2.5455145835876465
Epoch: 4, Steps: 147 Train Loss: 0.1194 (Forecasting Loss:0.1170 + XiCon Loss:2.4783 x Lambda(0.001)), Vali MSE Loss: 0.1310 Test MSE Loss: 0.1866
Validation loss decreased (0.138366 --> 0.130977).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1168863
	speed: 0.0194s/iter; left time: 272.4560s
Epoch: 5 cost time: 2.7422125339508057
Epoch: 5, Steps: 147 Train Loss: 0.1157 (Forecasting Loss:0.1133 + XiCon Loss:2.4594 x Lambda(0.001)), Vali MSE Loss: 0.1260 Test MSE Loss: 0.1852
Validation loss decreased (0.130977 --> 0.125951).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1053038
	speed: 0.0185s/iter; left time: 256.6157s
Epoch: 6 cost time: 2.5988450050354004
Epoch: 6, Steps: 147 Train Loss: 0.1139 (Forecasting Loss:0.1114 + XiCon Loss:2.4650 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1834
Validation loss decreased (0.125951 --> 0.124900).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1181265
	speed: 0.0182s/iter; left time: 249.9009s
Epoch: 7 cost time: 2.626124620437622
Epoch: 7, Steps: 147 Train Loss: 0.1130 (Forecasting Loss:0.1105 + XiCon Loss:2.4642 x Lambda(0.001)), Vali MSE Loss: 0.1239 Test MSE Loss: 0.1831
Validation loss decreased (0.124900 --> 0.123936).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1146328
	speed: 0.0197s/iter; left time: 266.8552s
Epoch: 8 cost time: 2.750396728515625
Epoch: 8, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4597 x Lambda(0.001)), Vali MSE Loss: 0.1237 Test MSE Loss: 0.1819
Validation loss decreased (0.123936 --> 0.123651).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1159676
	speed: 0.0186s/iter; left time: 249.6779s
Epoch: 9 cost time: 2.656381130218506
Epoch: 9, Steps: 147 Train Loss: 0.1122 (Forecasting Loss:0.1098 + XiCon Loss:2.4546 x Lambda(0.001)), Vali MSE Loss: 0.1234 Test MSE Loss: 0.1819
Validation loss decreased (0.123651 --> 0.123425).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1186227
	speed: 0.0193s/iter; left time: 256.1140s
Epoch: 10 cost time: 2.683732271194458
Epoch: 10, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4683 x Lambda(0.001)), Vali MSE Loss: 0.1235 Test MSE Loss: 0.1814
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1162572
	speed: 0.0201s/iter; left time: 264.3789s
Epoch: 11 cost time: 2.739161729812622
Epoch: 11, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4546 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
Validation loss decreased (0.123425 --> 0.123251).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1113383
	speed: 0.0186s/iter; left time: 241.5841s
Epoch: 12 cost time: 2.6299006938934326
Epoch: 12, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4597 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1814
Validation loss decreased (0.123251 --> 0.123241).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1189811
	speed: 0.0179s/iter; left time: 229.5118s
Epoch: 13 cost time: 2.57379150390625
Epoch: 13, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4514 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1116283
	speed: 0.0184s/iter; left time: 233.8071s
Epoch: 14 cost time: 2.620438575744629
Epoch: 14, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4620 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1052181
	speed: 0.0181s/iter; left time: 227.4061s
Epoch: 15 cost time: 2.57204270362854
Epoch: 15, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4528 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
Validation loss decreased (0.123241 --> 0.123218).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1125234
	speed: 0.0185s/iter; left time: 229.3248s
Epoch: 16 cost time: 2.6098079681396484
Epoch: 16, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4614 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1073350
	speed: 0.0200s/iter; left time: 244.7062s
Epoch: 17 cost time: 2.75791072845459
Epoch: 17, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4623 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1211609
	speed: 0.0188s/iter; left time: 228.0664s
Epoch: 18 cost time: 2.626347064971924
Epoch: 18, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4614 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1159417
	speed: 0.0182s/iter; left time: 217.2701s
Epoch: 19 cost time: 2.630063533782959
Epoch: 19, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4671 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1057302
	speed: 0.0189s/iter; left time: 223.6085s
Epoch: 20 cost time: 2.6944022178649902
Epoch: 20, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4597 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
Validation loss decreased (0.123218 --> 0.123197).  Saving model ...
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1067552
	speed: 0.0187s/iter; left time: 218.0312s
Epoch: 21 cost time: 2.7012388706207275
Epoch: 21, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4564 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1167453
	speed: 0.0192s/iter; left time: 220.7655s
Epoch: 22 cost time: 2.6904120445251465
Epoch: 22, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4615 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1180992
	speed: 0.0194s/iter; left time: 220.0348s
Epoch: 23 cost time: 2.691305637359619
Epoch: 23, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4560 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1141909
	speed: 0.0183s/iter; left time: 205.0975s
Epoch: 24 cost time: 2.584960460662842
Epoch: 24, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4626 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1097428
	speed: 0.0189s/iter; left time: 208.9215s
Epoch: 25 cost time: 2.593790292739868
Epoch: 25, Steps: 147 Train Loss: 0.1118 (Forecasting Loss:0.1094 + XiCon Loss:2.4642 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1144594
	speed: 0.0199s/iter; left time: 217.5137s
Epoch: 26 cost time: 2.820805549621582
Epoch: 26, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4559 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1056462
	speed: 0.0189s/iter; left time: 203.9954s
Epoch: 27 cost time: 2.707897663116455
Epoch: 27, Steps: 147 Train Loss: 0.1118 (Forecasting Loss:0.1094 + XiCon Loss:2.4601 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1080509
	speed: 0.0180s/iter; left time: 191.8691s
Epoch: 28 cost time: 2.5567498207092285
Epoch: 28, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4553 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1107169
	speed: 0.0188s/iter; left time: 196.6102s
Epoch: 29 cost time: 2.6747491359710693
Epoch: 29, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4560 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1155377
	speed: 0.0199s/iter; left time: 205.5931s
Epoch: 30 cost time: 2.7426726818084717
Epoch: 30, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4626 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14138002693653107, mae:0.22159774601459503, mape:0.5410776138305664, mspe:19.424562454223633 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9369
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2251337
	speed: 0.0198s/iter; left time: 289.4523s
Epoch: 1 cost time: 2.829822063446045
Epoch: 1, Steps: 147 Train Loss: 0.3176 (Forecasting Loss:0.3151 + XiCon Loss:2.5333 x Lambda(0.001)), Vali MSE Loss: 0.2427 Test MSE Loss: 0.3452
Validation loss decreased (inf --> 0.242662).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1398270
	speed: 0.0186s/iter; left time: 269.2887s
Epoch: 2 cost time: 2.752166271209717
Epoch: 2, Steps: 147 Train Loss: 0.1557 (Forecasting Loss:0.1532 + XiCon Loss:2.4875 x Lambda(0.001)), Vali MSE Loss: 0.1513 Test MSE Loss: 0.2144
Validation loss decreased (0.242662 --> 0.151314).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1252763
	speed: 0.0180s/iter; left time: 257.0847s
Epoch: 3 cost time: 2.5539612770080566
Epoch: 3, Steps: 147 Train Loss: 0.1259 (Forecasting Loss:0.1234 + XiCon Loss:2.4562 x Lambda(0.001)), Vali MSE Loss: 0.1386 Test MSE Loss: 0.1949
Validation loss decreased (0.151314 --> 0.138624).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1099975
	speed: 0.0181s/iter; left time: 256.9842s
Epoch: 4 cost time: 2.601249933242798
Epoch: 4, Steps: 147 Train Loss: 0.1184 (Forecasting Loss:0.1160 + XiCon Loss:2.4540 x Lambda(0.001)), Vali MSE Loss: 0.1308 Test MSE Loss: 0.1893
Validation loss decreased (0.138624 --> 0.130766).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1245177
	speed: 0.0195s/iter; left time: 273.1408s
Epoch: 5 cost time: 2.697890520095825
Epoch: 5, Steps: 147 Train Loss: 0.1151 (Forecasting Loss:0.1126 + XiCon Loss:2.4568 x Lambda(0.001)), Vali MSE Loss: 0.1284 Test MSE Loss: 0.1833
Validation loss decreased (0.130766 --> 0.128406).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1121771
	speed: 0.0518s/iter; left time: 718.3893s
Epoch: 6 cost time: 5.952147960662842
Epoch: 6, Steps: 147 Train Loss: 0.1132 (Forecasting Loss:0.1107 + XiCon Loss:2.4495 x Lambda(0.001)), Vali MSE Loss: 0.1263 Test MSE Loss: 0.1817
Validation loss decreased (0.128406 --> 0.126332).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1206438
	speed: 0.0175s/iter; left time: 240.2555s
Epoch: 7 cost time: 2.480478286743164
Epoch: 7, Steps: 147 Train Loss: 0.1123 (Forecasting Loss:0.1098 + XiCon Loss:2.4454 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1820
Validation loss decreased (0.126332 --> 0.125132).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1068366
	speed: 0.0153s/iter; left time: 208.2911s
Epoch: 8 cost time: 2.156442403793335
Epoch: 8, Steps: 147 Train Loss: 0.1118 (Forecasting Loss:0.1093 + XiCon Loss:2.4412 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1806
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1035203
	speed: 0.0194s/iter; left time: 260.7204s
Epoch: 9 cost time: 2.7512409687042236
Epoch: 9, Steps: 147 Train Loss: 0.1115 (Forecasting Loss:0.1091 + XiCon Loss:2.4491 x Lambda(0.001)), Vali MSE Loss: 0.1248 Test MSE Loss: 0.1805
Validation loss decreased (0.125132 --> 0.124797).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1105573
	speed: 0.0192s/iter; left time: 254.3233s
Epoch: 10 cost time: 2.66188907623291
Epoch: 10, Steps: 147 Train Loss: 0.1114 (Forecasting Loss:0.1089 + XiCon Loss:2.4543 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1806
Validation loss decreased (0.124797 --> 0.124610).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1135268
	speed: 0.0196s/iter; left time: 257.0602s
Epoch: 11 cost time: 2.705533742904663
Epoch: 11, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4540 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1131118
	speed: 0.0191s/iter; left time: 247.5968s
Epoch: 12 cost time: 2.622600555419922
Epoch: 12, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4411 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1108376
	speed: 0.0194s/iter; left time: 249.4014s
Epoch: 13 cost time: 2.6435468196868896
Epoch: 13, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4537 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1802
Validation loss decreased (0.124610 --> 0.124532).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1156277
	speed: 0.0188s/iter; left time: 238.6188s
Epoch: 14 cost time: 2.5965213775634766
Epoch: 14, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4500 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1802
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1186771
	speed: 0.0193s/iter; left time: 241.8958s
Epoch: 15 cost time: 2.7524707317352295
Epoch: 15, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4465 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1131299
	speed: 0.0190s/iter; left time: 236.0185s
Epoch: 16 cost time: 2.78068208694458
Epoch: 16, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4554 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1097509
	speed: 0.0178s/iter; left time: 217.7037s
Epoch: 17 cost time: 2.530376672744751
Epoch: 17, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4541 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1105138
	speed: 0.0185s/iter; left time: 224.2186s
Epoch: 18 cost time: 2.6441822052001953
Epoch: 18, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4540 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1146052
	speed: 0.0198s/iter; left time: 236.1384s
Epoch: 19 cost time: 2.6859371662139893
Epoch: 19, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4484 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1130821
	speed: 0.0185s/iter; left time: 218.6888s
Epoch: 20 cost time: 2.6198089122772217
Epoch: 20, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4452 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1803
Validation loss decreased (0.124532 --> 0.124522).  Saving model ...
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1132758
	speed: 0.0175s/iter; left time: 204.6429s
Epoch: 21 cost time: 2.464022636413574
Epoch: 21, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4511 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1112347
	speed: 0.0179s/iter; left time: 206.4916s
Epoch: 22 cost time: 2.5370917320251465
Epoch: 22, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4518 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1123491
	speed: 0.0189s/iter; left time: 214.8737s
Epoch: 23 cost time: 2.6993188858032227
Epoch: 23, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4550 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1129002
	speed: 0.0190s/iter; left time: 213.3399s
Epoch: 24 cost time: 2.6320176124572754
Epoch: 24, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4510 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1803
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1088261
	speed: 0.0177s/iter; left time: 196.4408s
Epoch: 25 cost time: 2.4728574752807617
Epoch: 25, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4462 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1148524
	speed: 0.0190s/iter; left time: 207.1145s
Epoch: 26 cost time: 2.631922960281372
Epoch: 26, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4561 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1201756
	speed: 0.0200s/iter; left time: 215.0665s
Epoch: 27 cost time: 2.788367748260498
Epoch: 27, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4468 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1156263
	speed: 0.0178s/iter; left time: 189.0871s
Epoch: 28 cost time: 2.4993622303009033
Epoch: 28, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4497 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1803
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1098107
	speed: 0.0183s/iter; left time: 191.6906s
Epoch: 29 cost time: 2.540412187576294
Epoch: 29, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4424 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1113374
	speed: 0.0184s/iter; left time: 190.3150s
Epoch: 30 cost time: 2.597280979156494
Epoch: 30, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4491 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14031441509723663, mae:0.22019082307815552, mape:0.5412868857383728, mspe:20.677461624145508 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9771
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2405460
	speed: 0.0197s/iter; left time: 288.0883s
Epoch: 1 cost time: 2.754430055618286
Epoch: 1, Steps: 147 Train Loss: 0.3222 (Forecasting Loss:0.3196 + XiCon Loss:2.5228 x Lambda(0.001)), Vali MSE Loss: 0.2525 Test MSE Loss: 0.3556
Validation loss decreased (inf --> 0.252462).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1486774
	speed: 0.0248s/iter; left time: 358.3651s
Epoch: 2 cost time: 3.3451991081237793
Epoch: 2, Steps: 147 Train Loss: 0.1581 (Forecasting Loss:0.1556 + XiCon Loss:2.5087 x Lambda(0.001)), Vali MSE Loss: 0.1540 Test MSE Loss: 0.2149
Validation loss decreased (0.252462 --> 0.154001).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1195912
	speed: 0.0207s/iter; left time: 296.0236s
Epoch: 3 cost time: 2.840059518814087
Epoch: 3, Steps: 147 Train Loss: 0.1269 (Forecasting Loss:0.1245 + XiCon Loss:2.4619 x Lambda(0.001)), Vali MSE Loss: 0.1380 Test MSE Loss: 0.1952
Validation loss decreased (0.154001 --> 0.138006).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1123049
	speed: 0.0184s/iter; left time: 260.1753s
Epoch: 4 cost time: 2.659335136413574
Epoch: 4, Steps: 147 Train Loss: 0.1193 (Forecasting Loss:0.1169 + XiCon Loss:2.4399 x Lambda(0.001)), Vali MSE Loss: 0.1307 Test MSE Loss: 0.1886
Validation loss decreased (0.138006 --> 0.130722).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1081177
	speed: 0.0180s/iter; left time: 252.5393s
Epoch: 5 cost time: 2.550196647644043
Epoch: 5, Steps: 147 Train Loss: 0.1158 (Forecasting Loss:0.1133 + XiCon Loss:2.4411 x Lambda(0.001)), Vali MSE Loss: 0.1279 Test MSE Loss: 0.1829
Validation loss decreased (0.130722 --> 0.127878).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1074187
	speed: 0.0190s/iter; left time: 263.7649s
Epoch: 6 cost time: 2.75158429145813
Epoch: 6, Steps: 147 Train Loss: 0.1140 (Forecasting Loss:0.1115 + XiCon Loss:2.4429 x Lambda(0.001)), Vali MSE Loss: 0.1263 Test MSE Loss: 0.1818
Validation loss decreased (0.127878 --> 0.126267).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1188997
	speed: 0.0195s/iter; left time: 267.6062s
Epoch: 7 cost time: 2.74135422706604
Epoch: 7, Steps: 147 Train Loss: 0.1131 (Forecasting Loss:0.1106 + XiCon Loss:2.4423 x Lambda(0.001)), Vali MSE Loss: 0.1253 Test MSE Loss: 0.1816
Validation loss decreased (0.126267 --> 0.125257).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1096737
	speed: 0.0185s/iter; left time: 251.2638s
Epoch: 8 cost time: 2.6182031631469727
Epoch: 8, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1101 + XiCon Loss:2.4377 x Lambda(0.001)), Vali MSE Loss: 0.1250 Test MSE Loss: 0.1812
Validation loss decreased (0.125257 --> 0.124989).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1105484
	speed: 0.0175s/iter; left time: 234.3000s
Epoch: 9 cost time: 2.5496225357055664
Epoch: 9, Steps: 147 Train Loss: 0.1123 (Forecasting Loss:0.1098 + XiCon Loss:2.4380 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1806
Validation loss decreased (0.124989 --> 0.124893).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1075299
	speed: 0.0186s/iter; left time: 246.8421s
Epoch: 10 cost time: 2.648528814315796
Epoch: 10, Steps: 147 Train Loss: 0.1121 (Forecasting Loss:0.1097 + XiCon Loss:2.4444 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1803
Validation loss decreased (0.124893 --> 0.124685).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1111146
	speed: 0.0178s/iter; left time: 233.9946s
Epoch: 11 cost time: 2.5381789207458496
Epoch: 11, Steps: 147 Train Loss: 0.1121 (Forecasting Loss:0.1096 + XiCon Loss:2.4341 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1799
Validation loss decreased (0.124685 --> 0.124658).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1133648
	speed: 0.0192s/iter; left time: 249.5714s
Epoch: 12 cost time: 2.7187113761901855
Epoch: 12, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4476 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
Validation loss decreased (0.124658 --> 0.124626).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1082634
	speed: 0.0180s/iter; left time: 230.5968s
Epoch: 13 cost time: 2.534789562225342
Epoch: 13, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4461 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
Validation loss decreased (0.124626 --> 0.124569).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1087021
	speed: 0.0193s/iter; left time: 245.1051s
Epoch: 14 cost time: 2.7412009239196777
Epoch: 14, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4425 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1093330
	speed: 0.0197s/iter; left time: 246.9083s
Epoch: 15 cost time: 2.731024742126465
Epoch: 15, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4436 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
Validation loss decreased (0.124569 --> 0.124558).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1110126
	speed: 0.0179s/iter; left time: 221.7851s
Epoch: 16 cost time: 2.55269193649292
Epoch: 16, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4391 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1084611
	speed: 0.0189s/iter; left time: 231.8564s
Epoch: 17 cost time: 2.7020785808563232
Epoch: 17, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4455 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1800
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1104524
	speed: 0.0183s/iter; left time: 221.8471s
Epoch: 18 cost time: 2.597306251525879
Epoch: 18, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4351 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1056245
	speed: 0.0184s/iter; left time: 220.3047s
Epoch: 19 cost time: 2.6380763053894043
Epoch: 19, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4449 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1800
Validation loss decreased (0.124558 --> 0.124491).  Saving model ...
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1214614
	speed: 0.0192s/iter; left time: 226.5811s
Epoch: 20 cost time: 2.6837663650512695
Epoch: 20, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4477 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1154746
	speed: 0.0184s/iter; left time: 214.8435s
Epoch: 21 cost time: 2.615370035171509
Epoch: 21, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4478 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1133628
	speed: 0.0187s/iter; left time: 214.7466s
Epoch: 22 cost time: 2.6531729698181152
Epoch: 22, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4456 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1139738
	speed: 0.0195s/iter; left time: 221.9565s
Epoch: 23 cost time: 2.729382038116455
Epoch: 23, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4394 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1064776
	speed: 0.0187s/iter; left time: 209.9600s
Epoch: 24 cost time: 2.632523536682129
Epoch: 24, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4381 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1207889
	speed: 0.0182s/iter; left time: 201.1368s
Epoch: 25 cost time: 2.7086904048919678
Epoch: 25, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4328 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1158383
	speed: 0.0186s/iter; left time: 203.3088s
Epoch: 26 cost time: 2.6093828678131104
Epoch: 26, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4362 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1128099
	speed: 0.0187s/iter; left time: 201.3885s
Epoch: 27 cost time: 2.5862276554107666
Epoch: 27, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4410 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1800
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1107083
	speed: 0.0209s/iter; left time: 222.5614s
Epoch: 28 cost time: 2.8511273860931396
Epoch: 28, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4434 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1101891
	speed: 0.0186s/iter; left time: 194.5842s
Epoch: 29 cost time: 2.74899959564209
Epoch: 29, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4416 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14052824676036835, mae:0.21946699917316437, mape:0.5435869693756104, mspe:20.71828842163086 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.2528
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2400432
	speed: 0.0213s/iter; left time: 310.7114s
Epoch: 1 cost time: 2.9576780796051025
Epoch: 1, Steps: 147 Train Loss: 0.3308 (Forecasting Loss:0.3282 + XiCon Loss:2.5418 x Lambda(0.001)), Vali MSE Loss: 0.2529 Test MSE Loss: 0.3587
Validation loss decreased (inf --> 0.252883).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1467367
	speed: 0.0188s/iter; left time: 272.4076s
Epoch: 2 cost time: 2.6731045246124268
Epoch: 2, Steps: 147 Train Loss: 0.1597 (Forecasting Loss:0.1572 + XiCon Loss:2.5241 x Lambda(0.001)), Vali MSE Loss: 0.1549 Test MSE Loss: 0.2191
Validation loss decreased (0.252883 --> 0.154926).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1343460
	speed: 0.0186s/iter; left time: 266.6887s
Epoch: 3 cost time: 2.6249947547912598
Epoch: 3, Steps: 147 Train Loss: 0.1279 (Forecasting Loss:0.1254 + XiCon Loss:2.4966 x Lambda(0.001)), Vali MSE Loss: 0.1376 Test MSE Loss: 0.1936
Validation loss decreased (0.154926 --> 0.137604).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1235803
	speed: 0.0190s/iter; left time: 269.6897s
Epoch: 4 cost time: 2.624955892562866
Epoch: 4, Steps: 147 Train Loss: 0.1200 (Forecasting Loss:0.1175 + XiCon Loss:2.4816 x Lambda(0.001)), Vali MSE Loss: 0.1319 Test MSE Loss: 0.1893
Validation loss decreased (0.137604 --> 0.131936).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1161758
	speed: 0.0180s/iter; left time: 252.9049s
Epoch: 5 cost time: 2.630937099456787
Epoch: 5, Steps: 147 Train Loss: 0.1164 (Forecasting Loss:0.1139 + XiCon Loss:2.4837 x Lambda(0.001)), Vali MSE Loss: 0.1281 Test MSE Loss: 0.1825
Validation loss decreased (0.131936 --> 0.128092).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1067654
	speed: 0.0193s/iter; left time: 268.1701s
Epoch: 6 cost time: 2.6968119144439697
Epoch: 6, Steps: 147 Train Loss: 0.1145 (Forecasting Loss:0.1120 + XiCon Loss:2.4752 x Lambda(0.001)), Vali MSE Loss: 0.1270 Test MSE Loss: 0.1828
Validation loss decreased (0.128092 --> 0.126976).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1138893
	speed: 0.0199s/iter; left time: 273.2439s
Epoch: 7 cost time: 2.7108700275421143
Epoch: 7, Steps: 147 Train Loss: 0.1135 (Forecasting Loss:0.1111 + XiCon Loss:2.4668 x Lambda(0.001)), Vali MSE Loss: 0.1263 Test MSE Loss: 0.1836
Validation loss decreased (0.126976 --> 0.126270).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1150102
	speed: 0.0179s/iter; left time: 242.2683s
Epoch: 8 cost time: 2.5715713500976562
Epoch: 8, Steps: 147 Train Loss: 0.1130 (Forecasting Loss:0.1105 + XiCon Loss:2.4798 x Lambda(0.001)), Vali MSE Loss: 0.1257 Test MSE Loss: 0.1805
Validation loss decreased (0.126270 --> 0.125686).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1097318
	speed: 0.0204s/iter; left time: 274.1623s
Epoch: 9 cost time: 2.791576623916626
Epoch: 9, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4690 x Lambda(0.001)), Vali MSE Loss: 0.1254 Test MSE Loss: 0.1811
Validation loss decreased (0.125686 --> 0.125402).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1133875
	speed: 0.0181s/iter; left time: 240.0094s
Epoch: 10 cost time: 2.543654203414917
Epoch: 10, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1101 + XiCon Loss:2.4668 x Lambda(0.001)), Vali MSE Loss: 0.1253 Test MSE Loss: 0.1812
Validation loss decreased (0.125402 --> 0.125323).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1107366
	speed: 0.0188s/iter; left time: 247.3332s
Epoch: 11 cost time: 2.663898229598999
Epoch: 11, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1101 + XiCon Loss:2.4685 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1808
Validation loss decreased (0.125323 --> 0.125224).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1101168
	speed: 0.0183s/iter; left time: 237.7894s
Epoch: 12 cost time: 2.559696912765503
Epoch: 12, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1100 + XiCon Loss:2.4714 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1807
Validation loss decreased (0.125224 --> 0.125172).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1127175
	speed: 0.0194s/iter; left time: 248.6284s
Epoch: 13 cost time: 2.762953519821167
Epoch: 13, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4671 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1806
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1189969
	speed: 0.0208s/iter; left time: 264.5443s
Epoch: 14 cost time: 2.848066806793213
Epoch: 14, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4706 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1806
Validation loss decreased (0.125172 --> 0.125127).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1137765
	speed: 0.0605s/iter; left time: 759.4717s
Epoch: 15 cost time: 7.923103094100952
Epoch: 15, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4762 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1101702
	speed: 0.0187s/iter; left time: 232.2674s
Epoch: 16 cost time: 2.622645854949951
Epoch: 16, Steps: 147 Train Loss: 0.1123 (Forecasting Loss:0.1099 + XiCon Loss:2.4689 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1055669
	speed: 0.0155s/iter; left time: 190.2470s
Epoch: 17 cost time: 2.178903818130493
Epoch: 17, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4716 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
Validation loss decreased (0.125127 --> 0.125106).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1068013
	speed: 0.0164s/iter; left time: 198.8332s
Epoch: 18 cost time: 2.4375903606414795
Epoch: 18, Steps: 147 Train Loss: 0.1123 (Forecasting Loss:0.1099 + XiCon Loss:2.4616 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1153240
	speed: 0.0193s/iter; left time: 231.0210s
Epoch: 19 cost time: 2.7413148880004883
Epoch: 19, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4658 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1112520
	speed: 0.0203s/iter; left time: 239.8989s
Epoch: 20 cost time: 2.788461446762085
Epoch: 20, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4742 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1807
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1074281
	speed: 0.0206s/iter; left time: 240.7638s
Epoch: 21 cost time: 2.8285446166992188
Epoch: 21, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4687 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1807
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1130157
	speed: 0.0180s/iter; left time: 207.2936s
Epoch: 22 cost time: 2.5702476501464844
Epoch: 22, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4662 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1104562
	speed: 0.0205s/iter; left time: 232.5986s
Epoch: 23 cost time: 2.820690155029297
Epoch: 23, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4722 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1807
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1146663
	speed: 0.0182s/iter; left time: 204.0734s
Epoch: 24 cost time: 2.5710556507110596
Epoch: 24, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4755 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1188048
	speed: 0.0186s/iter; left time: 205.6868s
Epoch: 25 cost time: 2.657209634780884
Epoch: 25, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4683 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1159513
	speed: 0.0186s/iter; left time: 202.8937s
Epoch: 26 cost time: 2.600693464279175
Epoch: 26, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.4686 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1807
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1084997
	speed: 0.0192s/iter; left time: 206.7101s
Epoch: 27 cost time: 2.7923784255981445
Epoch: 27, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1100 + XiCon Loss:2.4733 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1807
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14082078635692596, mae:0.22049614787101746, mape:0.5461360216140747, mspe:20.733478546142578 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1411+-0.00113, MAE:0.2210+-0.00184, MAPE:0.5461+-0.00905, MSPE:20.7158+-1.14208, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.01, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=1440, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.5, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8654
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2697064
	speed: 0.0229s/iter; left time: 309.5939s
Epoch: 1 cost time: 2.921652317047119
Epoch: 1, Steps: 136 Train Loss: 0.3627 (Forecasting Loss:0.3373 + XiCon Loss:2.5487 x Lambda(0.01)), Vali MSE Loss: 0.2672 Test MSE Loss: 0.3776
Validation loss decreased (inf --> 0.267175).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1827410
	speed: 0.0216s/iter; left time: 289.0434s
Epoch: 2 cost time: 2.819394826889038
Epoch: 2, Steps: 136 Train Loss: 0.1964 (Forecasting Loss:0.1719 + XiCon Loss:2.4496 x Lambda(0.01)), Vali MSE Loss: 0.1821 Test MSE Loss: 0.2543
Validation loss decreased (0.267175 --> 0.182135).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1651509
	speed: 0.0209s/iter; left time: 276.3818s
Epoch: 3 cost time: 2.774170160293579
Epoch: 3, Steps: 136 Train Loss: 0.1652 (Forecasting Loss:0.1411 + XiCon Loss:2.4111 x Lambda(0.01)), Vali MSE Loss: 0.1631 Test MSE Loss: 0.2321
Validation loss decreased (0.182135 --> 0.163117).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1540212
	speed: 0.0209s/iter; left time: 273.2450s
Epoch: 4 cost time: 2.8872053623199463
Epoch: 4, Steps: 136 Train Loss: 0.1571 (Forecasting Loss:0.1332 + XiCon Loss:2.3888 x Lambda(0.01)), Vali MSE Loss: 0.1580 Test MSE Loss: 0.2155
Validation loss decreased (0.163117 --> 0.158043).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1552211
	speed: 0.0203s/iter; left time: 263.6066s
Epoch: 5 cost time: 2.709325075149536
Epoch: 5, Steps: 136 Train Loss: 0.1531 (Forecasting Loss:0.1293 + XiCon Loss:2.3843 x Lambda(0.01)), Vali MSE Loss: 0.1552 Test MSE Loss: 0.2125
Validation loss decreased (0.158043 --> 0.155228).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1535464
	speed: 0.0210s/iter; left time: 269.3930s
Epoch: 6 cost time: 2.713937759399414
Epoch: 6, Steps: 136 Train Loss: 0.1511 (Forecasting Loss:0.1273 + XiCon Loss:2.3762 x Lambda(0.01)), Vali MSE Loss: 0.1542 Test MSE Loss: 0.2135
Validation loss decreased (0.155228 --> 0.154193).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1465777
	speed: 0.0210s/iter; left time: 266.6774s
Epoch: 7 cost time: 2.7096989154815674
Epoch: 7, Steps: 136 Train Loss: 0.1500 (Forecasting Loss:0.1263 + XiCon Loss:2.3719 x Lambda(0.01)), Vali MSE Loss: 0.1522 Test MSE Loss: 0.2140
Validation loss decreased (0.154193 --> 0.152154).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1439600
	speed: 0.0212s/iter; left time: 265.9464s
Epoch: 8 cost time: 2.787677526473999
Epoch: 8, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1258 + XiCon Loss:2.3692 x Lambda(0.01)), Vali MSE Loss: 0.1536 Test MSE Loss: 0.2130
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1545709
	speed: 0.0209s/iter; left time: 259.0048s
Epoch: 9 cost time: 2.7241060733795166
Epoch: 9, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1254 + XiCon Loss:2.3707 x Lambda(0.01)), Vali MSE Loss: 0.1530 Test MSE Loss: 0.2122
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1493500
	speed: 0.0207s/iter; left time: 254.2826s
Epoch: 10 cost time: 2.710902690887451
Epoch: 10, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1253 + XiCon Loss:2.3728 x Lambda(0.01)), Vali MSE Loss: 0.1526 Test MSE Loss: 0.2120
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1497807
	speed: 0.0204s/iter; left time: 247.3321s
Epoch: 11 cost time: 2.6728992462158203
Epoch: 11, Steps: 136 Train Loss: 0.1489 (Forecasting Loss:0.1252 + XiCon Loss:2.3681 x Lambda(0.01)), Vali MSE Loss: 0.1532 Test MSE Loss: 0.2115
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1542924
	speed: 0.0206s/iter; left time: 246.9360s
Epoch: 12 cost time: 2.7793023586273193
Epoch: 12, Steps: 136 Train Loss: 0.1488 (Forecasting Loss:0.1251 + XiCon Loss:2.3716 x Lambda(0.01)), Vali MSE Loss: 0.1530 Test MSE Loss: 0.2120
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1534732
	speed: 0.0216s/iter; left time: 256.7463s
Epoch: 13 cost time: 2.8432741165161133
Epoch: 13, Steps: 136 Train Loss: 0.1488 (Forecasting Loss:0.1251 + XiCon Loss:2.3642 x Lambda(0.01)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2120
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1581741
	speed: 0.0212s/iter; left time: 248.5811s
Epoch: 14 cost time: 2.992492914199829
Epoch: 14, Steps: 136 Train Loss: 0.1489 (Forecasting Loss:0.1251 + XiCon Loss:2.3765 x Lambda(0.01)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2121
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1436043
	speed: 0.0222s/iter; left time: 257.9083s
Epoch: 15 cost time: 2.910297393798828
Epoch: 15, Steps: 136 Train Loss: 0.1487 (Forecasting Loss:0.1251 + XiCon Loss:2.3667 x Lambda(0.01)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2121
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1546685
	speed: 0.0216s/iter; left time: 247.3862s
Epoch: 16 cost time: 2.8027429580688477
Epoch: 16, Steps: 136 Train Loss: 0.1487 (Forecasting Loss:0.1251 + XiCon Loss:2.3694 x Lambda(0.01)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2121
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1405272
	speed: 0.0209s/iter; left time: 236.2532s
Epoch: 17 cost time: 2.7728350162506104
Epoch: 17, Steps: 136 Train Loss: 0.1488 (Forecasting Loss:0.1251 + XiCon Loss:2.3709 x Lambda(0.01)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.1768810749053955, mae:0.2510257959365845, mape:0.6261119246482849, mspe:29.294002532958984 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8391
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2645402
	speed: 0.0222s/iter; left time: 299.7907s
Epoch: 1 cost time: 2.9172751903533936
Epoch: 1, Steps: 136 Train Loss: 0.3611 (Forecasting Loss:0.3358 + XiCon Loss:2.5350 x Lambda(0.01)), Vali MSE Loss: 0.2650 Test MSE Loss: 0.3800
Validation loss decreased (inf --> 0.265043).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1804304
	speed: 0.0227s/iter; left time: 302.7742s
Epoch: 2 cost time: 2.937274932861328
Epoch: 2, Steps: 136 Train Loss: 0.1973 (Forecasting Loss:0.1727 + XiCon Loss:2.4585 x Lambda(0.01)), Vali MSE Loss: 0.1677 Test MSE Loss: 0.2498
Validation loss decreased (0.265043 --> 0.167684).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1710717
	speed: 0.0210s/iter; left time: 277.8329s
Epoch: 3 cost time: 2.7833826541900635
Epoch: 3, Steps: 136 Train Loss: 0.1668 (Forecasting Loss:0.1428 + XiCon Loss:2.4004 x Lambda(0.01)), Vali MSE Loss: 0.1530 Test MSE Loss: 0.2254
Validation loss decreased (0.167684 --> 0.152993).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1524096
	speed: 0.0217s/iter; left time: 284.5324s
Epoch: 4 cost time: 2.8226912021636963
Epoch: 4, Steps: 136 Train Loss: 0.1591 (Forecasting Loss:0.1351 + XiCon Loss:2.4005 x Lambda(0.01)), Vali MSE Loss: 0.1462 Test MSE Loss: 0.2143
Validation loss decreased (0.152993 --> 0.146250).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1421479
	speed: 0.0216s/iter; left time: 280.4400s
Epoch: 5 cost time: 2.8451645374298096
Epoch: 5, Steps: 136 Train Loss: 0.1552 (Forecasting Loss:0.1312 + XiCon Loss:2.3969 x Lambda(0.01)), Vali MSE Loss: 0.1417 Test MSE Loss: 0.2200
Validation loss decreased (0.146250 --> 0.141720).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1529172
	speed: 0.0217s/iter; left time: 278.1241s
Epoch: 6 cost time: 2.8242924213409424
Epoch: 6, Steps: 136 Train Loss: 0.1533 (Forecasting Loss:0.1294 + XiCon Loss:2.3968 x Lambda(0.01)), Vali MSE Loss: 0.1389 Test MSE Loss: 0.2177
Validation loss decreased (0.141720 --> 0.138932).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1467307
	speed: 0.0228s/iter; left time: 289.0420s
Epoch: 7 cost time: 3.059793472290039
Epoch: 7, Steps: 136 Train Loss: 0.1522 (Forecasting Loss:0.1283 + XiCon Loss:2.3889 x Lambda(0.01)), Vali MSE Loss: 0.1380 Test MSE Loss: 0.2144
Validation loss decreased (0.138932 --> 0.137998).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1512659
	speed: 0.0243s/iter; left time: 304.8476s
Epoch: 8 cost time: 3.117521047592163
Epoch: 8, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1277 + XiCon Loss:2.3974 x Lambda(0.01)), Vali MSE Loss: 0.1375 Test MSE Loss: 0.2160
Validation loss decreased (0.137998 --> 0.137521).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1522214
	speed: 0.0223s/iter; left time: 276.3609s
Epoch: 9 cost time: 2.907074451446533
Epoch: 9, Steps: 136 Train Loss: 0.1513 (Forecasting Loss:0.1274 + XiCon Loss:2.3912 x Lambda(0.01)), Vali MSE Loss: 0.1375 Test MSE Loss: 0.2135
Validation loss decreased (0.137521 --> 0.137468).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1372490
	speed: 0.0222s/iter; left time: 272.0255s
Epoch: 10 cost time: 2.8906874656677246
Epoch: 10, Steps: 136 Train Loss: 0.1511 (Forecasting Loss:0.1272 + XiCon Loss:2.3963 x Lambda(0.01)), Vali MSE Loss: 0.1372 Test MSE Loss: 0.2151
Validation loss decreased (0.137468 --> 0.137186).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1480806
	speed: 0.0216s/iter; left time: 261.7969s
Epoch: 11 cost time: 2.88547682762146
Epoch: 11, Steps: 136 Train Loss: 0.1512 (Forecasting Loss:0.1272 + XiCon Loss:2.3994 x Lambda(0.01)), Vali MSE Loss: 0.1372 Test MSE Loss: 0.2149
Validation loss decreased (0.137186 --> 0.137166).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1451060
	speed: 0.0211s/iter; left time: 252.7737s
Epoch: 12 cost time: 2.817898988723755
Epoch: 12, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1271 + XiCon Loss:2.3909 x Lambda(0.01)), Vali MSE Loss: 0.1370 Test MSE Loss: 0.2148
Validation loss decreased (0.137166 --> 0.137011).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1572994
	speed: 0.0224s/iter; left time: 266.1323s
Epoch: 13 cost time: 2.9412872791290283
Epoch: 13, Steps: 136 Train Loss: 0.1509 (Forecasting Loss:0.1270 + XiCon Loss:2.3927 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2147
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1537870
	speed: 0.0214s/iter; left time: 250.8703s
Epoch: 14 cost time: 2.761568546295166
Epoch: 14, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1271 + XiCon Loss:2.3916 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1444930
	speed: 0.0218s/iter; left time: 252.7682s
Epoch: 15 cost time: 2.9064300060272217
Epoch: 15, Steps: 136 Train Loss: 0.1509 (Forecasting Loss:0.1270 + XiCon Loss:2.3888 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1532098
	speed: 0.0231s/iter; left time: 264.3431s
Epoch: 16 cost time: 2.9837210178375244
Epoch: 16, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1271 + XiCon Loss:2.3959 x Lambda(0.01)), Vali MSE Loss: 0.1370 Test MSE Loss: 0.2148
Validation loss decreased (0.137011 --> 0.136977).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1510258
	speed: 0.0231s/iter; left time: 261.1109s
Epoch: 17 cost time: 3.0236992835998535
Epoch: 17, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1271 + XiCon Loss:2.3905 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1556724
	speed: 0.0228s/iter; left time: 255.3741s
Epoch: 18 cost time: 2.963545083999634
Epoch: 18, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1270 + XiCon Loss:2.3916 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1551182
	speed: 0.0224s/iter; left time: 247.5391s
Epoch: 19 cost time: 2.9220759868621826
Epoch: 19, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1270 + XiCon Loss:2.3972 x Lambda(0.01)), Vali MSE Loss: 0.1370 Test MSE Loss: 0.2148
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1533723
	speed: 0.0215s/iter; left time: 235.0793s
Epoch: 20 cost time: 2.8409035205841064
Epoch: 20, Steps: 136 Train Loss: 0.1509 (Forecasting Loss:0.1270 + XiCon Loss:2.3883 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1551879
	speed: 0.0237s/iter; left time: 255.3601s
Epoch: 21 cost time: 3.053107261657715
Epoch: 21, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1271 + XiCon Loss:2.3915 x Lambda(0.01)), Vali MSE Loss: 0.1370 Test MSE Loss: 0.2148
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1487001
	speed: 0.0218s/iter; left time: 231.6290s
Epoch: 22 cost time: 2.8837103843688965
Epoch: 22, Steps: 136 Train Loss: 0.1511 (Forecasting Loss:0.1271 + XiCon Loss:2.3991 x Lambda(0.01)), Vali MSE Loss: 0.1370 Test MSE Loss: 0.2148
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1541138
	speed: 0.0233s/iter; left time: 244.3745s
Epoch: 23 cost time: 3.0456745624542236
Epoch: 23, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1270 + XiCon Loss:2.3982 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1462949
	speed: 0.0223s/iter; left time: 231.7888s
Epoch: 24 cost time: 2.905777931213379
Epoch: 24, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1270 + XiCon Loss:2.3953 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1536069
	speed: 0.0221s/iter; left time: 225.8989s
Epoch: 25 cost time: 2.88897442817688
Epoch: 25, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1271 + XiCon Loss:2.3962 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1554445
	speed: 0.0213s/iter; left time: 215.6509s
Epoch: 26 cost time: 2.8011765480041504
Epoch: 26, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1270 + XiCon Loss:2.3987 x Lambda(0.01)), Vali MSE Loss: 0.1371 Test MSE Loss: 0.2148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.17408962547779083, mae:0.255564421415329, mape:0.6584473252296448, mspe:38.00752258300781 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.1413
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2638009
	speed: 0.0211s/iter; left time: 284.9923s
Epoch: 1 cost time: 2.8504719734191895
Epoch: 1, Steps: 136 Train Loss: 0.3665 (Forecasting Loss:0.3412 + XiCon Loss:2.5283 x Lambda(0.01)), Vali MSE Loss: 0.2653 Test MSE Loss: 0.3812
Validation loss decreased (inf --> 0.265304).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1707973
	speed: 0.0212s/iter; left time: 282.9981s
Epoch: 2 cost time: 2.8379149436950684
Epoch: 2, Steps: 136 Train Loss: 0.1960 (Forecasting Loss:0.1714 + XiCon Loss:2.4642 x Lambda(0.01)), Vali MSE Loss: 0.1691 Test MSE Loss: 0.2531
Validation loss decreased (0.265304 --> 0.169093).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1642080
	speed: 0.0207s/iter; left time: 273.3437s
Epoch: 3 cost time: 2.7674360275268555
Epoch: 3, Steps: 136 Train Loss: 0.1659 (Forecasting Loss:0.1415 + XiCon Loss:2.4431 x Lambda(0.01)), Vali MSE Loss: 0.1551 Test MSE Loss: 0.2222
Validation loss decreased (0.169093 --> 0.155149).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1570417
	speed: 0.0202s/iter; left time: 264.8394s
Epoch: 4 cost time: 2.66191029548645
Epoch: 4, Steps: 136 Train Loss: 0.1576 (Forecasting Loss:0.1333 + XiCon Loss:2.4302 x Lambda(0.01)), Vali MSE Loss: 0.1506 Test MSE Loss: 0.2138
Validation loss decreased (0.155149 --> 0.150607).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1470318
	speed: 0.0212s/iter; left time: 274.0431s
Epoch: 5 cost time: 2.798224925994873
Epoch: 5, Steps: 136 Train Loss: 0.1534 (Forecasting Loss:0.1292 + XiCon Loss:2.4141 x Lambda(0.01)), Vali MSE Loss: 0.1431 Test MSE Loss: 0.2105
Validation loss decreased (0.150607 --> 0.143139).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1455140
	speed: 0.0209s/iter; left time: 268.0130s
Epoch: 6 cost time: 2.7498600482940674
Epoch: 6, Steps: 136 Train Loss: 0.1514 (Forecasting Loss:0.1272 + XiCon Loss:2.4169 x Lambda(0.01)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2087
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1516184
	speed: 0.0206s/iter; left time: 261.2295s
Epoch: 7 cost time: 2.7715532779693604
Epoch: 7, Steps: 136 Train Loss: 0.1504 (Forecasting Loss:0.1262 + XiCon Loss:2.4202 x Lambda(0.01)), Vali MSE Loss: 0.1414 Test MSE Loss: 0.2069
Validation loss decreased (0.143139 --> 0.141387).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1497698
	speed: 0.0203s/iter; left time: 255.0127s
Epoch: 8 cost time: 2.6950318813323975
Epoch: 8, Steps: 136 Train Loss: 0.1498 (Forecasting Loss:0.1256 + XiCon Loss:2.4132 x Lambda(0.01)), Vali MSE Loss: 0.1420 Test MSE Loss: 0.2067
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1547246
	speed: 0.0206s/iter; left time: 256.0836s
Epoch: 9 cost time: 2.689704656600952
Epoch: 9, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1253 + XiCon Loss:2.4134 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2071
Validation loss decreased (0.141387 --> 0.140815).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1514312
	speed: 0.0173s/iter; left time: 212.5654s
Epoch: 10 cost time: 2.2682547569274902
Epoch: 10, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1252 + XiCon Loss:2.4179 x Lambda(0.01)), Vali MSE Loss: 0.1417 Test MSE Loss: 0.2067
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1439386
	speed: 0.0671s/iter; left time: 815.0493s
Epoch: 11 cost time: 8.539928436279297
Epoch: 11, Steps: 136 Train Loss: 0.1493 (Forecasting Loss:0.1251 + XiCon Loss:2.4144 x Lambda(0.01)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.2068
Validation loss decreased (0.140815 --> 0.140730).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1510423
	speed: 0.0195s/iter; left time: 234.6670s
Epoch: 12 cost time: 2.5674049854278564
Epoch: 12, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1250 + XiCon Loss:2.4183 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2070
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1433072
	speed: 0.0176s/iter; left time: 208.6693s
Epoch: 13 cost time: 2.314789295196533
Epoch: 13, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1250 + XiCon Loss:2.4202 x Lambda(0.01)), Vali MSE Loss: 0.1410 Test MSE Loss: 0.2069
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1470311
	speed: 0.0180s/iter; left time: 210.8077s
Epoch: 14 cost time: 2.411412477493286
Epoch: 14, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1250 + XiCon Loss:2.4130 x Lambda(0.01)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.2067
Validation loss decreased (0.140730 --> 0.140720).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1530603
	speed: 0.0204s/iter; left time: 236.4678s
Epoch: 15 cost time: 2.68769907951355
Epoch: 15, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1250 + XiCon Loss:2.4111 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2068
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1539141
	speed: 0.0226s/iter; left time: 258.8737s
Epoch: 16 cost time: 2.920567750930786
Epoch: 16, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1250 + XiCon Loss:2.4138 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2068
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1438542
	speed: 0.0210s/iter; left time: 237.8857s
Epoch: 17 cost time: 2.757894515991211
Epoch: 17, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1250 + XiCon Loss:2.4121 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2068
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1507522
	speed: 0.0201s/iter; left time: 224.7526s
Epoch: 18 cost time: 2.6345725059509277
Epoch: 18, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1250 + XiCon Loss:2.4185 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2068
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1530722
	speed: 0.0205s/iter; left time: 226.1230s
Epoch: 19 cost time: 2.6938579082489014
Epoch: 19, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1250 + XiCon Loss:2.4094 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2068
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1453594
	speed: 0.0217s/iter; left time: 236.7209s
Epoch: 20 cost time: 2.830498695373535
Epoch: 20, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1250 + XiCon Loss:2.4136 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2068
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1497514
	speed: 0.0192s/iter; left time: 206.5634s
Epoch: 21 cost time: 2.552565336227417
Epoch: 21, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1250 + XiCon Loss:2.4171 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2068
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1506334
	speed: 0.0202s/iter; left time: 215.0865s
Epoch: 22 cost time: 2.687657117843628
Epoch: 22, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1250 + XiCon Loss:2.4178 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2068
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1456752
	speed: 0.0202s/iter; left time: 212.2747s
Epoch: 23 cost time: 2.6501808166503906
Epoch: 23, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1250 + XiCon Loss:2.4108 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2068
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1487259
	speed: 0.0216s/iter; left time: 224.3859s
Epoch: 24 cost time: 2.820081949234009
Epoch: 24, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1250 + XiCon Loss:2.4153 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2068
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.16980361938476562, mae:0.2436646819114685, mape:0.6069135665893555, mspe:27.802953720092773 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.1846
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2579858
	speed: 0.0217s/iter; left time: 293.4484s
Epoch: 1 cost time: 2.8109312057495117
Epoch: 1, Steps: 136 Train Loss: 0.3574 (Forecasting Loss:0.3323 + XiCon Loss:2.5133 x Lambda(0.01)), Vali MSE Loss: 0.2546 Test MSE Loss: 0.3659
Validation loss decreased (inf --> 0.254613).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1789218
	speed: 0.0232s/iter; left time: 310.5187s
Epoch: 2 cost time: 3.1062238216400146
Epoch: 2, Steps: 136 Train Loss: 0.1957 (Forecasting Loss:0.1711 + XiCon Loss:2.4658 x Lambda(0.01)), Vali MSE Loss: 0.1718 Test MSE Loss: 0.2437
Validation loss decreased (0.254613 --> 0.171781).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1644477
	speed: 0.0229s/iter; left time: 303.3870s
Epoch: 3 cost time: 2.9662647247314453
Epoch: 3, Steps: 136 Train Loss: 0.1655 (Forecasting Loss:0.1411 + XiCon Loss:2.4402 x Lambda(0.01)), Vali MSE Loss: 0.1605 Test MSE Loss: 0.2172
Validation loss decreased (0.171781 --> 0.160482).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1585832
	speed: 0.0208s/iter; left time: 272.5053s
Epoch: 4 cost time: 2.7348101139068604
Epoch: 4, Steps: 136 Train Loss: 0.1571 (Forecasting Loss:0.1330 + XiCon Loss:2.4176 x Lambda(0.01)), Vali MSE Loss: 0.1641 Test MSE Loss: 0.2092
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1573029
	speed: 0.0242s/iter; left time: 313.1177s
Epoch: 5 cost time: 3.0701451301574707
Epoch: 5, Steps: 136 Train Loss: 0.1533 (Forecasting Loss:0.1292 + XiCon Loss:2.4106 x Lambda(0.01)), Vali MSE Loss: 0.1564 Test MSE Loss: 0.2128
Validation loss decreased (0.160482 --> 0.156367).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1537127
	speed: 0.0205s/iter; left time: 262.9022s
Epoch: 6 cost time: 2.6712265014648438
Epoch: 6, Steps: 136 Train Loss: 0.1513 (Forecasting Loss:0.1272 + XiCon Loss:2.4128 x Lambda(0.01)), Vali MSE Loss: 0.1510 Test MSE Loss: 0.2089
Validation loss decreased (0.156367 --> 0.151032).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1437341
	speed: 0.0198s/iter; left time: 251.6488s
Epoch: 7 cost time: 2.6371090412139893
Epoch: 7, Steps: 136 Train Loss: 0.1503 (Forecasting Loss:0.1262 + XiCon Loss:2.4032 x Lambda(0.01)), Vali MSE Loss: 0.1566 Test MSE Loss: 0.2083
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1489124
	speed: 0.0200s/iter; left time: 251.3975s
Epoch: 8 cost time: 2.6753621101379395
Epoch: 8, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1257 + XiCon Loss:2.4024 x Lambda(0.01)), Vali MSE Loss: 0.1534 Test MSE Loss: 0.2079
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1541736
	speed: 0.0207s/iter; left time: 256.7061s
Epoch: 9 cost time: 2.7356486320495605
Epoch: 9, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1254 + XiCon Loss:2.4097 x Lambda(0.01)), Vali MSE Loss: 0.1536 Test MSE Loss: 0.2078
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1417687
	speed: 0.0201s/iter; left time: 246.3475s
Epoch: 10 cost time: 2.6335694789886475
Epoch: 10, Steps: 136 Train Loss: 0.1493 (Forecasting Loss:0.1253 + XiCon Loss:2.4046 x Lambda(0.01)), Vali MSE Loss: 0.1533 Test MSE Loss: 0.2071
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1486961
	speed: 0.0206s/iter; left time: 250.3869s
Epoch: 11 cost time: 2.7803115844726562
Epoch: 11, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1252 + XiCon Loss:2.4053 x Lambda(0.01)), Vali MSE Loss: 0.1535 Test MSE Loss: 0.2072
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1581011
	speed: 0.0207s/iter; left time: 249.0363s
Epoch: 12 cost time: 2.780573606491089
Epoch: 12, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1251 + XiCon Loss:2.4072 x Lambda(0.01)), Vali MSE Loss: 0.1535 Test MSE Loss: 0.2075
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1481685
	speed: 0.0235s/iter; left time: 278.9945s
Epoch: 13 cost time: 2.9636144638061523
Epoch: 13, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1251 + XiCon Loss:2.4040 x Lambda(0.01)), Vali MSE Loss: 0.1536 Test MSE Loss: 0.2076
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1599770
	speed: 0.0207s/iter; left time: 242.5363s
Epoch: 14 cost time: 2.7402734756469727
Epoch: 14, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1251 + XiCon Loss:2.4056 x Lambda(0.01)), Vali MSE Loss: 0.1534 Test MSE Loss: 0.2075
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1440210
	speed: 0.0206s/iter; left time: 238.9817s
Epoch: 15 cost time: 2.6927108764648438
Epoch: 15, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1251 + XiCon Loss:2.4047 x Lambda(0.01)), Vali MSE Loss: 0.1535 Test MSE Loss: 0.2075
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1404874
	speed: 0.0201s/iter; left time: 230.6468s
Epoch: 16 cost time: 2.6545753479003906
Epoch: 16, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1251 + XiCon Loss:2.4042 x Lambda(0.01)), Vali MSE Loss: 0.1535 Test MSE Loss: 0.2075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.1709097921848297, mae:0.24679797887802124, mape:0.6243939399719238, mspe:31.658992767333984 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.1035
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2644752
	speed: 0.0200s/iter; left time: 270.6137s
Epoch: 1 cost time: 2.679086923599243
Epoch: 1, Steps: 136 Train Loss: 0.3592 (Forecasting Loss:0.3338 + XiCon Loss:2.5455 x Lambda(0.01)), Vali MSE Loss: 0.2616 Test MSE Loss: 0.3763
Validation loss decreased (inf --> 0.261566).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1756719
	speed: 0.0244s/iter; left time: 326.7456s
Epoch: 2 cost time: 3.076653480529785
Epoch: 2, Steps: 136 Train Loss: 0.1961 (Forecasting Loss:0.1713 + XiCon Loss:2.4727 x Lambda(0.01)), Vali MSE Loss: 0.1725 Test MSE Loss: 0.2410
Validation loss decreased (0.261566 --> 0.172539).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1588517
	speed: 0.0196s/iter; left time: 259.5414s
Epoch: 3 cost time: 2.5965964794158936
Epoch: 3, Steps: 136 Train Loss: 0.1651 (Forecasting Loss:0.1405 + XiCon Loss:2.4587 x Lambda(0.01)), Vali MSE Loss: 0.1549 Test MSE Loss: 0.2378
Validation loss decreased (0.172539 --> 0.154928).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1590986
	speed: 0.0196s/iter; left time: 256.5289s
Epoch: 4 cost time: 2.5897750854492188
Epoch: 4, Steps: 136 Train Loss: 0.1570 (Forecasting Loss:0.1326 + XiCon Loss:2.4412 x Lambda(0.01)), Vali MSE Loss: 0.1455 Test MSE Loss: 0.2109
Validation loss decreased (0.154928 --> 0.145451).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1504326
	speed: 0.0222s/iter; left time: 288.0852s
Epoch: 5 cost time: 2.882169246673584
Epoch: 5, Steps: 136 Train Loss: 0.1532 (Forecasting Loss:0.1288 + XiCon Loss:2.4389 x Lambda(0.01)), Vali MSE Loss: 0.1440 Test MSE Loss: 0.2092
Validation loss decreased (0.145451 --> 0.144031).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1544738
	speed: 0.0196s/iter; left time: 250.9090s
Epoch: 6 cost time: 2.56577467918396
Epoch: 6, Steps: 136 Train Loss: 0.1513 (Forecasting Loss:0.1268 + XiCon Loss:2.4449 x Lambda(0.01)), Vali MSE Loss: 0.1410 Test MSE Loss: 0.2050
Validation loss decreased (0.144031 --> 0.140960).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1571922
	speed: 0.0192s/iter; left time: 243.1439s
Epoch: 7 cost time: 2.552192211151123
Epoch: 7, Steps: 136 Train Loss: 0.1501 (Forecasting Loss:0.1258 + XiCon Loss:2.4353 x Lambda(0.01)), Vali MSE Loss: 0.1388 Test MSE Loss: 0.2081
Validation loss decreased (0.140960 --> 0.138829).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1519496
	speed: 0.0207s/iter; left time: 259.4455s
Epoch: 8 cost time: 2.75073504447937
Epoch: 8, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1253 + XiCon Loss:2.4300 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2062
Validation loss decreased (0.138829 --> 0.137888).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1484576
	speed: 0.0202s/iter; left time: 250.7781s
Epoch: 9 cost time: 2.6368000507354736
Epoch: 9, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1250 + XiCon Loss:2.4373 x Lambda(0.01)), Vali MSE Loss: 0.1382 Test MSE Loss: 0.2083
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1495590
	speed: 0.0223s/iter; left time: 273.7033s
Epoch: 10 cost time: 2.8770060539245605
Epoch: 10, Steps: 136 Train Loss: 0.1493 (Forecasting Loss:0.1249 + XiCon Loss:2.4388 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2075
Validation loss decreased (0.137888 --> 0.137674).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1537917
	speed: 0.0203s/iter; left time: 246.4610s
Epoch: 11 cost time: 2.683063507080078
Epoch: 11, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1248 + XiCon Loss:2.4314 x Lambda(0.01)), Vali MSE Loss: 0.1381 Test MSE Loss: 0.2065
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1546731
	speed: 0.0196s/iter; left time: 235.4301s
Epoch: 12 cost time: 2.613283634185791
Epoch: 12, Steps: 136 Train Loss: 0.1490 (Forecasting Loss:0.1247 + XiCon Loss:2.4306 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2070
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1501681
	speed: 0.0200s/iter; left time: 237.0097s
Epoch: 13 cost time: 2.6502749919891357
Epoch: 13, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1247 + XiCon Loss:2.4359 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1465492
	speed: 0.0204s/iter; left time: 238.9194s
Epoch: 14 cost time: 2.7020668983459473
Epoch: 14, Steps: 136 Train Loss: 0.1490 (Forecasting Loss:0.1247 + XiCon Loss:2.4318 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2070
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1451771
	speed: 0.0200s/iter; left time: 231.9253s
Epoch: 15 cost time: 2.6141674518585205
Epoch: 15, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1247 + XiCon Loss:2.4366 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2069
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1516331
	speed: 0.0205s/iter; left time: 235.4466s
Epoch: 16 cost time: 2.651756763458252
Epoch: 16, Steps: 136 Train Loss: 0.1490 (Forecasting Loss:0.1246 + XiCon Loss:2.4321 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1516238
	speed: 0.0197s/iter; left time: 223.0723s
Epoch: 17 cost time: 2.6025688648223877
Epoch: 17, Steps: 136 Train Loss: 0.1490 (Forecasting Loss:0.1246 + XiCon Loss:2.4375 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2069
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1504872
	speed: 0.0220s/iter; left time: 245.8051s
Epoch: 18 cost time: 2.874833822250366
Epoch: 18, Steps: 136 Train Loss: 0.1490 (Forecasting Loss:0.1247 + XiCon Loss:2.4328 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2069
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1520593
	speed: 0.0203s/iter; left time: 223.9187s
Epoch: 19 cost time: 2.6756792068481445
Epoch: 19, Steps: 136 Train Loss: 0.1490 (Forecasting Loss:0.1246 + XiCon Loss:2.4345 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1509940
	speed: 0.0208s/iter; left time: 227.4700s
Epoch: 20 cost time: 2.766099214553833
Epoch: 20, Steps: 136 Train Loss: 0.1490 (Forecasting Loss:0.1247 + XiCon Loss:2.4308 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2069
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.16963407397270203, mae:0.2454327642917633, mape:0.6161433458328247, mspe:27.633230209350586 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1723+-0.00390, MAE:0.2485+-0.00595, MAPE:0.6264+-0.02417, MSPE:30.8793+-5.33820, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=2160, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.5, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0635
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2418720
	speed: 0.0273s/iter; left time: 339.0782s
Epoch: 1 cost time: 3.238823175430298
Epoch: 1, Steps: 125 Train Loss: 0.3528 (Forecasting Loss:0.3502 + XiCon Loss:2.6014 x Lambda(0.001)), Vali MSE Loss: 0.2760 Test MSE Loss: 0.3744
Validation loss decreased (inf --> 0.276001).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1672489
	speed: 0.0243s/iter; left time: 297.7617s
Epoch: 2 cost time: 3.00747013092041
Epoch: 2, Steps: 125 Train Loss: 0.1820 (Forecasting Loss:0.1794 + XiCon Loss:2.5469 x Lambda(0.001)), Vali MSE Loss: 0.1958 Test MSE Loss: 0.2420
Validation loss decreased (0.276001 --> 0.195841).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1510219
	speed: 0.0239s/iter; left time: 290.2888s
Epoch: 3 cost time: 2.9042840003967285
Epoch: 3, Steps: 125 Train Loss: 0.1502 (Forecasting Loss:0.1477 + XiCon Loss:2.5152 x Lambda(0.001)), Vali MSE Loss: 0.1816 Test MSE Loss: 0.2218
Validation loss decreased (0.195841 --> 0.181642).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1290518
	speed: 0.0232s/iter; left time: 278.4629s
Epoch: 4 cost time: 2.8166444301605225
Epoch: 4, Steps: 125 Train Loss: 0.1426 (Forecasting Loss:0.1401 + XiCon Loss:2.5092 x Lambda(0.001)), Vali MSE Loss: 0.1825 Test MSE Loss: 0.2276
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1442456
	speed: 0.0230s/iter; left time: 273.3053s
Epoch: 5 cost time: 2.7916836738586426
Epoch: 5, Steps: 125 Train Loss: 0.1385 (Forecasting Loss:0.1360 + XiCon Loss:2.5086 x Lambda(0.001)), Vali MSE Loss: 0.1809 Test MSE Loss: 0.2193
Validation loss decreased (0.181642 --> 0.180875).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1328515
	speed: 0.0251s/iter; left time: 295.7128s
Epoch: 6 cost time: 3.005613088607788
Epoch: 6, Steps: 125 Train Loss: 0.1366 (Forecasting Loss:0.1341 + XiCon Loss:2.5194 x Lambda(0.001)), Vali MSE Loss: 0.1804 Test MSE Loss: 0.2130
Validation loss decreased (0.180875 --> 0.180389).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1310615
	speed: 0.0231s/iter; left time: 269.2084s
Epoch: 7 cost time: 2.8553202152252197
Epoch: 7, Steps: 125 Train Loss: 0.1357 (Forecasting Loss:0.1332 + XiCon Loss:2.5160 x Lambda(0.001)), Vali MSE Loss: 0.1813 Test MSE Loss: 0.2154
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1391517
	speed: 0.0231s/iter; left time: 266.1473s
Epoch: 8 cost time: 2.82722806930542
Epoch: 8, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5034 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
Validation loss decreased (0.180389 --> 0.180081).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1328592
	speed: 0.0243s/iter; left time: 276.7074s
Epoch: 9 cost time: 2.925670862197876
Epoch: 9, Steps: 125 Train Loss: 0.1348 (Forecasting Loss:0.1323 + XiCon Loss:2.5076 x Lambda(0.001)), Vali MSE Loss: 0.1804 Test MSE Loss: 0.2126
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1353512
	speed: 0.0250s/iter; left time: 282.3694s
Epoch: 10 cost time: 3.0472419261932373
Epoch: 10, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1322 + XiCon Loss:2.5076 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2130
Validation loss decreased (0.180081 --> 0.179986).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1444305
	speed: 0.0233s/iter; left time: 260.0161s
Epoch: 11 cost time: 2.840550184249878
Epoch: 11, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5122 x Lambda(0.001)), Vali MSE Loss: 0.1799 Test MSE Loss: 0.2114
Validation loss decreased (0.179986 --> 0.179915).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1387330
	speed: 0.0240s/iter; left time: 264.7713s
Epoch: 12 cost time: 2.911263942718506
Epoch: 12, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5038 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1291420
	speed: 0.0230s/iter; left time: 251.0223s
Epoch: 13 cost time: 2.7864091396331787
Epoch: 13, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.5099 x Lambda(0.001)), Vali MSE Loss: 0.1804 Test MSE Loss: 0.2117
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1318242
	speed: 0.0233s/iter; left time: 250.9678s
Epoch: 14 cost time: 2.8305928707122803
Epoch: 14, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.5082 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1378766
	speed: 0.0237s/iter; left time: 252.2308s
Epoch: 15 cost time: 2.871900796890259
Epoch: 15, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5134 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2117
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1399046
	speed: 0.0228s/iter; left time: 240.0264s
Epoch: 16 cost time: 2.8049159049987793
Epoch: 16, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5115 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1296665
	speed: 0.0233s/iter; left time: 242.6593s
Epoch: 17 cost time: 2.8678128719329834
Epoch: 17, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.5155 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1303838
	speed: 0.0255s/iter; left time: 262.2344s
Epoch: 18 cost time: 3.0759196281433105
Epoch: 18, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.5137 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1308222
	speed: 0.0237s/iter; left time: 240.5920s
Epoch: 19 cost time: 2.9570019245147705
Epoch: 19, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.5151 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1365589
	speed: 0.0234s/iter; left time: 234.2059s
Epoch: 20 cost time: 2.8718626499176025
Epoch: 20, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5083 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1429599
	speed: 0.0247s/iter; left time: 244.5336s
Epoch: 21 cost time: 2.990393877029419
Epoch: 21, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.5033 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.1739054173231125, mae:0.24890980124473572, mape:0.5952094793319702, mspe:24.610172271728516 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.6037
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2370571
	speed: 0.0238s/iter; left time: 294.9399s
Epoch: 1 cost time: 2.8827056884765625
Epoch: 1, Steps: 125 Train Loss: 0.3436 (Forecasting Loss:0.3410 + XiCon Loss:2.5716 x Lambda(0.001)), Vali MSE Loss: 0.2649 Test MSE Loss: 0.3614
Validation loss decreased (inf --> 0.264934).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1587517
	speed: 0.0249s/iter; left time: 305.8335s
Epoch: 2 cost time: 3.0435192584991455
Epoch: 2, Steps: 125 Train Loss: 0.1830 (Forecasting Loss:0.1804 + XiCon Loss:2.6170 x Lambda(0.001)), Vali MSE Loss: 0.1759 Test MSE Loss: 0.2426
Validation loss decreased (0.264934 --> 0.175895).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1468761
	speed: 0.0253s/iter; left time: 307.1688s
Epoch: 3 cost time: 3.0436813831329346
Epoch: 3, Steps: 125 Train Loss: 0.1507 (Forecasting Loss:0.1481 + XiCon Loss:2.5429 x Lambda(0.001)), Vali MSE Loss: 0.1653 Test MSE Loss: 0.2144
Validation loss decreased (0.175895 --> 0.165325).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1316690
	speed: 0.0239s/iter; left time: 286.8441s
Epoch: 4 cost time: 2.890652656555176
Epoch: 4, Steps: 125 Train Loss: 0.1427 (Forecasting Loss:0.1401 + XiCon Loss:2.5230 x Lambda(0.001)), Vali MSE Loss: 0.1571 Test MSE Loss: 0.2130
Validation loss decreased (0.165325 --> 0.157089).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1413929
	speed: 0.0230s/iter; left time: 273.5291s
Epoch: 5 cost time: 2.8206188678741455
Epoch: 5, Steps: 125 Train Loss: 0.1390 (Forecasting Loss:0.1364 + XiCon Loss:2.5205 x Lambda(0.001)), Vali MSE Loss: 0.1552 Test MSE Loss: 0.2072
Validation loss decreased (0.157089 --> 0.155153).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1402509
	speed: 0.0255s/iter; left time: 300.8453s
Epoch: 6 cost time: 3.0767767429351807
Epoch: 6, Steps: 125 Train Loss: 0.1372 (Forecasting Loss:0.1347 + XiCon Loss:2.5180 x Lambda(0.001)), Vali MSE Loss: 0.1530 Test MSE Loss: 0.2037
Validation loss decreased (0.155153 --> 0.152976).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1248775
	speed: 0.0232s/iter; left time: 269.8560s
Epoch: 7 cost time: 2.839538335800171
Epoch: 7, Steps: 125 Train Loss: 0.1362 (Forecasting Loss:0.1337 + XiCon Loss:2.5159 x Lambda(0.001)), Vali MSE Loss: 0.1517 Test MSE Loss: 0.2034
Validation loss decreased (0.152976 --> 0.151660).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1297244
	speed: 0.0235s/iter; left time: 271.2602s
Epoch: 8 cost time: 2.899656057357788
Epoch: 8, Steps: 125 Train Loss: 0.1356 (Forecasting Loss:0.1331 + XiCon Loss:2.5149 x Lambda(0.001)), Vali MSE Loss: 0.1515 Test MSE Loss: 0.2050
Validation loss decreased (0.151660 --> 0.151457).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1317680
	speed: 0.0246s/iter; left time: 280.8488s
Epoch: 9 cost time: 3.0416042804718018
Epoch: 9, Steps: 125 Train Loss: 0.1354 (Forecasting Loss:0.1329 + XiCon Loss:2.5114 x Lambda(0.001)), Vali MSE Loss: 0.1519 Test MSE Loss: 0.2035
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1377976
	speed: 0.0722s/iter; left time: 813.6677s
Epoch: 10 cost time: 8.667695999145508
Epoch: 10, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1327 + XiCon Loss:2.5121 x Lambda(0.001)), Vali MSE Loss: 0.1505 Test MSE Loss: 0.2047
Validation loss decreased (0.151457 --> 0.150490).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1328875
	speed: 0.0244s/iter; left time: 272.1435s
Epoch: 11 cost time: 2.9492735862731934
Epoch: 11, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5199 x Lambda(0.001)), Vali MSE Loss: 0.1506 Test MSE Loss: 0.2046
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1317714
	speed: 0.0198s/iter; left time: 218.1648s
Epoch: 12 cost time: 2.427598476409912
Epoch: 12, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5153 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2047
Validation loss decreased (0.150490 --> 0.150116).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1320785
	speed: 0.0213s/iter; left time: 231.9069s
Epoch: 13 cost time: 2.6860435009002686
Epoch: 13, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5089 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2049
Validation loss decreased (0.150116 --> 0.150075).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1328213
	speed: 0.0243s/iter; left time: 261.9385s
Epoch: 14 cost time: 2.973912000656128
Epoch: 14, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5166 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
Validation loss decreased (0.150075 --> 0.150021).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1346166
	speed: 0.0243s/iter; left time: 258.9415s
Epoch: 15 cost time: 3.025803565979004
Epoch: 15, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5192 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1300001
	speed: 0.0259s/iter; left time: 272.7946s
Epoch: 16 cost time: 3.1362152099609375
Epoch: 16, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5255 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1293533
	speed: 0.0238s/iter; left time: 247.4434s
Epoch: 17 cost time: 2.908083915710449
Epoch: 17, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5163 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1371951
	speed: 0.0244s/iter; left time: 250.5372s
Epoch: 18 cost time: 3.0609819889068604
Epoch: 18, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5205 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
Validation loss decreased (0.150021 --> 0.149978).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1300185
	speed: 0.0239s/iter; left time: 242.3108s
Epoch: 19 cost time: 2.8855080604553223
Epoch: 19, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5175 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1380380
	speed: 0.0254s/iter; left time: 255.0798s
Epoch: 20 cost time: 3.079582452774048
Epoch: 20, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5164 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1406347
	speed: 0.0286s/iter; left time: 283.3076s
Epoch: 21 cost time: 3.5610177516937256
Epoch: 21, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5162 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1301861
	speed: 0.0234s/iter; left time: 229.1891s
Epoch: 22 cost time: 2.8722176551818848
Epoch: 22, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5163 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1316295
	speed: 0.0242s/iter; left time: 233.5171s
Epoch: 23 cost time: 2.927434206008911
Epoch: 23, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5110 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1290296
	speed: 0.0254s/iter; left time: 241.8097s
Epoch: 24 cost time: 3.1066317558288574
Epoch: 24, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5165 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1354466
	speed: 0.0243s/iter; left time: 228.2823s
Epoch: 25 cost time: 2.9846673011779785
Epoch: 25, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5108 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1321311
	speed: 0.0239s/iter; left time: 221.5870s
Epoch: 26 cost time: 2.920088768005371
Epoch: 26, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5154 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
Validation loss decreased (0.149978 --> 0.149974).  Saving model ...
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1336739
	speed: 0.0257s/iter; left time: 234.9204s
Epoch: 27 cost time: 3.1596009731292725
Epoch: 27, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5137 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1368034
	speed: 0.0240s/iter; left time: 216.1982s
Epoch: 28 cost time: 2.9136011600494385
Epoch: 28, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5079 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1392846
	speed: 0.0238s/iter; left time: 212.0386s
Epoch: 29 cost time: 2.8834056854248047
Epoch: 29, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5111 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1421015
	speed: 0.0247s/iter; left time: 216.8422s
Epoch: 30 cost time: 3.013239622116089
Epoch: 30, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1324 + XiCon Loss:2.5170 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.1480585
	speed: 0.0239s/iter; left time: 206.5588s
Epoch: 31 cost time: 2.924069404602051
Epoch: 31, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5183 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2050
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.1362214
	speed: 0.0245s/iter; left time: 208.7412s
Epoch: 32 cost time: 2.9476993083953857
Epoch: 32, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5126 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.1382762
	speed: 0.0262s/iter; left time: 219.9173s
Epoch: 33 cost time: 3.104766845703125
Epoch: 33, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5135 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.1428142
	speed: 0.0237s/iter; left time: 195.8407s
Epoch: 34 cost time: 2.8718838691711426
Epoch: 34, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5180 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.820766091346741e-13
	iters: 100, epoch: 35 | loss: 0.1310350
	speed: 0.0248s/iter; left time: 202.3392s
Epoch: 35 cost time: 2.984092950820923
Epoch: 35, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5120 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.9103830456733704e-13
	iters: 100, epoch: 36 | loss: 0.1358698
	speed: 0.0239s/iter; left time: 191.9506s
Epoch: 36 cost time: 2.9259390830993652
Epoch: 36, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5162 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2050
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16574814915657043, mae:0.24422913789749146, mape:0.6077800393104553, mspe:32.29590606689453 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7409
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2394465
	speed: 0.0245s/iter; left time: 303.9251s
Epoch: 1 cost time: 3.0034661293029785
Epoch: 1, Steps: 125 Train Loss: 0.3427 (Forecasting Loss:0.3401 + XiCon Loss:2.6001 x Lambda(0.001)), Vali MSE Loss: 0.2615 Test MSE Loss: 0.3602
Validation loss decreased (inf --> 0.261464).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1652408
	speed: 0.0252s/iter; left time: 309.6185s
Epoch: 2 cost time: 3.092634677886963
Epoch: 2, Steps: 125 Train Loss: 0.1814 (Forecasting Loss:0.1788 + XiCon Loss:2.6084 x Lambda(0.001)), Vali MSE Loss: 0.1854 Test MSE Loss: 0.2312
Validation loss decreased (0.261464 --> 0.185354).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1511062
	speed: 0.0270s/iter; left time: 327.5561s
Epoch: 3 cost time: 3.3301937580108643
Epoch: 3, Steps: 125 Train Loss: 0.1509 (Forecasting Loss:0.1483 + XiCon Loss:2.5624 x Lambda(0.001)), Vali MSE Loss: 0.1580 Test MSE Loss: 0.2259
Validation loss decreased (0.185354 --> 0.157999).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1421185
	speed: 0.0274s/iter; left time: 329.5874s
Epoch: 4 cost time: 3.3297643661499023
Epoch: 4, Steps: 125 Train Loss: 0.1428 (Forecasting Loss:0.1403 + XiCon Loss:2.5509 x Lambda(0.001)), Vali MSE Loss: 0.1512 Test MSE Loss: 0.2096
Validation loss decreased (0.157999 --> 0.151231).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1339820
	speed: 0.0269s/iter; left time: 320.3651s
Epoch: 5 cost time: 3.3575639724731445
Epoch: 5, Steps: 125 Train Loss: 0.1389 (Forecasting Loss:0.1364 + XiCon Loss:2.5421 x Lambda(0.001)), Vali MSE Loss: 0.1464 Test MSE Loss: 0.2114
Validation loss decreased (0.151231 --> 0.146351).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1425095
	speed: 0.0259s/iter; left time: 304.4126s
Epoch: 6 cost time: 3.238663911819458
Epoch: 6, Steps: 125 Train Loss: 0.1371 (Forecasting Loss:0.1345 + XiCon Loss:2.5324 x Lambda(0.001)), Vali MSE Loss: 0.1464 Test MSE Loss: 0.2095
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1285072
	speed: 0.0257s/iter; left time: 299.6895s
Epoch: 7 cost time: 3.149186372756958
Epoch: 7, Steps: 125 Train Loss: 0.1360 (Forecasting Loss:0.1335 + XiCon Loss:2.5277 x Lambda(0.001)), Vali MSE Loss: 0.1453 Test MSE Loss: 0.2046
Validation loss decreased (0.146351 --> 0.145340).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1332754
	speed: 0.0281s/iter; left time: 323.6586s
Epoch: 8 cost time: 3.4477689266204834
Epoch: 8, Steps: 125 Train Loss: 0.1356 (Forecasting Loss:0.1331 + XiCon Loss:2.5358 x Lambda(0.001)), Vali MSE Loss: 0.1448 Test MSE Loss: 0.2070
Validation loss decreased (0.145340 --> 0.144752).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1403834
	speed: 0.0268s/iter; left time: 305.4279s
Epoch: 9 cost time: 3.279798984527588
Epoch: 9, Steps: 125 Train Loss: 0.1353 (Forecasting Loss:0.1327 + XiCon Loss:2.5368 x Lambda(0.001)), Vali MSE Loss: 0.1443 Test MSE Loss: 0.2058
Validation loss decreased (0.144752 --> 0.144291).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1315727
	speed: 0.0271s/iter; left time: 305.0737s
Epoch: 10 cost time: 3.3019511699676514
Epoch: 10, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1326 + XiCon Loss:2.5301 x Lambda(0.001)), Vali MSE Loss: 0.1443 Test MSE Loss: 0.2062
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1374746
	speed: 0.0274s/iter; left time: 305.6701s
Epoch: 11 cost time: 3.3227577209472656
Epoch: 11, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5365 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
Validation loss decreased (0.144291 --> 0.143868).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1399444
	speed: 0.0260s/iter; left time: 286.2931s
Epoch: 12 cost time: 3.1788129806518555
Epoch: 12, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5303 x Lambda(0.001)), Vali MSE Loss: 0.1440 Test MSE Loss: 0.2060
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1356526
	speed: 0.0267s/iter; left time: 290.7510s
Epoch: 13 cost time: 3.2760748863220215
Epoch: 13, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5354 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
Validation loss decreased (0.143868 --> 0.143853).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1349063
	speed: 0.0254s/iter; left time: 273.3294s
Epoch: 14 cost time: 3.1386492252349854
Epoch: 14, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5377 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1360467
	speed: 0.0302s/iter; left time: 321.3695s
Epoch: 15 cost time: 3.7205309867858887
Epoch: 15, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5395 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1322450
	speed: 0.0286s/iter; left time: 301.0674s
Epoch: 16 cost time: 3.433295488357544
Epoch: 16, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5391 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1430617
	speed: 0.0698s/iter; left time: 725.8963s
Epoch: 17 cost time: 7.66263222694397
Epoch: 17, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1324 + XiCon Loss:2.5372 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1416251
	speed: 0.0226s/iter; left time: 232.3417s
Epoch: 18 cost time: 2.7901296615600586
Epoch: 18, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5373 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1406332
	speed: 0.0213s/iter; left time: 216.5627s
Epoch: 19 cost time: 2.6293435096740723
Epoch: 19, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1324 + XiCon Loss:2.5357 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1397598
	speed: 0.0263s/iter; left time: 263.4554s
Epoch: 20 cost time: 3.190488815307617
Epoch: 20, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1324 + XiCon Loss:2.5362 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1348523
	speed: 0.0270s/iter; left time: 267.1252s
Epoch: 21 cost time: 3.3245651721954346
Epoch: 21, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5364 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1403998
	speed: 0.0276s/iter; left time: 269.9229s
Epoch: 22 cost time: 3.3515913486480713
Epoch: 22, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5302 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1322023
	speed: 0.0266s/iter; left time: 256.3946s
Epoch: 23 cost time: 3.2349705696105957
Epoch: 23, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5397 x Lambda(0.001)), Vali MSE Loss: 0.1439 Test MSE Loss: 0.2062
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16652436554431915, mae:0.24584385752677917, mape:0.5994546413421631, mspe:27.752832412719727 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0403
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2533808
	speed: 0.0249s/iter; left time: 309.3591s
Epoch: 1 cost time: 3.0339999198913574
Epoch: 1, Steps: 125 Train Loss: 0.3497 (Forecasting Loss:0.3471 + XiCon Loss:2.5868 x Lambda(0.001)), Vali MSE Loss: 0.2710 Test MSE Loss: 0.3762
Validation loss decreased (inf --> 0.271008).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1646088
	speed: 0.0239s/iter; left time: 293.0243s
Epoch: 2 cost time: 2.9498074054718018
Epoch: 2, Steps: 125 Train Loss: 0.1820 (Forecasting Loss:0.1795 + XiCon Loss:2.5511 x Lambda(0.001)), Vali MSE Loss: 0.1828 Test MSE Loss: 0.2289
Validation loss decreased (0.271008 --> 0.182810).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1539301
	speed: 0.0244s/iter; left time: 296.9470s
Epoch: 3 cost time: 2.9617905616760254
Epoch: 3, Steps: 125 Train Loss: 0.1512 (Forecasting Loss:0.1486 + XiCon Loss:2.5469 x Lambda(0.001)), Vali MSE Loss: 0.1584 Test MSE Loss: 0.2236
Validation loss decreased (0.182810 --> 0.158397).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1436560
	speed: 0.0253s/iter; left time: 304.6306s
Epoch: 4 cost time: 3.081598997116089
Epoch: 4, Steps: 125 Train Loss: 0.1430 (Forecasting Loss:0.1405 + XiCon Loss:2.5306 x Lambda(0.001)), Vali MSE Loss: 0.1496 Test MSE Loss: 0.2209
Validation loss decreased (0.158397 --> 0.149611).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1378953
	speed: 0.0235s/iter; left time: 279.7360s
Epoch: 5 cost time: 2.8883485794067383
Epoch: 5, Steps: 125 Train Loss: 0.1393 (Forecasting Loss:0.1368 + XiCon Loss:2.5266 x Lambda(0.001)), Vali MSE Loss: 0.1502 Test MSE Loss: 0.2115
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1259058
	speed: 0.0239s/iter; left time: 281.8397s
Epoch: 6 cost time: 2.914933681488037
Epoch: 6, Steps: 125 Train Loss: 0.1371 (Forecasting Loss:0.1345 + XiCon Loss:2.5282 x Lambda(0.001)), Vali MSE Loss: 0.1482 Test MSE Loss: 0.2045
Validation loss decreased (0.149611 --> 0.148244).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1348114
	speed: 0.0244s/iter; left time: 283.7506s
Epoch: 7 cost time: 2.962745428085327
Epoch: 7, Steps: 125 Train Loss: 0.1360 (Forecasting Loss:0.1335 + XiCon Loss:2.5216 x Lambda(0.001)), Vali MSE Loss: 0.1465 Test MSE Loss: 0.2105
Validation loss decreased (0.148244 --> 0.146517).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1413592
	speed: 0.0239s/iter; left time: 275.3107s
Epoch: 8 cost time: 2.894786834716797
Epoch: 8, Steps: 125 Train Loss: 0.1354 (Forecasting Loss:0.1329 + XiCon Loss:2.5201 x Lambda(0.001)), Vali MSE Loss: 0.1465 Test MSE Loss: 0.2060
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1346604
	speed: 0.0238s/iter; left time: 271.1015s
Epoch: 9 cost time: 2.896623134613037
Epoch: 9, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5339 x Lambda(0.001)), Vali MSE Loss: 0.1471 Test MSE Loss: 0.2058
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1385823
	speed: 0.0254s/iter; left time: 286.1259s
Epoch: 10 cost time: 3.0880286693573
Epoch: 10, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5229 x Lambda(0.001)), Vali MSE Loss: 0.1465 Test MSE Loss: 0.2057
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1393812
	speed: 0.0247s/iter; left time: 275.5603s
Epoch: 11 cost time: 3.0117833614349365
Epoch: 11, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1323 + XiCon Loss:2.5233 x Lambda(0.001)), Vali MSE Loss: 0.1460 Test MSE Loss: 0.2063
Validation loss decreased (0.146517 --> 0.146044).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1297975
	speed: 0.0229s/iter; left time: 252.3477s
Epoch: 12 cost time: 2.8808257579803467
Epoch: 12, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1323 + XiCon Loss:2.5255 x Lambda(0.001)), Vali MSE Loss: 0.1464 Test MSE Loss: 0.2060
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1450022
	speed: 0.0253s/iter; left time: 276.0417s
Epoch: 13 cost time: 3.0634589195251465
Epoch: 13, Steps: 125 Train Loss: 0.1348 (Forecasting Loss:0.1322 + XiCon Loss:2.5254 x Lambda(0.001)), Vali MSE Loss: 0.1461 Test MSE Loss: 0.2060
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1408018
	speed: 0.0248s/iter; left time: 267.5702s
Epoch: 14 cost time: 3.004194498062134
Epoch: 14, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1322 + XiCon Loss:2.5279 x Lambda(0.001)), Vali MSE Loss: 0.1463 Test MSE Loss: 0.2059
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1223602
	speed: 0.0239s/iter; left time: 254.0385s
Epoch: 15 cost time: 2.9745945930480957
Epoch: 15, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1322 + XiCon Loss:2.5273 x Lambda(0.001)), Vali MSE Loss: 0.1464 Test MSE Loss: 0.2058
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1299389
	speed: 0.0243s/iter; left time: 256.2411s
Epoch: 16 cost time: 2.952223062515259
Epoch: 16, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1322 + XiCon Loss:2.5205 x Lambda(0.001)), Vali MSE Loss: 0.1464 Test MSE Loss: 0.2058
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1333701
	speed: 0.0244s/iter; left time: 254.0715s
Epoch: 17 cost time: 2.9525516033172607
Epoch: 17, Steps: 125 Train Loss: 0.1348 (Forecasting Loss:0.1323 + XiCon Loss:2.5247 x Lambda(0.001)), Vali MSE Loss: 0.1463 Test MSE Loss: 0.2058
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1351709
	speed: 0.0247s/iter; left time: 253.5121s
Epoch: 18 cost time: 3.0597712993621826
Epoch: 18, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1322 + XiCon Loss:2.5232 x Lambda(0.001)), Vali MSE Loss: 0.1464 Test MSE Loss: 0.2058
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1307765
	speed: 0.0252s/iter; left time: 256.1834s
Epoch: 19 cost time: 3.0255215167999268
Epoch: 19, Steps: 125 Train Loss: 0.1348 (Forecasting Loss:0.1323 + XiCon Loss:2.5254 x Lambda(0.001)), Vali MSE Loss: 0.1463 Test MSE Loss: 0.2058
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1390626
	speed: 0.0240s/iter; left time: 240.9780s
Epoch: 20 cost time: 2.9087769985198975
Epoch: 20, Steps: 125 Train Loss: 0.1348 (Forecasting Loss:0.1322 + XiCon Loss:2.5248 x Lambda(0.001)), Vali MSE Loss: 0.1463 Test MSE Loss: 0.2058
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1466127
	speed: 0.0234s/iter; left time: 232.0138s
Epoch: 21 cost time: 2.859632968902588
Epoch: 21, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1322 + XiCon Loss:2.5256 x Lambda(0.001)), Vali MSE Loss: 0.1464 Test MSE Loss: 0.2058
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16666609048843384, mae:0.24595551192760468, mape:0.6144747138023376, mspe:33.96283721923828 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8317
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2345198
	speed: 0.0243s/iter; left time: 301.3122s
Epoch: 1 cost time: 2.95520281791687
Epoch: 1, Steps: 125 Train Loss: 0.3470 (Forecasting Loss:0.3445 + XiCon Loss:2.5851 x Lambda(0.001)), Vali MSE Loss: 0.2601 Test MSE Loss: 0.3593
Validation loss decreased (inf --> 0.260121).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1672073
	speed: 0.0244s/iter; left time: 299.8039s
Epoch: 2 cost time: 3.0180609226226807
Epoch: 2, Steps: 125 Train Loss: 0.1816 (Forecasting Loss:0.1790 + XiCon Loss:2.5636 x Lambda(0.001)), Vali MSE Loss: 0.1796 Test MSE Loss: 0.2438
Validation loss decreased (0.260121 --> 0.179643).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1541009
	speed: 0.0242s/iter; left time: 293.4873s
Epoch: 3 cost time: 2.943281650543213
Epoch: 3, Steps: 125 Train Loss: 0.1490 (Forecasting Loss:0.1465 + XiCon Loss:2.5224 x Lambda(0.001)), Vali MSE Loss: 0.1660 Test MSE Loss: 0.2191
Validation loss decreased (0.179643 --> 0.165957).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1482385
	speed: 0.0237s/iter; left time: 285.2155s
Epoch: 4 cost time: 2.8895487785339355
Epoch: 4, Steps: 125 Train Loss: 0.1420 (Forecasting Loss:0.1395 + XiCon Loss:2.5133 x Lambda(0.001)), Vali MSE Loss: 0.1589 Test MSE Loss: 0.2118
Validation loss decreased (0.165957 --> 0.158880).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1360600
	speed: 0.0257s/iter; left time: 306.3908s
Epoch: 5 cost time: 3.2562198638916016
Epoch: 5, Steps: 125 Train Loss: 0.1379 (Forecasting Loss:0.1354 + XiCon Loss:2.5185 x Lambda(0.001)), Vali MSE Loss: 0.1573 Test MSE Loss: 0.2043
Validation loss decreased (0.158880 --> 0.157334).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1394502
	speed: 0.0244s/iter; left time: 287.2639s
Epoch: 6 cost time: 3.107893466949463
Epoch: 6, Steps: 125 Train Loss: 0.1362 (Forecasting Loss:0.1337 + XiCon Loss:2.5077 x Lambda(0.001)), Vali MSE Loss: 0.1565 Test MSE Loss: 0.2041
Validation loss decreased (0.157334 --> 0.156541).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1369673
	speed: 0.0245s/iter; left time: 285.4417s
Epoch: 7 cost time: 2.9677114486694336
Epoch: 7, Steps: 125 Train Loss: 0.1353 (Forecasting Loss:0.1328 + XiCon Loss:2.5134 x Lambda(0.001)), Vali MSE Loss: 0.1556 Test MSE Loss: 0.2077
Validation loss decreased (0.156541 --> 0.155608).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1302582
	speed: 0.0232s/iter; left time: 267.1956s
Epoch: 8 cost time: 2.8191184997558594
Epoch: 8, Steps: 125 Train Loss: 0.1348 (Forecasting Loss:0.1322 + XiCon Loss:2.5093 x Lambda(0.001)), Vali MSE Loss: 0.1557 Test MSE Loss: 0.2045
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1481682
	speed: 0.0238s/iter; left time: 271.0189s
Epoch: 9 cost time: 2.9876551628112793
Epoch: 9, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.5083 x Lambda(0.001)), Vali MSE Loss: 0.1539 Test MSE Loss: 0.2047
Validation loss decreased (0.155608 --> 0.153855).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1425647
	speed: 0.0243s/iter; left time: 273.7631s
Epoch: 10 cost time: 2.97812819480896
Epoch: 10, Steps: 125 Train Loss: 0.1344 (Forecasting Loss:0.1319 + XiCon Loss:2.5125 x Lambda(0.001)), Vali MSE Loss: 0.1555 Test MSE Loss: 0.2032
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1261187
	speed: 0.0237s/iter; left time: 264.3970s
Epoch: 11 cost time: 2.904134511947632
Epoch: 11, Steps: 125 Train Loss: 0.1343 (Forecasting Loss:0.1318 + XiCon Loss:2.5097 x Lambda(0.001)), Vali MSE Loss: 0.1553 Test MSE Loss: 0.2034
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1371059
	speed: 0.0246s/iter; left time: 271.5132s
Epoch: 12 cost time: 3.013280153274536
Epoch: 12, Steps: 125 Train Loss: 0.1342 (Forecasting Loss:0.1317 + XiCon Loss:2.5167 x Lambda(0.001)), Vali MSE Loss: 0.1553 Test MSE Loss: 0.2032
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1347415
	speed: 0.0237s/iter; left time: 258.8104s
Epoch: 13 cost time: 2.9604389667510986
Epoch: 13, Steps: 125 Train Loss: 0.1342 (Forecasting Loss:0.1316 + XiCon Loss:2.5111 x Lambda(0.001)), Vali MSE Loss: 0.1552 Test MSE Loss: 0.2033
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1323543
	speed: 0.0233s/iter; left time: 250.7227s
Epoch: 14 cost time: 2.8924522399902344
Epoch: 14, Steps: 125 Train Loss: 0.1342 (Forecasting Loss:0.1317 + XiCon Loss:2.5124 x Lambda(0.001)), Vali MSE Loss: 0.1552 Test MSE Loss: 0.2034
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1375252
	speed: 0.0244s/iter; left time: 259.5491s
Epoch: 15 cost time: 3.0065767765045166
Epoch: 15, Steps: 125 Train Loss: 0.1342 (Forecasting Loss:0.1317 + XiCon Loss:2.5170 x Lambda(0.001)), Vali MSE Loss: 0.1552 Test MSE Loss: 0.2034
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1213245
	speed: 0.0241s/iter; left time: 253.5600s
Epoch: 16 cost time: 2.9268929958343506
Epoch: 16, Steps: 125 Train Loss: 0.1341 (Forecasting Loss:0.1316 + XiCon Loss:2.5121 x Lambda(0.001)), Vali MSE Loss: 0.1553 Test MSE Loss: 0.2034
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1256942
	speed: 0.0239s/iter; left time: 248.1171s
Epoch: 17 cost time: 2.9823482036590576
Epoch: 17, Steps: 125 Train Loss: 0.1342 (Forecasting Loss:0.1317 + XiCon Loss:2.5126 x Lambda(0.001)), Vali MSE Loss: 0.1553 Test MSE Loss: 0.2034
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1363916
	speed: 0.0259s/iter; left time: 266.1499s
Epoch: 18 cost time: 3.1592888832092285
Epoch: 18, Steps: 125 Train Loss: 0.1342 (Forecasting Loss:0.1317 + XiCon Loss:2.5132 x Lambda(0.001)), Vali MSE Loss: 0.1551 Test MSE Loss: 0.2034
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1337643
	speed: 0.0242s/iter; left time: 245.1593s
Epoch: 19 cost time: 2.9163765907287598
Epoch: 19, Steps: 125 Train Loss: 0.1342 (Forecasting Loss:0.1317 + XiCon Loss:2.5125 x Lambda(0.001)), Vali MSE Loss: 0.1552 Test MSE Loss: 0.2034
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16605882346630096, mae:0.24328283965587616, mape:0.5902641415596008, mspe:26.243484497070312 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1678+-0.00428, MAE:0.2456+-0.00266, MAPE:0.6014+-0.01207, MSPE:28.9730+-4.96330, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
