Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.0001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.99, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8984
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2226745
	speed: 0.0202s/iter; left time: 315.4710s
Epoch: 1 cost time: 2.8868231773376465
Epoch: 1, Steps: 157 Train Loss: 0.3032 (Forecasting Loss:0.3029 + XiCon Loss:2.5598 x Lambda(0.0001)), Vali MSE Loss: 0.2370 Test MSE Loss: 0.3368
Validation loss decreased (inf --> 0.236991).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1319484
	speed: 0.0493s/iter; left time: 760.6649s
Epoch: 2 cost time: 8.177390336990356
Epoch: 2, Steps: 157 Train Loss: 0.1434 (Forecasting Loss:0.1432 + XiCon Loss:2.5655 x Lambda(0.0001)), Vali MSE Loss: 0.1477 Test MSE Loss: 0.1993
Validation loss decreased (0.236991 --> 0.147727).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1099537
	speed: 0.0186s/iter; left time: 284.4398s
Epoch: 3 cost time: 2.7005393505096436
Epoch: 3, Steps: 157 Train Loss: 0.1132 (Forecasting Loss:0.1129 + XiCon Loss:2.5626 x Lambda(0.0001)), Vali MSE Loss: 0.1319 Test MSE Loss: 0.1861
Validation loss decreased (0.147727 --> 0.131881).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1231672
	speed: 0.0156s/iter; left time: 236.6969s
Epoch: 4 cost time: 2.3114466667175293
Epoch: 4, Steps: 157 Train Loss: 0.1055 (Forecasting Loss:0.1052 + XiCon Loss:2.5585 x Lambda(0.0001)), Vali MSE Loss: 0.1254 Test MSE Loss: 0.1783
Validation loss decreased (0.131881 --> 0.125421).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1006309
	speed: 0.0136s/iter; left time: 203.8287s
Epoch: 5 cost time: 1.9850962162017822
Epoch: 5, Steps: 157 Train Loss: 0.1018 (Forecasting Loss:0.1016 + XiCon Loss:2.5611 x Lambda(0.0001)), Vali MSE Loss: 0.1226 Test MSE Loss: 0.1735
Validation loss decreased (0.125421 --> 0.122553).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0846326
	speed: 0.0167s/iter; left time: 246.9693s
Epoch: 6 cost time: 2.4878170490264893
Epoch: 6, Steps: 157 Train Loss: 0.0999 (Forecasting Loss:0.0997 + XiCon Loss:2.5659 x Lambda(0.0001)), Vali MSE Loss: 0.1221 Test MSE Loss: 0.1735
Validation loss decreased (0.122553 --> 0.122104).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0933124
	speed: 0.0172s/iter; left time: 252.2462s
Epoch: 7 cost time: 2.482804298400879
Epoch: 7, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0986 + XiCon Loss:2.5733 x Lambda(0.0001)), Vali MSE Loss: 0.1219 Test MSE Loss: 0.1725
Validation loss decreased (0.122104 --> 0.121881).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.0940795
	speed: 0.0164s/iter; left time: 238.2122s
Epoch: 8 cost time: 2.3855950832366943
Epoch: 8, Steps: 157 Train Loss: 0.0983 (Forecasting Loss:0.0980 + XiCon Loss:2.5686 x Lambda(0.0001)), Vali MSE Loss: 0.1221 Test MSE Loss: 0.1727
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0974825
	speed: 0.0171s/iter; left time: 245.3108s
Epoch: 9 cost time: 2.489161491394043
Epoch: 9, Steps: 157 Train Loss: 0.0981 (Forecasting Loss:0.0978 + XiCon Loss:2.5779 x Lambda(0.0001)), Vali MSE Loss: 0.1212 Test MSE Loss: 0.1717
Validation loss decreased (0.121881 --> 0.121241).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0977544
	speed: 0.0164s/iter; left time: 232.2489s
Epoch: 10 cost time: 2.4760262966156006
Epoch: 10, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0976 + XiCon Loss:2.5735 x Lambda(0.0001)), Vali MSE Loss: 0.1218 Test MSE Loss: 0.1716
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0981517
	speed: 0.0158s/iter; left time: 221.6543s
Epoch: 11 cost time: 2.368800163269043
Epoch: 11, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0976 + XiCon Loss:2.5771 x Lambda(0.0001)), Vali MSE Loss: 0.1216 Test MSE Loss: 0.1716
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1022289
	speed: 0.0165s/iter; left time: 228.7800s
Epoch: 12 cost time: 2.537313461303711
Epoch: 12, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5721 x Lambda(0.0001)), Vali MSE Loss: 0.1214 Test MSE Loss: 0.1714
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0984223
	speed: 0.0167s/iter; left time: 229.0863s
Epoch: 13 cost time: 2.4855711460113525
Epoch: 13, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0975 + XiCon Loss:2.5767 x Lambda(0.0001)), Vali MSE Loss: 0.1215 Test MSE Loss: 0.1714
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1177737
	speed: 0.0158s/iter; left time: 214.2973s
Epoch: 14 cost time: 2.3689446449279785
Epoch: 14, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0976 + XiCon Loss:2.5720 x Lambda(0.0001)), Vali MSE Loss: 0.1216 Test MSE Loss: 0.1715
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1056574
	speed: 0.0167s/iter; left time: 223.2764s
Epoch: 15 cost time: 2.4706945419311523
Epoch: 15, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0975 + XiCon Loss:2.5779 x Lambda(0.0001)), Vali MSE Loss: 0.1216 Test MSE Loss: 0.1714
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1010065
	speed: 0.0162s/iter; left time: 214.3646s
Epoch: 16 cost time: 2.393950939178467
Epoch: 16, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5764 x Lambda(0.0001)), Vali MSE Loss: 0.1216 Test MSE Loss: 0.1715
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0945405
	speed: 0.0161s/iter; left time: 210.7673s
Epoch: 17 cost time: 2.4240622520446777
Epoch: 17, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0975 + XiCon Loss:2.5774 x Lambda(0.0001)), Vali MSE Loss: 0.1216 Test MSE Loss: 0.1715
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1089144
	speed: 0.0162s/iter; left time: 209.3197s
Epoch: 18 cost time: 2.4619715213775635
Epoch: 18, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5791 x Lambda(0.0001)), Vali MSE Loss: 0.1216 Test MSE Loss: 0.1715
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0879535
	speed: 0.0166s/iter; left time: 212.5483s
Epoch: 19 cost time: 2.512535810470581
Epoch: 19, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0975 + XiCon Loss:2.5829 x Lambda(0.0001)), Vali MSE Loss: 0.1214 Test MSE Loss: 0.1715
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.133456751704216, mae:0.20984697341918945, mape:0.49111291766166687, mspe:13.115521430969238 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.6812
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2256715
	speed: 0.0171s/iter; left time: 266.2596s
Epoch: 1 cost time: 2.5539989471435547
Epoch: 1, Steps: 157 Train Loss: 0.2949 (Forecasting Loss:0.2946 + XiCon Loss:2.5498 x Lambda(0.0001)), Vali MSE Loss: 0.2281 Test MSE Loss: 0.3268
Validation loss decreased (inf --> 0.228136).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1387418
	speed: 0.0185s/iter; left time: 286.0408s
Epoch: 2 cost time: 2.7990071773529053
Epoch: 2, Steps: 157 Train Loss: 0.1418 (Forecasting Loss:0.1416 + XiCon Loss:2.5908 x Lambda(0.0001)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2000
Validation loss decreased (0.228136 --> 0.139707).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1194789
	speed: 0.0168s/iter; left time: 256.6785s
Epoch: 3 cost time: 2.4974896907806396
Epoch: 3, Steps: 157 Train Loss: 0.1114 (Forecasting Loss:0.1111 + XiCon Loss:2.5854 x Lambda(0.0001)), Vali MSE Loss: 0.1234 Test MSE Loss: 0.1780
Validation loss decreased (0.139707 --> 0.123352).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.0881955
	speed: 0.0161s/iter; left time: 244.3214s
Epoch: 4 cost time: 2.401177406311035
Epoch: 4, Steps: 157 Train Loss: 0.1042 (Forecasting Loss:0.1039 + XiCon Loss:2.5789 x Lambda(0.0001)), Vali MSE Loss: 0.1185 Test MSE Loss: 0.1715
Validation loss decreased (0.123352 --> 0.118516).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0865276
	speed: 0.0172s/iter; left time: 256.8282s
Epoch: 5 cost time: 2.599196434020996
Epoch: 5, Steps: 157 Train Loss: 0.1007 (Forecasting Loss:0.1004 + XiCon Loss:2.5917 x Lambda(0.0001)), Vali MSE Loss: 0.1154 Test MSE Loss: 0.1676
Validation loss decreased (0.118516 --> 0.115425).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0942013
	speed: 0.0174s/iter; left time: 257.7448s
Epoch: 6 cost time: 2.586815595626831
Epoch: 6, Steps: 157 Train Loss: 0.0990 (Forecasting Loss:0.0987 + XiCon Loss:2.5876 x Lambda(0.0001)), Vali MSE Loss: 0.1145 Test MSE Loss: 0.1653
Validation loss decreased (0.115425 --> 0.114469).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1100540
	speed: 0.0165s/iter; left time: 241.4581s
Epoch: 7 cost time: 2.4240763187408447
Epoch: 7, Steps: 157 Train Loss: 0.0980 (Forecasting Loss:0.0978 + XiCon Loss:2.5906 x Lambda(0.0001)), Vali MSE Loss: 0.1139 Test MSE Loss: 0.1645
Validation loss decreased (0.114469 --> 0.113914).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1017010
	speed: 0.0172s/iter; left time: 249.2607s
Epoch: 8 cost time: 2.5275509357452393
Epoch: 8, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0973 + XiCon Loss:2.5795 x Lambda(0.0001)), Vali MSE Loss: 0.1135 Test MSE Loss: 0.1641
Validation loss decreased (0.113914 --> 0.113537).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1007871
	speed: 0.0169s/iter; left time: 242.8691s
Epoch: 9 cost time: 2.5512170791625977
Epoch: 9, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0970 + XiCon Loss:2.5811 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1640
Validation loss decreased (0.113537 --> 0.113205).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0917278
	speed: 0.0166s/iter; left time: 235.1960s
Epoch: 10 cost time: 2.436675548553467
Epoch: 10, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0969 + XiCon Loss:2.5926 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1640
Validation loss decreased (0.113205 --> 0.113164).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0994778
	speed: 0.0177s/iter; left time: 247.7911s
Epoch: 11 cost time: 2.607994318008423
Epoch: 11, Steps: 157 Train Loss: 0.0971 (Forecasting Loss:0.0969 + XiCon Loss:2.5843 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1639
Validation loss decreased (0.113164 --> 0.113153).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1064555
	speed: 0.0163s/iter; left time: 226.1533s
Epoch: 12 cost time: 2.433016777038574
Epoch: 12, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5930 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
Validation loss decreased (0.113153 --> 0.113059).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0969740
	speed: 0.0179s/iter; left time: 245.3280s
Epoch: 13 cost time: 2.670583486557007
Epoch: 13, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0968 + XiCon Loss:2.5887 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0923340
	speed: 0.0165s/iter; left time: 223.3182s
Epoch: 14 cost time: 2.4651317596435547
Epoch: 14, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5938 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
Validation loss decreased (0.113059 --> 0.112953).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.0930276
	speed: 0.0169s/iter; left time: 227.1445s
Epoch: 15 cost time: 2.512633800506592
Epoch: 15, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5861 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1032704
	speed: 0.0166s/iter; left time: 220.4647s
Epoch: 16 cost time: 2.458249092102051
Epoch: 16, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5871 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
Validation loss decreased (0.112953 --> 0.112903).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0952354
	speed: 0.0167s/iter; left time: 218.4717s
Epoch: 17 cost time: 2.5142159461975098
Epoch: 17, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5833 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
Validation loss decreased (0.112903 --> 0.112879).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1035265
	speed: 0.0164s/iter; left time: 212.3958s
Epoch: 18 cost time: 2.4291160106658936
Epoch: 18, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0965 + XiCon Loss:2.5944 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1083130
	speed: 0.0169s/iter; left time: 215.8933s
Epoch: 19 cost time: 2.4829697608947754
Epoch: 19, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5853 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.0803924
	speed: 0.0158s/iter; left time: 199.4600s
Epoch: 20 cost time: 2.36848521232605
Epoch: 20, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5937 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1128980
	speed: 0.0171s/iter; left time: 213.0943s
Epoch: 21 cost time: 2.5727005004882812
Epoch: 21, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5910 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.0946351
	speed: 0.0172s/iter; left time: 211.1502s
Epoch: 22 cost time: 2.502816677093506
Epoch: 22, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5882 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1052385
	speed: 0.0164s/iter; left time: 199.3865s
Epoch: 23 cost time: 2.4697766304016113
Epoch: 23, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5865 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1018412
	speed: 0.0174s/iter; left time: 208.9460s
Epoch: 24 cost time: 2.81551194190979
Epoch: 24, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5965 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.0900109
	speed: 0.0560s/iter; left time: 663.0770s
Epoch: 25 cost time: 6.996827602386475
Epoch: 25, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5873 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
Validation loss decreased (0.112879 --> 0.112870).  Saving model ...
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.0988106
	speed: 0.0178s/iter; left time: 208.1297s
Epoch: 26 cost time: 2.575950860977173
Epoch: 26, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5906 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1030714
	speed: 0.0162s/iter; left time: 186.8969s
Epoch: 27 cost time: 2.340454578399658
Epoch: 27, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5937 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1638
Validation loss decreased (0.112870 --> 0.112845).  Saving model ...
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.0890398
	speed: 0.0162s/iter; left time: 183.7592s
Epoch: 28 cost time: 2.4252326488494873
Epoch: 28, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5913 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1050138
	speed: 0.0164s/iter; left time: 184.2919s
Epoch: 29 cost time: 2.4540319442749023
Epoch: 29, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5892 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.0986885
	speed: 0.0161s/iter; left time: 177.7642s
Epoch: 30 cost time: 2.3831958770751953
Epoch: 30, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5894 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.0936785
	speed: 0.0166s/iter; left time: 181.1769s
Epoch: 31 cost time: 2.5621044635772705
Epoch: 31, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5953 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.0909890
	speed: 0.0161s/iter; left time: 173.0387s
Epoch: 32 cost time: 2.396057605743408
Epoch: 32, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5890 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.0991101
	speed: 0.0156s/iter; left time: 164.5600s
Epoch: 33 cost time: 2.325439453125
Epoch: 33, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5878 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.0830280
	speed: 0.0164s/iter; left time: 171.1873s
Epoch: 34 cost time: 2.4323463439941406
Epoch: 34, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5917 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.820766091346741e-13
	iters: 100, epoch: 35 | loss: 0.1081277
	speed: 0.0163s/iter; left time: 167.6433s
Epoch: 35 cost time: 2.4449691772460938
Epoch: 35, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5880 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.9103830456733704e-13
	iters: 100, epoch: 36 | loss: 0.1050781
	speed: 0.0170s/iter; left time: 171.4188s
Epoch: 36 cost time: 2.504220724105835
Epoch: 36, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5932 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4551915228366852e-13
	iters: 100, epoch: 37 | loss: 0.1058404
	speed: 0.0191s/iter; left time: 189.7854s
Epoch: 37 cost time: 2.859314441680908
Epoch: 37, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5940 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.12826935946941376, mae:0.19940407574176788, mape:0.4445972144603729, mspe:8.041401863098145 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0414
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2274467
	speed: 0.0166s/iter; left time: 259.6625s
Epoch: 1 cost time: 2.51983904838562
Epoch: 1, Steps: 157 Train Loss: 0.3187 (Forecasting Loss:0.3184 + XiCon Loss:2.5761 x Lambda(0.0001)), Vali MSE Loss: 0.2324 Test MSE Loss: 0.3325
Validation loss decreased (inf --> 0.232377).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1349626
	speed: 0.0171s/iter; left time: 264.5837s
Epoch: 2 cost time: 2.5611705780029297
Epoch: 2, Steps: 157 Train Loss: 0.1450 (Forecasting Loss:0.1447 + XiCon Loss:2.6586 x Lambda(0.0001)), Vali MSE Loss: 0.1402 Test MSE Loss: 0.1991
Validation loss decreased (0.232377 --> 0.140208).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1095366
	speed: 0.0180s/iter; left time: 275.3487s
Epoch: 3 cost time: 2.6070454120635986
Epoch: 3, Steps: 157 Train Loss: 0.1132 (Forecasting Loss:0.1129 + XiCon Loss:2.6295 x Lambda(0.0001)), Vali MSE Loss: 0.1272 Test MSE Loss: 0.1796
Validation loss decreased (0.140208 --> 0.127189).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1043743
	speed: 0.0172s/iter; left time: 260.6662s
Epoch: 4 cost time: 2.5876402854919434
Epoch: 4, Steps: 157 Train Loss: 0.1061 (Forecasting Loss:0.1059 + XiCon Loss:2.6258 x Lambda(0.0001)), Vali MSE Loss: 0.1240 Test MSE Loss: 0.1743
Validation loss decreased (0.127189 --> 0.124011).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0945032
	speed: 0.0168s/iter; left time: 252.1594s
Epoch: 5 cost time: 2.5387301445007324
Epoch: 5, Steps: 157 Train Loss: 0.1025 (Forecasting Loss:0.1023 + XiCon Loss:2.6061 x Lambda(0.0001)), Vali MSE Loss: 0.1209 Test MSE Loss: 0.1709
Validation loss decreased (0.124011 --> 0.120923).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0995062
	speed: 0.0165s/iter; left time: 243.9827s
Epoch: 6 cost time: 2.423448085784912
Epoch: 6, Steps: 157 Train Loss: 0.1008 (Forecasting Loss:0.1005 + XiCon Loss:2.6029 x Lambda(0.0001)), Vali MSE Loss: 0.1197 Test MSE Loss: 0.1691
Validation loss decreased (0.120923 --> 0.119749).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0988615
	speed: 0.0162s/iter; left time: 236.7474s
Epoch: 7 cost time: 2.4500510692596436
Epoch: 7, Steps: 157 Train Loss: 0.0998 (Forecasting Loss:0.0996 + XiCon Loss:2.5874 x Lambda(0.0001)), Vali MSE Loss: 0.1178 Test MSE Loss: 0.1681
Validation loss decreased (0.119749 --> 0.117785).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.0867827
	speed: 0.0171s/iter; left time: 248.5559s
Epoch: 8 cost time: 2.573875665664673
Epoch: 8, Steps: 157 Train Loss: 0.0993 (Forecasting Loss:0.0990 + XiCon Loss:2.5887 x Lambda(0.0001)), Vali MSE Loss: 0.1186 Test MSE Loss: 0.1678
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0903729
	speed: 0.0168s/iter; left time: 240.4041s
Epoch: 9 cost time: 2.483088731765747
Epoch: 9, Steps: 157 Train Loss: 0.0990 (Forecasting Loss:0.0987 + XiCon Loss:2.5930 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1672
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0987599
	speed: 0.0166s/iter; left time: 235.2274s
Epoch: 10 cost time: 2.4297797679901123
Epoch: 10, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5953 x Lambda(0.0001)), Vali MSE Loss: 0.1177 Test MSE Loss: 0.1668
Validation loss decreased (0.117785 --> 0.117719).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1018155
	speed: 0.0165s/iter; left time: 230.9541s
Epoch: 11 cost time: 2.4665191173553467
Epoch: 11, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0986 + XiCon Loss:2.5924 x Lambda(0.0001)), Vali MSE Loss: 0.1177 Test MSE Loss: 0.1668
Validation loss decreased (0.117719 --> 0.117686).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1069523
	speed: 0.0180s/iter; left time: 249.4676s
Epoch: 12 cost time: 2.6317827701568604
Epoch: 12, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5897 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1670
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0882264
	speed: 0.0171s/iter; left time: 233.8860s
Epoch: 13 cost time: 2.544036865234375
Epoch: 13, Steps: 157 Train Loss: 0.0986 (Forecasting Loss:0.0984 + XiCon Loss:2.5848 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1669
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1010853
	speed: 0.0164s/iter; left time: 221.7862s
Epoch: 14 cost time: 2.4968295097351074
Epoch: 14, Steps: 157 Train Loss: 0.0986 (Forecasting Loss:0.0984 + XiCon Loss:2.5934 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1669
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.0943603
	speed: 0.0172s/iter; left time: 230.5883s
Epoch: 15 cost time: 2.548046112060547
Epoch: 15, Steps: 157 Train Loss: 0.0986 (Forecasting Loss:0.0984 + XiCon Loss:2.6001 x Lambda(0.0001)), Vali MSE Loss: 0.1181 Test MSE Loss: 0.1669
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0923340
	speed: 0.0169s/iter; left time: 224.3214s
Epoch: 16 cost time: 2.4567744731903076
Epoch: 16, Steps: 157 Train Loss: 0.0986 (Forecasting Loss:0.0983 + XiCon Loss:2.5896 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1669
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0959389
	speed: 0.0159s/iter; left time: 207.5492s
Epoch: 17 cost time: 2.410196304321289
Epoch: 17, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0985 + XiCon Loss:2.5894 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1669
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.0867134
	speed: 0.0168s/iter; left time: 216.9067s
Epoch: 18 cost time: 2.543551206588745
Epoch: 18, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0984 + XiCon Loss:2.5968 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1669
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0945947
	speed: 0.0162s/iter; left time: 206.4886s
Epoch: 19 cost time: 2.4535703659057617
Epoch: 19, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0984 + XiCon Loss:2.5939 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1669
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.0968864
	speed: 0.0164s/iter; left time: 207.3390s
Epoch: 20 cost time: 2.4471025466918945
Epoch: 20, Steps: 157 Train Loss: 0.0986 (Forecasting Loss:0.0984 + XiCon Loss:2.5971 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1669
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1117039
	speed: 0.0181s/iter; left time: 226.1181s
Epoch: 21 cost time: 2.754734754562378
Epoch: 21, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0984 + XiCon Loss:2.5940 x Lambda(0.0001)), Vali MSE Loss: 0.1179 Test MSE Loss: 0.1669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.13068728148937225, mae:0.20281381905078888, mape:0.4753563404083252, mspe:11.600713729858398 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7848
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2187540
	speed: 0.0170s/iter; left time: 265.0926s
Epoch: 1 cost time: 2.503267765045166
Epoch: 1, Steps: 157 Train Loss: 0.3057 (Forecasting Loss:0.3055 + XiCon Loss:2.5523 x Lambda(0.0001)), Vali MSE Loss: 0.2334 Test MSE Loss: 0.3343
Validation loss decreased (inf --> 0.233443).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1220507
	speed: 0.0167s/iter; left time: 257.9184s
Epoch: 2 cost time: 2.4823849201202393
Epoch: 2, Steps: 157 Train Loss: 0.1418 (Forecasting Loss:0.1415 + XiCon Loss:2.6058 x Lambda(0.0001)), Vali MSE Loss: 0.1403 Test MSE Loss: 0.2021
Validation loss decreased (0.233443 --> 0.140279).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1155609
	speed: 0.0170s/iter; left time: 259.7224s
Epoch: 3 cost time: 2.517070770263672
Epoch: 3, Steps: 157 Train Loss: 0.1119 (Forecasting Loss:0.1116 + XiCon Loss:2.6062 x Lambda(0.0001)), Vali MSE Loss: 0.1267 Test MSE Loss: 0.1840
Validation loss decreased (0.140279 --> 0.126664).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1147458
	speed: 0.0163s/iter; left time: 247.2959s
Epoch: 4 cost time: 2.4444987773895264
Epoch: 4, Steps: 157 Train Loss: 0.1047 (Forecasting Loss:0.1045 + XiCon Loss:2.6015 x Lambda(0.0001)), Vali MSE Loss: 0.1205 Test MSE Loss: 0.1752
Validation loss decreased (0.126664 --> 0.120451).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0880871
	speed: 0.0178s/iter; left time: 267.1051s
Epoch: 5 cost time: 2.685739278793335
Epoch: 5, Steps: 157 Train Loss: 0.1011 (Forecasting Loss:0.1009 + XiCon Loss:2.5989 x Lambda(0.0001)), Vali MSE Loss: 0.1153 Test MSE Loss: 0.1697
Validation loss decreased (0.120451 --> 0.115307).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0915371
	speed: 0.0164s/iter; left time: 243.5077s
Epoch: 6 cost time: 2.503316640853882
Epoch: 6, Steps: 157 Train Loss: 0.0993 (Forecasting Loss:0.0991 + XiCon Loss:2.5943 x Lambda(0.0001)), Vali MSE Loss: 0.1142 Test MSE Loss: 0.1689
Validation loss decreased (0.115307 --> 0.114157).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0874604
	speed: 0.0166s/iter; left time: 242.9310s
Epoch: 7 cost time: 2.395692825317383
Epoch: 7, Steps: 157 Train Loss: 0.0984 (Forecasting Loss:0.0982 + XiCon Loss:2.6019 x Lambda(0.0001)), Vali MSE Loss: 0.1137 Test MSE Loss: 0.1680
Validation loss decreased (0.114157 --> 0.113718).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.0990676
	speed: 0.0160s/iter; left time: 231.6676s
Epoch: 8 cost time: 2.3457067012786865
Epoch: 8, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0977 + XiCon Loss:2.6035 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1667
Validation loss decreased (0.113718 --> 0.113109).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1183197
	speed: 0.0164s/iter; left time: 235.8359s
Epoch: 9 cost time: 2.4228439331054688
Epoch: 9, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.6059 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1666
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0979520
	speed: 0.0174s/iter; left time: 247.4154s
Epoch: 10 cost time: 2.5411226749420166
Epoch: 10, Steps: 157 Train Loss: 0.0974 (Forecasting Loss:0.0971 + XiCon Loss:2.5976 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1663
Validation loss decreased (0.113109 --> 0.112911).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1090645
	speed: 0.0162s/iter; left time: 227.4684s
Epoch: 11 cost time: 2.3971145153045654
Epoch: 11, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.6079 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1662
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.0978551
	speed: 0.0166s/iter; left time: 229.7437s
Epoch: 12 cost time: 2.46447491645813
Epoch: 12, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5953 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1662
Validation loss decreased (0.112911 --> 0.112742).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0865011
	speed: 0.0178s/iter; left time: 244.0910s
Epoch: 13 cost time: 2.599785089492798
Epoch: 13, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.6096 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1662
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0951901
	speed: 0.0161s/iter; left time: 218.1704s
Epoch: 14 cost time: 2.515193223953247
Epoch: 14, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.6040 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1661
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.0998821
	speed: 0.0168s/iter; left time: 225.1279s
Epoch: 15 cost time: 2.552729606628418
Epoch: 15, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0970 + XiCon Loss:2.5986 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1662
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0921527
	speed: 0.0171s/iter; left time: 226.0597s
Epoch: 16 cost time: 2.5391862392425537
Epoch: 16, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5951 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1662
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1109768
	speed: 0.0167s/iter; left time: 219.0632s
Epoch: 17 cost time: 2.458622455596924
Epoch: 17, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5909 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1662
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1087932
	speed: 0.0164s/iter; left time: 211.7666s
Epoch: 18 cost time: 2.390864133834839
Epoch: 18, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0969 + XiCon Loss:2.5917 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1661
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0858925
	speed: 0.0166s/iter; left time: 211.6234s
Epoch: 19 cost time: 2.4837543964385986
Epoch: 19, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.6008 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1661
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1015766
	speed: 0.0162s/iter; left time: 204.3968s
Epoch: 20 cost time: 2.4054222106933594
Epoch: 20, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0970 + XiCon Loss:2.6010 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1661
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.0967980
	speed: 0.0159s/iter; left time: 198.0324s
Epoch: 21 cost time: 2.3902339935302734
Epoch: 21, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0970 + XiCon Loss:2.5989 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1661
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.0938345
	speed: 0.0170s/iter; left time: 208.9255s
Epoch: 22 cost time: 2.499544858932495
Epoch: 22, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5913 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.13093893229961395, mae:0.20152322947978973, mape:0.4506145119667053, mspe:7.581085205078125 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.6976
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2199631
	speed: 0.0183s/iter; left time: 285.4389s
Epoch: 1 cost time: 2.622936964035034
Epoch: 1, Steps: 157 Train Loss: 0.3219 (Forecasting Loss:0.3217 + XiCon Loss:2.5420 x Lambda(0.0001)), Vali MSE Loss: 0.2389 Test MSE Loss: 0.3414
Validation loss decreased (inf --> 0.238940).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1358666
	speed: 0.0154s/iter; left time: 237.8012s
Epoch: 2 cost time: 2.3295836448669434
Epoch: 2, Steps: 157 Train Loss: 0.1447 (Forecasting Loss:0.1445 + XiCon Loss:2.5644 x Lambda(0.0001)), Vali MSE Loss: 0.1421 Test MSE Loss: 0.1982
Validation loss decreased (0.238940 --> 0.142132).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.0963631
	speed: 0.0161s/iter; left time: 245.5266s
Epoch: 3 cost time: 2.3525443077087402
Epoch: 3, Steps: 157 Train Loss: 0.1124 (Forecasting Loss:0.1122 + XiCon Loss:2.5757 x Lambda(0.0001)), Vali MSE Loss: 0.1257 Test MSE Loss: 0.1792
Validation loss decreased (0.142132 --> 0.125680).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.0958605
	speed: 0.0174s/iter; left time: 263.0654s
Epoch: 4 cost time: 2.5826969146728516
Epoch: 4, Steps: 157 Train Loss: 0.1045 (Forecasting Loss:0.1043 + XiCon Loss:2.5704 x Lambda(0.0001)), Vali MSE Loss: 0.1192 Test MSE Loss: 0.1726
Validation loss decreased (0.125680 --> 0.119226).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1146497
	speed: 0.0160s/iter; left time: 239.6064s
Epoch: 5 cost time: 2.3806967735290527
Epoch: 5, Steps: 157 Train Loss: 0.1014 (Forecasting Loss:0.1011 + XiCon Loss:2.5567 x Lambda(0.0001)), Vali MSE Loss: 0.1166 Test MSE Loss: 0.1700
Validation loss decreased (0.119226 --> 0.116599).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1060746
	speed: 0.0172s/iter; left time: 254.7029s
Epoch: 6 cost time: 2.522773504257202
Epoch: 6, Steps: 157 Train Loss: 0.0997 (Forecasting Loss:0.0994 + XiCon Loss:2.5472 x Lambda(0.0001)), Vali MSE Loss: 0.1140 Test MSE Loss: 0.1658
Validation loss decreased (0.116599 --> 0.114023).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0962574
	speed: 0.0178s/iter; left time: 261.1001s
Epoch: 7 cost time: 2.6253533363342285
Epoch: 7, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5419 x Lambda(0.0001)), Vali MSE Loss: 0.1133 Test MSE Loss: 0.1654
Validation loss decreased (0.114023 --> 0.113334).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1117124
	speed: 0.0168s/iter; left time: 243.7960s
Epoch: 8 cost time: 2.4909050464630127
Epoch: 8, Steps: 157 Train Loss: 0.0982 (Forecasting Loss:0.0979 + XiCon Loss:2.5387 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1641
Validation loss decreased (0.113334 --> 0.112674).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0924667
	speed: 0.0163s/iter; left time: 234.2716s
Epoch: 9 cost time: 2.4954400062561035
Epoch: 9, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0977 + XiCon Loss:2.5426 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1639
Validation loss decreased (0.112674 --> 0.112268).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0829539
	speed: 0.0160s/iter; left time: 227.2987s
Epoch: 10 cost time: 2.421168327331543
Epoch: 10, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0976 + XiCon Loss:2.5316 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1638
Validation loss decreased (0.112268 --> 0.112265).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0874915
	speed: 0.0172s/iter; left time: 241.7620s
Epoch: 11 cost time: 2.562511682510376
Epoch: 11, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5398 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1637
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1066110
	speed: 0.0158s/iter; left time: 218.7507s
Epoch: 12 cost time: 2.3865668773651123
Epoch: 12, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5429 x Lambda(0.0001)), Vali MSE Loss: 0.1121 Test MSE Loss: 0.1636
Validation loss decreased (0.112265 --> 0.112089).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1067588
	speed: 0.0169s/iter; left time: 231.9955s
Epoch: 13 cost time: 2.5433413982391357
Epoch: 13, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5376 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0961282
	speed: 0.0183s/iter; left time: 248.5824s
Epoch: 14 cost time: 2.6405203342437744
Epoch: 14, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5391 x Lambda(0.0001)), Vali MSE Loss: 0.1120 Test MSE Loss: 0.1636
Validation loss decreased (0.112089 --> 0.112019).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1069336
	speed: 0.0164s/iter; left time: 219.8999s
Epoch: 15 cost time: 2.4428932666778564
Epoch: 15, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5385 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0851855
	speed: 0.0163s/iter; left time: 216.5665s
Epoch: 16 cost time: 2.4871644973754883
Epoch: 16, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5352 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0840638
	speed: 0.0183s/iter; left time: 239.8668s
Epoch: 17 cost time: 2.6454811096191406
Epoch: 17, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5366 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1034114
	speed: 0.0168s/iter; left time: 217.1930s
Epoch: 18 cost time: 2.470111608505249
Epoch: 18, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5301 x Lambda(0.0001)), Vali MSE Loss: 0.1120 Test MSE Loss: 0.1636
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0857363
	speed: 0.0161s/iter; left time: 205.6769s
Epoch: 19 cost time: 2.4653749465942383
Epoch: 19, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5388 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1008072
	speed: 0.0169s/iter; left time: 213.6055s
Epoch: 20 cost time: 2.561983108520508
Epoch: 20, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5397 x Lambda(0.0001)), Vali MSE Loss: 0.1121 Test MSE Loss: 0.1636
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1009857
	speed: 0.0145s/iter; left time: 181.0318s
Epoch: 21 cost time: 2.1684653759002686
Epoch: 21, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5414 x Lambda(0.0001)), Vali MSE Loss: 0.1120 Test MSE Loss: 0.1636
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1012931
	speed: 0.0181s/iter; left time: 222.9263s
Epoch: 22 cost time: 4.808530807495117
Epoch: 22, Steps: 157 Train Loss: 0.0974 (Forecasting Loss:0.0972 + XiCon Loss:2.5458 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.0857758
	speed: 0.0371s/iter; left time: 450.5924s
Epoch: 23 cost time: 4.5805699825286865
Epoch: 23, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5343 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.0891812
	speed: 0.0160s/iter; left time: 192.2102s
Epoch: 24 cost time: 2.3451552391052246
Epoch: 24, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5398 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.12838256359100342, mae:0.19882172346115112, mape:0.4407084584236145, mspe:7.6861042976379395 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1303+-0.00266, MAE:0.2025+-0.00549, MAPE:0.4605+-0.02706, MSPE:9.6050+-3.19773, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.99, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9667
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2359570
	speed: 0.0265s/iter; left time: 386.7888s
Epoch: 1 cost time: 3.4900617599487305
Epoch: 1, Steps: 147 Train Loss: 0.3304 (Forecasting Loss:0.3278 + XiCon Loss:2.5901 x Lambda(0.001)), Vali MSE Loss: 0.2527 Test MSE Loss: 0.3559
Validation loss decreased (inf --> 0.252669).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1440576
	speed: 0.0174s/iter; left time: 251.6333s
Epoch: 2 cost time: 2.4408342838287354
Epoch: 2, Steps: 147 Train Loss: 0.1591 (Forecasting Loss:0.1565 + XiCon Loss:2.5260 x Lambda(0.001)), Vali MSE Loss: 0.1524 Test MSE Loss: 0.2152
Validation loss decreased (0.252669 --> 0.152380).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1379071
	speed: 0.0167s/iter; left time: 238.8605s
Epoch: 3 cost time: 2.3497109413146973
Epoch: 3, Steps: 147 Train Loss: 0.1277 (Forecasting Loss:0.1253 + XiCon Loss:2.4918 x Lambda(0.001)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2018
Validation loss decreased (0.152380 --> 0.140939).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1153234
	speed: 0.0172s/iter; left time: 243.4163s
Epoch: 4 cost time: 2.4228808879852295
Epoch: 4, Steps: 147 Train Loss: 0.1203 (Forecasting Loss:0.1178 + XiCon Loss:2.5013 x Lambda(0.001)), Vali MSE Loss: 0.1360 Test MSE Loss: 0.1926
Validation loss decreased (0.140939 --> 0.135972).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1217861
	speed: 0.0172s/iter; left time: 240.3753s
Epoch: 5 cost time: 2.4671151638031006
Epoch: 5, Steps: 147 Train Loss: 0.1168 (Forecasting Loss:0.1143 + XiCon Loss:2.4957 x Lambda(0.001)), Vali MSE Loss: 0.1342 Test MSE Loss: 0.1895
Validation loss decreased (0.135972 --> 0.134150).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1168824
	speed: 0.0186s/iter; left time: 258.4843s
Epoch: 6 cost time: 2.5744152069091797
Epoch: 6, Steps: 147 Train Loss: 0.1148 (Forecasting Loss:0.1123 + XiCon Loss:2.4831 x Lambda(0.001)), Vali MSE Loss: 0.1316 Test MSE Loss: 0.1844
Validation loss decreased (0.134150 --> 0.131621).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1177752
	speed: 0.0171s/iter; left time: 235.0220s
Epoch: 7 cost time: 2.4193756580352783
Epoch: 7, Steps: 147 Train Loss: 0.1139 (Forecasting Loss:0.1114 + XiCon Loss:2.4828 x Lambda(0.001)), Vali MSE Loss: 0.1307 Test MSE Loss: 0.1843
Validation loss decreased (0.131621 --> 0.130686).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1131360
	speed: 0.0173s/iter; left time: 234.1850s
Epoch: 8 cost time: 2.3941946029663086
Epoch: 8, Steps: 147 Train Loss: 0.1133 (Forecasting Loss:0.1108 + XiCon Loss:2.4844 x Lambda(0.001)), Vali MSE Loss: 0.1307 Test MSE Loss: 0.1832
Validation loss decreased (0.130686 --> 0.130676).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1205632
	speed: 0.0168s/iter; left time: 225.4063s
Epoch: 9 cost time: 2.375633955001831
Epoch: 9, Steps: 147 Train Loss: 0.1130 (Forecasting Loss:0.1105 + XiCon Loss:2.4915 x Lambda(0.001)), Vali MSE Loss: 0.1306 Test MSE Loss: 0.1843
Validation loss decreased (0.130676 --> 0.130599).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1045525
	speed: 0.0183s/iter; left time: 243.3061s
Epoch: 10 cost time: 2.6481871604919434
Epoch: 10, Steps: 147 Train Loss: 0.1129 (Forecasting Loss:0.1104 + XiCon Loss:2.4935 x Lambda(0.001)), Vali MSE Loss: 0.1307 Test MSE Loss: 0.1835
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1131149
	speed: 0.0169s/iter; left time: 222.4230s
Epoch: 11 cost time: 2.3912856578826904
Epoch: 11, Steps: 147 Train Loss: 0.1129 (Forecasting Loss:0.1104 + XiCon Loss:2.4827 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
Validation loss decreased (0.130599 --> 0.130431).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1207007
	speed: 0.0173s/iter; left time: 224.5111s
Epoch: 12 cost time: 2.4403088092803955
Epoch: 12, Steps: 147 Train Loss: 0.1128 (Forecasting Loss:0.1103 + XiCon Loss:2.4897 x Lambda(0.001)), Vali MSE Loss: 0.1303 Test MSE Loss: 0.1832
Validation loss decreased (0.130431 --> 0.130322).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1098821
	speed: 0.0167s/iter; left time: 214.9060s
Epoch: 13 cost time: 2.3438527584075928
Epoch: 13, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4854 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1143965
	speed: 0.0163s/iter; left time: 206.4524s
Epoch: 14 cost time: 2.3213202953338623
Epoch: 14, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4858 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1093832
	speed: 0.0187s/iter; left time: 234.9837s
Epoch: 15 cost time: 2.671266555786133
Epoch: 15, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4890 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1091596
	speed: 0.0168s/iter; left time: 207.6929s
Epoch: 16 cost time: 2.3992793560028076
Epoch: 16, Steps: 147 Train Loss: 0.1128 (Forecasting Loss:0.1103 + XiCon Loss:2.4810 x Lambda(0.001)), Vali MSE Loss: 0.1305 Test MSE Loss: 0.1833
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1209971
	speed: 0.0173s/iter; left time: 212.3607s
Epoch: 17 cost time: 2.4516313076019287
Epoch: 17, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4817 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1072914
	speed: 0.0174s/iter; left time: 210.4394s
Epoch: 18 cost time: 2.458817720413208
Epoch: 18, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4844 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1117637
	speed: 0.0167s/iter; left time: 199.8773s
Epoch: 19 cost time: 2.361164093017578
Epoch: 19, Steps: 147 Train Loss: 0.1128 (Forecasting Loss:0.1103 + XiCon Loss:2.4832 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1037259
	speed: 0.0188s/iter; left time: 221.4216s
Epoch: 20 cost time: 2.6065969467163086
Epoch: 20, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4873 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1044460
	speed: 0.0173s/iter; left time: 201.8971s
Epoch: 21 cost time: 2.4295694828033447
Epoch: 21, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4766 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1090561
	speed: 0.0163s/iter; left time: 187.1485s
Epoch: 22 cost time: 2.33349347114563
Epoch: 22, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4828 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.1427898406982422, mae:0.22365814447402954, mape:0.5599029064178467, mspe:22.120595932006836 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.6656
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2237115
	speed: 0.0178s/iter; left time: 260.2096s
Epoch: 1 cost time: 2.5601794719696045
Epoch: 1, Steps: 147 Train Loss: 0.3194 (Forecasting Loss:0.3168 + XiCon Loss:2.5607 x Lambda(0.001)), Vali MSE Loss: 0.2435 Test MSE Loss: 0.3467
Validation loss decreased (inf --> 0.243474).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1455076
	speed: 0.0178s/iter; left time: 257.8097s
Epoch: 2 cost time: 2.490760564804077
Epoch: 2, Steps: 147 Train Loss: 0.1586 (Forecasting Loss:0.1560 + XiCon Loss:2.5879 x Lambda(0.001)), Vali MSE Loss: 0.1509 Test MSE Loss: 0.2138
Validation loss decreased (0.243474 --> 0.150894).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1238566
	speed: 0.0184s/iter; left time: 263.8903s
Epoch: 3 cost time: 2.5597622394561768
Epoch: 3, Steps: 147 Train Loss: 0.1264 (Forecasting Loss:0.1239 + XiCon Loss:2.5479 x Lambda(0.001)), Vali MSE Loss: 0.1381 Test MSE Loss: 0.1940
Validation loss decreased (0.150894 --> 0.138095).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1166669
	speed: 0.0190s/iter; left time: 268.9265s
Epoch: 4 cost time: 2.7105886936187744
Epoch: 4, Steps: 147 Train Loss: 0.1195 (Forecasting Loss:0.1170 + XiCon Loss:2.5198 x Lambda(0.001)), Vali MSE Loss: 0.1310 Test MSE Loss: 0.1866
Validation loss decreased (0.138095 --> 0.130982).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1168808
	speed: 0.0178s/iter; left time: 248.8154s
Epoch: 5 cost time: 2.4705986976623535
Epoch: 5, Steps: 147 Train Loss: 0.1158 (Forecasting Loss:0.1133 + XiCon Loss:2.5006 x Lambda(0.001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1851
Validation loss decreased (0.130982 --> 0.125905).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1053544
	speed: 0.0178s/iter; left time: 246.1469s
Epoch: 6 cost time: 2.5258185863494873
Epoch: 6, Steps: 147 Train Loss: 0.1140 (Forecasting Loss:0.1115 + XiCon Loss:2.5074 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1834
Validation loss decreased (0.125905 --> 0.124860).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1181709
	speed: 0.0172s/iter; left time: 235.4232s
Epoch: 7 cost time: 2.4309282302856445
Epoch: 7, Steps: 147 Train Loss: 0.1130 (Forecasting Loss:0.1105 + XiCon Loss:2.5065 x Lambda(0.001)), Vali MSE Loss: 0.1239 Test MSE Loss: 0.1832
Validation loss decreased (0.124860 --> 0.123873).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1146745
	speed: 0.0170s/iter; left time: 230.3010s
Epoch: 8 cost time: 2.408330202102661
Epoch: 8, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5016 x Lambda(0.001)), Vali MSE Loss: 0.1236 Test MSE Loss: 0.1819
Validation loss decreased (0.123873 --> 0.123587).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1160256
	speed: 0.0184s/iter; left time: 246.4744s
Epoch: 9 cost time: 2.6019980907440186
Epoch: 9, Steps: 147 Train Loss: 0.1123 (Forecasting Loss:0.1098 + XiCon Loss:2.4950 x Lambda(0.001)), Vali MSE Loss: 0.1234 Test MSE Loss: 0.1819
Validation loss decreased (0.123587 --> 0.123357).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1186870
	speed: 0.0174s/iter; left time: 230.3936s
Epoch: 10 cost time: 2.5249900817871094
Epoch: 10, Steps: 147 Train Loss: 0.1121 (Forecasting Loss:0.1096 + XiCon Loss:2.5107 x Lambda(0.001)), Vali MSE Loss: 0.1234 Test MSE Loss: 0.1814
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1163080
	speed: 0.0175s/iter; left time: 229.4136s
Epoch: 11 cost time: 2.458116054534912
Epoch: 11, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4962 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
Validation loss decreased (0.123357 --> 0.123187).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1113962
	speed: 0.0170s/iter; left time: 221.2081s
Epoch: 12 cost time: 2.4223761558532715
Epoch: 12, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.5016 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1814
Validation loss decreased (0.123187 --> 0.123177).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1190302
	speed: 0.0169s/iter; left time: 216.9224s
Epoch: 13 cost time: 2.373159408569336
Epoch: 13, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4929 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1116663
	speed: 0.0201s/iter; left time: 255.2220s
Epoch: 14 cost time: 2.7546989917755127
Epoch: 14, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1094 + XiCon Loss:2.5047 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1052673
	speed: 0.0170s/iter; left time: 213.8531s
Epoch: 15 cost time: 2.424206018447876
Epoch: 15, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4945 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
Validation loss decreased (0.123177 --> 0.123152).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1125521
	speed: 0.0170s/iter; left time: 210.7735s
Epoch: 16 cost time: 2.402255058288574
Epoch: 16, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1094 + XiCon Loss:2.5036 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1073585
	speed: 0.0172s/iter; left time: 210.9906s
Epoch: 17 cost time: 2.3912994861602783
Epoch: 17, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.5041 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1212120
	speed: 0.0165s/iter; left time: 199.5902s
Epoch: 18 cost time: 2.442164182662964
Epoch: 18, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.5038 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1159646
	speed: 0.0182s/iter; left time: 217.7242s
Epoch: 19 cost time: 2.516753673553467
Epoch: 19, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1094 + XiCon Loss:2.5094 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1057967
	speed: 0.0167s/iter; left time: 197.4208s
Epoch: 20 cost time: 2.3839406967163086
Epoch: 20, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.5015 x Lambda(0.001)), Vali MSE Loss: 0.1231 Test MSE Loss: 0.1815
Validation loss decreased (0.123152 --> 0.123132).  Saving model ...
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1068234
	speed: 0.0169s/iter; left time: 197.4676s
Epoch: 21 cost time: 2.358215808868408
Epoch: 21, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4980 x Lambda(0.001)), Vali MSE Loss: 0.1231 Test MSE Loss: 0.1815
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1168032
	speed: 0.0168s/iter; left time: 193.7689s
Epoch: 22 cost time: 2.3847506046295166
Epoch: 22, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.5034 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1181535
	speed: 0.0190s/iter; left time: 216.3892s
Epoch: 23 cost time: 2.6996898651123047
Epoch: 23, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4976 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1142489
	speed: 0.0175s/iter; left time: 196.7028s
Epoch: 24 cost time: 2.503779411315918
Epoch: 24, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.5050 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1097928
	speed: 0.0182s/iter; left time: 201.5483s
Epoch: 25 cost time: 2.5417134761810303
Epoch: 25, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.5066 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1145270
	speed: 0.0177s/iter; left time: 192.9625s
Epoch: 26 cost time: 2.465876340866089
Epoch: 26, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4973 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1057024
	speed: 0.0178s/iter; left time: 192.2494s
Epoch: 27 cost time: 2.536696672439575
Epoch: 27, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.5024 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1080884
	speed: 0.0197s/iter; left time: 209.3163s
Epoch: 28 cost time: 2.696638822555542
Epoch: 28, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4966 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1107678
	speed: 0.0174s/iter; left time: 182.9084s
Epoch: 29 cost time: 2.4531736373901367
Epoch: 29, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4983 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1155612
	speed: 0.0177s/iter; left time: 182.7643s
Epoch: 30 cost time: 2.506870746612549
Epoch: 30, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.5048 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14138418436050415, mae:0.22157491743564606, mape:0.5411109924316406, mspe:19.37163543701172 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8604
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2251757
	speed: 0.0167s/iter; left time: 243.8791s
Epoch: 1 cost time: 2.3805086612701416
Epoch: 1, Steps: 147 Train Loss: 0.3177 (Forecasting Loss:0.3151 + XiCon Loss:2.5769 x Lambda(0.001)), Vali MSE Loss: 0.2427 Test MSE Loss: 0.3452
Validation loss decreased (inf --> 0.242665).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1398627
	speed: 0.0164s/iter; left time: 236.6935s
Epoch: 2 cost time: 2.37231707572937
Epoch: 2, Steps: 147 Train Loss: 0.1558 (Forecasting Loss:0.1533 + XiCon Loss:2.5303 x Lambda(0.001)), Vali MSE Loss: 0.1514 Test MSE Loss: 0.2144
Validation loss decreased (0.242665 --> 0.151362).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1253669
	speed: 0.0186s/iter; left time: 266.5150s
Epoch: 3 cost time: 2.5617640018463135
Epoch: 3, Steps: 147 Train Loss: 0.1260 (Forecasting Loss:0.1235 + XiCon Loss:2.4982 x Lambda(0.001)), Vali MSE Loss: 0.1386 Test MSE Loss: 0.1948
Validation loss decreased (0.151362 --> 0.138649).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1099397
	speed: 0.0172s/iter; left time: 243.3194s
Epoch: 4 cost time: 2.4929096698760986
Epoch: 4, Steps: 147 Train Loss: 0.1185 (Forecasting Loss:0.1160 + XiCon Loss:2.4958 x Lambda(0.001)), Vali MSE Loss: 0.1307 Test MSE Loss: 0.1894
Validation loss decreased (0.138649 --> 0.130733).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1246267
	speed: 0.0173s/iter; left time: 242.6371s
Epoch: 5 cost time: 2.4081010818481445
Epoch: 5, Steps: 147 Train Loss: 0.1152 (Forecasting Loss:0.1127 + XiCon Loss:2.4998 x Lambda(0.001)), Vali MSE Loss: 0.1283 Test MSE Loss: 0.1833
Validation loss decreased (0.130733 --> 0.128299).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1121893
	speed: 0.0174s/iter; left time: 241.1585s
Epoch: 6 cost time: 2.4161479473114014
Epoch: 6, Steps: 147 Train Loss: 0.1132 (Forecasting Loss:0.1107 + XiCon Loss:2.4904 x Lambda(0.001)), Vali MSE Loss: 0.1263 Test MSE Loss: 0.1817
Validation loss decreased (0.128299 --> 0.126332).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1206962
	speed: 0.0178s/iter; left time: 244.7768s
Epoch: 7 cost time: 2.493403434753418
Epoch: 7, Steps: 147 Train Loss: 0.1123 (Forecasting Loss:0.1098 + XiCon Loss:2.4865 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1819
Validation loss decreased (0.126332 --> 0.125126).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1068975
	speed: 0.0179s/iter; left time: 243.5993s
Epoch: 8 cost time: 2.513793468475342
Epoch: 8, Steps: 147 Train Loss: 0.1118 (Forecasting Loss:0.1093 + XiCon Loss:2.4819 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1805
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1035737
	speed: 0.0186s/iter; left time: 250.2087s
Epoch: 9 cost time: 2.6972415447235107
Epoch: 9, Steps: 147 Train Loss: 0.1116 (Forecasting Loss:0.1091 + XiCon Loss:2.4911 x Lambda(0.001)), Vali MSE Loss: 0.1248 Test MSE Loss: 0.1804
Validation loss decreased (0.125126 --> 0.124783).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1106099
	speed: 0.0166s/iter; left time: 220.9226s
Epoch: 10 cost time: 2.3398401737213135
Epoch: 10, Steps: 147 Train Loss: 0.1114 (Forecasting Loss:0.1089 + XiCon Loss:2.4968 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1806
Validation loss decreased (0.124783 --> 0.124597).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1135771
	speed: 0.0183s/iter; left time: 240.7316s
Epoch: 11 cost time: 2.564218521118164
Epoch: 11, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4960 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1131374
	speed: 0.0175s/iter; left time: 227.3184s
Epoch: 12 cost time: 2.4801909923553467
Epoch: 12, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4821 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1108742
	speed: 0.0172s/iter; left time: 220.8537s
Epoch: 13 cost time: 2.4872868061065674
Epoch: 13, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4957 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1802
Validation loss decreased (0.124597 --> 0.124518).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1156629
	speed: 0.0205s/iter; left time: 259.5235s
Epoch: 14 cost time: 2.766831636428833
Epoch: 14, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4918 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1802
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1187081
	speed: 0.0175s/iter; left time: 219.3297s
Epoch: 15 cost time: 2.5212883949279785
Epoch: 15, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4877 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1131688
	speed: 0.0172s/iter; left time: 212.7362s
Epoch: 16 cost time: 2.3998827934265137
Epoch: 16, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4971 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1097922
	speed: 0.0172s/iter; left time: 211.2829s
Epoch: 17 cost time: 2.418971061706543
Epoch: 17, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4954 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1105621
	speed: 0.0168s/iter; left time: 203.1982s
Epoch: 18 cost time: 2.338658094406128
Epoch: 18, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4962 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1146664
	speed: 0.0187s/iter; left time: 223.4242s
Epoch: 19 cost time: 2.557634115219116
Epoch: 19, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4892 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1131107
	speed: 0.0176s/iter; left time: 208.1922s
Epoch: 20 cost time: 2.4393022060394287
Epoch: 20, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4868 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1802
Validation loss decreased (0.124518 --> 0.124508).  Saving model ...
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1133161
	speed: 0.0177s/iter; left time: 206.0426s
Epoch: 21 cost time: 2.482678174972534
Epoch: 21, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4932 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1112558
	speed: 0.0170s/iter; left time: 195.4998s
Epoch: 22 cost time: 2.423405408859253
Epoch: 22, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4931 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1123897
	speed: 0.0175s/iter; left time: 198.6869s
Epoch: 23 cost time: 2.488222122192383
Epoch: 23, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4965 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1129283
	speed: 0.0177s/iter; left time: 198.8751s
Epoch: 24 cost time: 2.5318799018859863
Epoch: 24, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4921 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1802
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1088746
	speed: 0.0186s/iter; left time: 206.4493s
Epoch: 25 cost time: 2.566793441772461
Epoch: 25, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4872 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1148835
	speed: 0.0175s/iter; left time: 190.9673s
Epoch: 26 cost time: 2.4575273990631104
Epoch: 26, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4981 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1802
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1202130
	speed: 0.0168s/iter; left time: 181.3123s
Epoch: 27 cost time: 2.4015469551086426
Epoch: 27, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4878 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1156846
	speed: 0.0215s/iter; left time: 228.6313s
Epoch: 28 cost time: 3.0595030784606934
Epoch: 28, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4909 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1802
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1098376
	speed: 0.0487s/iter; left time: 510.1180s
Epoch: 29 cost time: 7.937935829162598
Epoch: 29, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4837 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1113926
	speed: 0.0238s/iter; left time: 245.9330s
Epoch: 30 cost time: 3.1346280574798584
Epoch: 30, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4909 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.1402766853570938, mae:0.22012732923030853, mape:0.5413631796836853, mspe:20.691425323486328 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.4832
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2405953
	speed: 0.0182s/iter; left time: 265.3305s
Epoch: 1 cost time: 2.626674175262451
Epoch: 1, Steps: 147 Train Loss: 0.3222 (Forecasting Loss:0.3196 + XiCon Loss:2.5661 x Lambda(0.001)), Vali MSE Loss: 0.2525 Test MSE Loss: 0.3556
Validation loss decreased (inf --> 0.252462).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1489815
	speed: 0.0191s/iter; left time: 276.1961s
Epoch: 2 cost time: 2.809387683868408
Epoch: 2, Steps: 147 Train Loss: 0.1581 (Forecasting Loss:0.1556 + XiCon Loss:2.5513 x Lambda(0.001)), Vali MSE Loss: 0.1541 Test MSE Loss: 0.2148
Validation loss decreased (0.252462 --> 0.154130).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1197923
	speed: 0.0198s/iter; left time: 283.6179s
Epoch: 3 cost time: 2.6790223121643066
Epoch: 3, Steps: 147 Train Loss: 0.1269 (Forecasting Loss:0.1244 + XiCon Loss:2.5025 x Lambda(0.001)), Vali MSE Loss: 0.1381 Test MSE Loss: 0.1952
Validation loss decreased (0.154130 --> 0.138070).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1124466
	speed: 0.0176s/iter; left time: 249.4167s
Epoch: 4 cost time: 2.469311237335205
Epoch: 4, Steps: 147 Train Loss: 0.1194 (Forecasting Loss:0.1169 + XiCon Loss:2.4804 x Lambda(0.001)), Vali MSE Loss: 0.1308 Test MSE Loss: 0.1887
Validation loss decreased (0.138070 --> 0.130789).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1081812
	speed: 0.0169s/iter; left time: 236.6868s
Epoch: 5 cost time: 2.3789567947387695
Epoch: 5, Steps: 147 Train Loss: 0.1158 (Forecasting Loss:0.1133 + XiCon Loss:2.4822 x Lambda(0.001)), Vali MSE Loss: 0.1279 Test MSE Loss: 0.1829
Validation loss decreased (0.130789 --> 0.127882).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1074885
	speed: 0.0170s/iter; left time: 235.7090s
Epoch: 6 cost time: 2.394542932510376
Epoch: 6, Steps: 147 Train Loss: 0.1140 (Forecasting Loss:0.1115 + XiCon Loss:2.4846 x Lambda(0.001)), Vali MSE Loss: 0.1263 Test MSE Loss: 0.1818
Validation loss decreased (0.127882 --> 0.126307).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1189541
	speed: 0.0188s/iter; left time: 258.2147s
Epoch: 7 cost time: 2.6366262435913086
Epoch: 7, Steps: 147 Train Loss: 0.1131 (Forecasting Loss:0.1106 + XiCon Loss:2.4834 x Lambda(0.001)), Vali MSE Loss: 0.1253 Test MSE Loss: 0.1816
Validation loss decreased (0.126307 --> 0.125288).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1097151
	speed: 0.0166s/iter; left time: 224.9052s
Epoch: 8 cost time: 2.3730032444000244
Epoch: 8, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1101 + XiCon Loss:2.4784 x Lambda(0.001)), Vali MSE Loss: 0.1250 Test MSE Loss: 0.1812
Validation loss decreased (0.125288 --> 0.125023).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1105582
	speed: 0.0167s/iter; left time: 224.6848s
Epoch: 9 cost time: 2.3351898193359375
Epoch: 9, Steps: 147 Train Loss: 0.1123 (Forecasting Loss:0.1098 + XiCon Loss:2.4784 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1806
Validation loss decreased (0.125023 --> 0.124922).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1075693
	speed: 0.0178s/iter; left time: 236.4747s
Epoch: 10 cost time: 2.4703752994537354
Epoch: 10, Steps: 147 Train Loss: 0.1121 (Forecasting Loss:0.1097 + XiCon Loss:2.4854 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1803
Validation loss decreased (0.124922 --> 0.124721).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1111680
	speed: 0.0172s/iter; left time: 225.8820s
Epoch: 11 cost time: 2.4174747467041016
Epoch: 11, Steps: 147 Train Loss: 0.1121 (Forecasting Loss:0.1096 + XiCon Loss:2.4749 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1799
Validation loss decreased (0.124721 --> 0.124691).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1134290
	speed: 0.0176s/iter; left time: 228.3400s
Epoch: 12 cost time: 2.513911247253418
Epoch: 12, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4890 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1800
Validation loss decreased (0.124691 --> 0.124660).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1083026
	speed: 0.0165s/iter; left time: 211.8796s
Epoch: 13 cost time: 2.3588671684265137
Epoch: 13, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4877 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
Validation loss decreased (0.124660 --> 0.124603).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1087385
	speed: 0.0176s/iter; left time: 223.0250s
Epoch: 14 cost time: 2.481339454650879
Epoch: 14, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4841 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1093911
	speed: 0.0173s/iter; left time: 217.2922s
Epoch: 15 cost time: 2.4087893962860107
Epoch: 15, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4851 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
Validation loss decreased (0.124603 --> 0.124592).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1110700
	speed: 0.0171s/iter; left time: 211.7648s
Epoch: 16 cost time: 2.4007532596588135
Epoch: 16, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4795 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1085151
	speed: 0.0176s/iter; left time: 215.4154s
Epoch: 17 cost time: 2.7633020877838135
Epoch: 17, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4873 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1800
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1105126
	speed: 0.0189s/iter; left time: 228.9787s
Epoch: 18 cost time: 2.663055181503296
Epoch: 18, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4755 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1056919
	speed: 0.0179s/iter; left time: 214.1431s
Epoch: 19 cost time: 2.4785985946655273
Epoch: 19, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4866 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1800
Validation loss decreased (0.124592 --> 0.124525).  Saving model ...
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1214796
	speed: 0.0169s/iter; left time: 199.7180s
Epoch: 20 cost time: 2.395017623901367
Epoch: 20, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4899 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1155326
	speed: 0.0163s/iter; left time: 190.4079s
Epoch: 21 cost time: 2.2993550300598145
Epoch: 21, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4898 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1133884
	speed: 0.0184s/iter; left time: 212.0311s
Epoch: 22 cost time: 2.5572190284729004
Epoch: 22, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4871 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1140266
	speed: 0.0198s/iter; left time: 225.3353s
Epoch: 23 cost time: 2.726694107055664
Epoch: 23, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4810 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1065014
	speed: 0.0178s/iter; left time: 200.1031s
Epoch: 24 cost time: 2.4650237560272217
Epoch: 24, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4790 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1208364
	speed: 0.0167s/iter; left time: 184.8204s
Epoch: 25 cost time: 2.36881947517395
Epoch: 25, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4735 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1800
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1158894
	speed: 0.0170s/iter; left time: 185.4146s
Epoch: 26 cost time: 2.4011456966400146
Epoch: 26, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4769 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1800
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1128294
	speed: 0.0193s/iter; left time: 207.6179s
Epoch: 27 cost time: 2.6291630268096924
Epoch: 27, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4820 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1107403
	speed: 0.0200s/iter; left time: 212.6019s
Epoch: 28 cost time: 2.728274345397949
Epoch: 28, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4854 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1102076
	speed: 0.0170s/iter; left time: 178.6138s
Epoch: 29 cost time: 2.400334119796753
Epoch: 29, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4830 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.1405153125524521, mae:0.21947184205055237, mape:0.5438622236251831, mspe:20.753068923950195 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0493
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2400968
	speed: 0.0209s/iter; left time: 304.8477s
Epoch: 1 cost time: 2.892993211746216
Epoch: 1, Steps: 147 Train Loss: 0.3308 (Forecasting Loss:0.3282 + XiCon Loss:2.5853 x Lambda(0.001)), Vali MSE Loss: 0.2529 Test MSE Loss: 0.3587
Validation loss decreased (inf --> 0.252882).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1471138
	speed: 0.0175s/iter; left time: 252.3960s
Epoch: 2 cost time: 2.4793667793273926
Epoch: 2, Steps: 147 Train Loss: 0.1598 (Forecasting Loss:0.1572 + XiCon Loss:2.5666 x Lambda(0.001)), Vali MSE Loss: 0.1545 Test MSE Loss: 0.2215
Validation loss decreased (0.252882 --> 0.154523).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1344041
	speed: 0.0184s/iter; left time: 263.4895s
Epoch: 3 cost time: 2.540822744369507
Epoch: 3, Steps: 147 Train Loss: 0.1280 (Forecasting Loss:0.1254 + XiCon Loss:2.5417 x Lambda(0.001)), Vali MSE Loss: 0.1381 Test MSE Loss: 0.1960
Validation loss decreased (0.154523 --> 0.138142).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1238159
	speed: 0.0174s/iter; left time: 246.4123s
Epoch: 4 cost time: 2.429626226425171
Epoch: 4, Steps: 147 Train Loss: 0.1200 (Forecasting Loss:0.1175 + XiCon Loss:2.5242 x Lambda(0.001)), Vali MSE Loss: 0.1321 Test MSE Loss: 0.1916
Validation loss decreased (0.138142 --> 0.132050).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1161533
	speed: 0.0173s/iter; left time: 241.8268s
Epoch: 5 cost time: 2.384329319000244
Epoch: 5, Steps: 147 Train Loss: 0.1164 (Forecasting Loss:0.1138 + XiCon Loss:2.5281 x Lambda(0.001)), Vali MSE Loss: 0.1287 Test MSE Loss: 0.1840
Validation loss decreased (0.132050 --> 0.128674).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1066898
	speed: 0.0198s/iter; left time: 275.0431s
Epoch: 6 cost time: 2.852250099182129
Epoch: 6, Steps: 147 Train Loss: 0.1145 (Forecasting Loss:0.1120 + XiCon Loss:2.5200 x Lambda(0.001)), Vali MSE Loss: 0.1276 Test MSE Loss: 0.1854
Validation loss decreased (0.128674 --> 0.127558).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1138985
	speed: 0.0171s/iter; left time: 234.1781s
Epoch: 7 cost time: 2.412522315979004
Epoch: 7, Steps: 147 Train Loss: 0.1136 (Forecasting Loss:0.1111 + XiCon Loss:2.5105 x Lambda(0.001)), Vali MSE Loss: 0.1269 Test MSE Loss: 0.1857
Validation loss decreased (0.127558 --> 0.126870).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1150683
	speed: 0.0167s/iter; left time: 226.0116s
Epoch: 8 cost time: 2.3152916431427
Epoch: 8, Steps: 147 Train Loss: 0.1131 (Forecasting Loss:0.1106 + XiCon Loss:2.5253 x Lambda(0.001)), Vali MSE Loss: 0.1263 Test MSE Loss: 0.1823
Validation loss decreased (0.126870 --> 0.126346).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1098157
	speed: 0.0175s/iter; left time: 234.3979s
Epoch: 9 cost time: 2.4785592555999756
Epoch: 9, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.5121 x Lambda(0.001)), Vali MSE Loss: 0.1261 Test MSE Loss: 0.1834
Validation loss decreased (0.126346 --> 0.126068).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1134248
	speed: 0.0175s/iter; left time: 232.4172s
Epoch: 10 cost time: 2.452238082885742
Epoch: 10, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1101 + XiCon Loss:2.5114 x Lambda(0.001)), Vali MSE Loss: 0.1260 Test MSE Loss: 0.1837
Validation loss decreased (0.126068 --> 0.126027).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1108595
	speed: 0.0171s/iter; left time: 225.0090s
Epoch: 11 cost time: 2.467010021209717
Epoch: 11, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1101 + XiCon Loss:2.5121 x Lambda(0.001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1830
Validation loss decreased (0.126027 --> 0.125914).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1103592
	speed: 0.0176s/iter; left time: 228.1330s
Epoch: 12 cost time: 2.470028877258301
Epoch: 12, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5157 x Lambda(0.001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1830
Validation loss decreased (0.125914 --> 0.125866).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1129237
	speed: 0.0168s/iter; left time: 216.1794s
Epoch: 13 cost time: 2.374882698059082
Epoch: 13, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5106 x Lambda(0.001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1830
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1191408
	speed: 0.0170s/iter; left time: 216.2851s
Epoch: 14 cost time: 2.414271116256714
Epoch: 14, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.5150 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
Validation loss decreased (0.125866 --> 0.125820).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1139359
	speed: 0.0167s/iter; left time: 210.0459s
Epoch: 15 cost time: 2.3740532398223877
Epoch: 15, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1099 + XiCon Loss:2.5211 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1103264
	speed: 0.0171s/iter; left time: 211.8941s
Epoch: 16 cost time: 2.4414594173431396
Epoch: 16, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.5130 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1056401
	speed: 0.0182s/iter; left time: 223.5202s
Epoch: 17 cost time: 2.4862494468688965
Epoch: 17, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1099 + XiCon Loss:2.5157 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
Validation loss decreased (0.125820 --> 0.125802).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1067234
	speed: 0.0169s/iter; left time: 204.9391s
Epoch: 18 cost time: 2.4161765575408936
Epoch: 18, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.5046 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1153973
	speed: 0.0173s/iter; left time: 207.1558s
Epoch: 19 cost time: 2.4336369037628174
Epoch: 19, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1099 + XiCon Loss:2.5096 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1111567
	speed: 0.0179s/iter; left time: 211.2949s
Epoch: 20 cost time: 2.5073959827423096
Epoch: 20, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5191 x Lambda(0.001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1830
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1073960
	speed: 0.0181s/iter; left time: 211.0597s
Epoch: 21 cost time: 2.492032289505005
Epoch: 21, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5126 x Lambda(0.001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1830
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1129942
	speed: 0.0213s/iter; left time: 245.5083s
Epoch: 22 cost time: 2.899104356765747
Epoch: 22, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1099 + XiCon Loss:2.5101 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1106150
	speed: 0.0173s/iter; left time: 197.0229s
Epoch: 23 cost time: 2.40898060798645
Epoch: 23, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5165 x Lambda(0.001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1830
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1146424
	speed: 0.0175s/iter; left time: 196.8435s
Epoch: 24 cost time: 2.487441301345825
Epoch: 24, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5197 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1189574
	speed: 0.0166s/iter; left time: 184.0845s
Epoch: 25 cost time: 2.339608669281006
Epoch: 25, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5122 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1158798
	speed: 0.0169s/iter; left time: 184.7685s
Epoch: 26 cost time: 2.3845221996307373
Epoch: 26, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5128 x Lambda(0.001)), Vali MSE Loss: 0.1258 Test MSE Loss: 0.1830
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1086716
	speed: 0.0180s/iter; left time: 194.0167s
Epoch: 27 cost time: 2.5880939960479736
Epoch: 27, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.5178 x Lambda(0.001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1830
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14241452515125275, mae:0.22353045642375946, mape:0.5541760921478271, mspe:21.582426071166992 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1415+-0.00138, MAE:0.2217+-0.00238, MAPE:0.5481+-0.01054, MSPE:20.9038+-1.29581, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.01, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=1440, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.99, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9690
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2702049
	speed: 0.0220s/iter; left time: 296.5580s
Epoch: 1 cost time: 2.9108896255493164
Epoch: 1, Steps: 136 Train Loss: 0.3632 (Forecasting Loss:0.3373 + XiCon Loss:2.5957 x Lambda(0.01)), Vali MSE Loss: 0.2672 Test MSE Loss: 0.3776
Validation loss decreased (inf --> 0.267169).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1833533
	speed: 0.0213s/iter; left time: 284.7409s
Epoch: 2 cost time: 3.2080862522125244
Epoch: 2, Steps: 136 Train Loss: 0.1969 (Forecasting Loss:0.1719 + XiCon Loss:2.4941 x Lambda(0.01)), Vali MSE Loss: 0.1821 Test MSE Loss: 0.2536
Validation loss decreased (0.267169 --> 0.182108).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1656073
	speed: 0.0555s/iter; left time: 734.1833s
Epoch: 3 cost time: 6.20343804359436
Epoch: 3, Steps: 136 Train Loss: 0.1657 (Forecasting Loss:0.1411 + XiCon Loss:2.4563 x Lambda(0.01)), Vali MSE Loss: 0.1642 Test MSE Loss: 0.2313
Validation loss decreased (0.182108 --> 0.164160).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1544382
	speed: 0.0186s/iter; left time: 243.8099s
Epoch: 4 cost time: 2.4536123275756836
Epoch: 4, Steps: 136 Train Loss: 0.1574 (Forecasting Loss:0.1331 + XiCon Loss:2.4336 x Lambda(0.01)), Vali MSE Loss: 0.1582 Test MSE Loss: 0.2146
Validation loss decreased (0.164160 --> 0.158165).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1556797
	speed: 0.0175s/iter; left time: 226.4358s
Epoch: 5 cost time: 2.31844425201416
Epoch: 5, Steps: 136 Train Loss: 0.1535 (Forecasting Loss:0.1293 + XiCon Loss:2.4282 x Lambda(0.01)), Vali MSE Loss: 0.1570 Test MSE Loss: 0.2131
Validation loss decreased (0.158165 --> 0.157001).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1540487
	speed: 0.0193s/iter; left time: 246.8124s
Epoch: 6 cost time: 2.6312789916992188
Epoch: 6, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1274 + XiCon Loss:2.4198 x Lambda(0.01)), Vali MSE Loss: 0.1554 Test MSE Loss: 0.2129
Validation loss decreased (0.157001 --> 0.155398).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1470004
	speed: 0.0202s/iter; left time: 255.8201s
Epoch: 7 cost time: 2.647003173828125
Epoch: 7, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1264 + XiCon Loss:2.4158 x Lambda(0.01)), Vali MSE Loss: 0.1541 Test MSE Loss: 0.2137
Validation loss decreased (0.155398 --> 0.154061).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1444231
	speed: 0.0201s/iter; left time: 251.9915s
Epoch: 8 cost time: 2.6373093128204346
Epoch: 8, Steps: 136 Train Loss: 0.1499 (Forecasting Loss:0.1258 + XiCon Loss:2.4130 x Lambda(0.01)), Vali MSE Loss: 0.1556 Test MSE Loss: 0.2130
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1551380
	speed: 0.0186s/iter; left time: 230.2612s
Epoch: 9 cost time: 2.4776771068573
Epoch: 9, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1254 + XiCon Loss:2.4153 x Lambda(0.01)), Vali MSE Loss: 0.1546 Test MSE Loss: 0.2123
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1496124
	speed: 0.0197s/iter; left time: 241.6452s
Epoch: 10 cost time: 2.5946266651153564
Epoch: 10, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1254 + XiCon Loss:2.4171 x Lambda(0.01)), Vali MSE Loss: 0.1548 Test MSE Loss: 0.2121
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1502876
	speed: 0.0198s/iter; left time: 240.8813s
Epoch: 11 cost time: 2.61599063873291
Epoch: 11, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1252 + XiCon Loss:2.4127 x Lambda(0.01)), Vali MSE Loss: 0.1553 Test MSE Loss: 0.2116
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1547824
	speed: 0.0202s/iter; left time: 242.6835s
Epoch: 12 cost time: 2.6757924556732178
Epoch: 12, Steps: 136 Train Loss: 0.1493 (Forecasting Loss:0.1252 + XiCon Loss:2.4159 x Lambda(0.01)), Vali MSE Loss: 0.1552 Test MSE Loss: 0.2121
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1539761
	speed: 0.0204s/iter; left time: 242.3376s
Epoch: 13 cost time: 2.737560510635376
Epoch: 13, Steps: 136 Train Loss: 0.1493 (Forecasting Loss:0.1252 + XiCon Loss:2.4078 x Lambda(0.01)), Vali MSE Loss: 0.1550 Test MSE Loss: 0.2121
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1587676
	speed: 0.0200s/iter; left time: 235.1312s
Epoch: 14 cost time: 2.6563541889190674
Epoch: 14, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1252 + XiCon Loss:2.4213 x Lambda(0.01)), Vali MSE Loss: 0.1550 Test MSE Loss: 0.2122
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1441120
	speed: 0.0188s/iter; left time: 218.5378s
Epoch: 15 cost time: 2.4886884689331055
Epoch: 15, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1251 + XiCon Loss:2.4108 x Lambda(0.01)), Vali MSE Loss: 0.1551 Test MSE Loss: 0.2122
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1552100
	speed: 0.0194s/iter; left time: 221.8820s
Epoch: 16 cost time: 2.5528032779693604
Epoch: 16, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1251 + XiCon Loss:2.4134 x Lambda(0.01)), Vali MSE Loss: 0.1551 Test MSE Loss: 0.2122
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1408936
	speed: 0.0192s/iter; left time: 217.5791s
Epoch: 17 cost time: 2.5059783458709717
Epoch: 17, Steps: 136 Train Loss: 0.1493 (Forecasting Loss:0.1251 + XiCon Loss:2.4151 x Lambda(0.01)), Vali MSE Loss: 0.1550 Test MSE Loss: 0.2122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.17672885954380035, mae:0.25060927867889404, mape:0.6230762004852295, mspe:29.062538146972656 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9590
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2649898
	speed: 0.0211s/iter; left time: 285.3918s
Epoch: 1 cost time: 2.7412476539611816
Epoch: 1, Steps: 136 Train Loss: 0.3616 (Forecasting Loss:0.3358 + XiCon Loss:2.5818 x Lambda(0.01)), Vali MSE Loss: 0.2650 Test MSE Loss: 0.3800
Validation loss decreased (inf --> 0.265041).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1809129
	speed: 0.0224s/iter; left time: 299.3684s
Epoch: 2 cost time: 2.883347511291504
Epoch: 2, Steps: 136 Train Loss: 0.1977 (Forecasting Loss:0.1727 + XiCon Loss:2.5030 x Lambda(0.01)), Vali MSE Loss: 0.1681 Test MSE Loss: 0.2497
Validation loss decreased (0.265041 --> 0.168131).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1713596
	speed: 0.0196s/iter; left time: 259.0147s
Epoch: 3 cost time: 2.5591628551483154
Epoch: 3, Steps: 136 Train Loss: 0.1672 (Forecasting Loss:0.1428 + XiCon Loss:2.4437 x Lambda(0.01)), Vali MSE Loss: 0.1532 Test MSE Loss: 0.2243
Validation loss decreased (0.168131 --> 0.153153).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1529934
	speed: 0.0203s/iter; left time: 265.5286s
Epoch: 4 cost time: 2.671579599380493
Epoch: 4, Steps: 136 Train Loss: 0.1596 (Forecasting Loss:0.1352 + XiCon Loss:2.4444 x Lambda(0.01)), Vali MSE Loss: 0.1465 Test MSE Loss: 0.2130
Validation loss decreased (0.153153 --> 0.146479).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1426993
	speed: 0.0201s/iter; left time: 260.4322s
Epoch: 5 cost time: 2.6525661945343018
Epoch: 5, Steps: 136 Train Loss: 0.1558 (Forecasting Loss:0.1314 + XiCon Loss:2.4412 x Lambda(0.01)), Vali MSE Loss: 0.1414 Test MSE Loss: 0.2194
Validation loss decreased (0.146479 --> 0.141366).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1535176
	speed: 0.0208s/iter; left time: 267.2244s
Epoch: 6 cost time: 2.7513134479522705
Epoch: 6, Steps: 136 Train Loss: 0.1540 (Forecasting Loss:0.1295 + XiCon Loss:2.4413 x Lambda(0.01)), Vali MSE Loss: 0.1386 Test MSE Loss: 0.2154
Validation loss decreased (0.141366 --> 0.138589).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1471763
	speed: 0.0198s/iter; left time: 251.1424s
Epoch: 7 cost time: 2.6422059535980225
Epoch: 7, Steps: 136 Train Loss: 0.1528 (Forecasting Loss:0.1285 + XiCon Loss:2.4329 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2123
Validation loss decreased (0.138589 --> 0.137768).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1519564
	speed: 0.0198s/iter; left time: 248.5319s
Epoch: 8 cost time: 2.6195554733276367
Epoch: 8, Steps: 136 Train Loss: 0.1523 (Forecasting Loss:0.1279 + XiCon Loss:2.4428 x Lambda(0.01)), Vali MSE Loss: 0.1373 Test MSE Loss: 0.2138
Validation loss decreased (0.137768 --> 0.137274).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1529382
	speed: 0.0222s/iter; left time: 275.9950s
Epoch: 9 cost time: 2.875450849533081
Epoch: 9, Steps: 136 Train Loss: 0.1519 (Forecasting Loss:0.1276 + XiCon Loss:2.4355 x Lambda(0.01)), Vali MSE Loss: 0.1372 Test MSE Loss: 0.2118
Validation loss decreased (0.137274 --> 0.137210).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1377672
	speed: 0.0203s/iter; left time: 249.0657s
Epoch: 10 cost time: 2.754523754119873
Epoch: 10, Steps: 136 Train Loss: 0.1518 (Forecasting Loss:0.1274 + XiCon Loss:2.4414 x Lambda(0.01)), Vali MSE Loss: 0.1369 Test MSE Loss: 0.2132
Validation loss decreased (0.137210 --> 0.136921).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1488196
	speed: 0.0215s/iter; left time: 260.6690s
Epoch: 11 cost time: 2.785839319229126
Epoch: 11, Steps: 136 Train Loss: 0.1518 (Forecasting Loss:0.1274 + XiCon Loss:2.4449 x Lambda(0.01)), Vali MSE Loss: 0.1369 Test MSE Loss: 0.2129
Validation loss decreased (0.136921 --> 0.136905).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1456776
	speed: 0.0210s/iter; left time: 251.9359s
Epoch: 12 cost time: 2.7473299503326416
Epoch: 12, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1273 + XiCon Loss:2.4357 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
Validation loss decreased (0.136905 --> 0.136755).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1577594
	speed: 0.0201s/iter; left time: 238.7952s
Epoch: 13 cost time: 2.636458396911621
Epoch: 13, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1272 + XiCon Loss:2.4379 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2127
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1544983
	speed: 0.0200s/iter; left time: 234.3691s
Epoch: 14 cost time: 2.630284547805786
Epoch: 14, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1272 + XiCon Loss:2.4362 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2127
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1451334
	speed: 0.0248s/iter; left time: 287.0326s
Epoch: 15 cost time: 3.114746570587158
Epoch: 15, Steps: 136 Train Loss: 0.1515 (Forecasting Loss:0.1272 + XiCon Loss:2.4334 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1540634
	speed: 0.0206s/iter; left time: 235.8010s
Epoch: 16 cost time: 2.6916913986206055
Epoch: 16, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1272 + XiCon Loss:2.4414 x Lambda(0.01)), Vali MSE Loss: 0.1367 Test MSE Loss: 0.2128
Validation loss decreased (0.136755 --> 0.136728).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1516858
	speed: 0.0211s/iter; left time: 239.2973s
Epoch: 17 cost time: 2.7623698711395264
Epoch: 17, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1273 + XiCon Loss:2.4349 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1563554
	speed: 0.0210s/iter; left time: 234.7547s
Epoch: 18 cost time: 2.751600503921509
Epoch: 18, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1272 + XiCon Loss:2.4370 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1557864
	speed: 0.0209s/iter; left time: 230.8983s
Epoch: 19 cost time: 2.7879481315612793
Epoch: 19, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1272 + XiCon Loss:2.4425 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1540858
	speed: 0.0198s/iter; left time: 216.6877s
Epoch: 20 cost time: 2.6432104110717773
Epoch: 20, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1272 + XiCon Loss:2.4332 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1559312
	speed: 0.0205s/iter; left time: 221.3291s
Epoch: 21 cost time: 2.7037103176116943
Epoch: 21, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1272 + XiCon Loss:2.4356 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1493461
	speed: 0.0203s/iter; left time: 216.2804s
Epoch: 22 cost time: 2.666860580444336
Epoch: 22, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1273 + XiCon Loss:2.4447 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1546411
	speed: 0.0203s/iter; left time: 213.6954s
Epoch: 23 cost time: 2.663604259490967
Epoch: 23, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1272 + XiCon Loss:2.4435 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1468309
	speed: 0.0220s/iter; left time: 227.7157s
Epoch: 24 cost time: 2.844721555709839
Epoch: 24, Steps: 136 Train Loss: 0.1516 (Forecasting Loss:0.1272 + XiCon Loss:2.4409 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1541985
	speed: 0.0225s/iter; left time: 230.4225s
Epoch: 25 cost time: 2.916322708129883
Epoch: 25, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1272 + XiCon Loss:2.4416 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1559765
	speed: 0.0199s/iter; left time: 200.6524s
Epoch: 26 cost time: 2.63157320022583
Epoch: 26, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1272 + XiCon Loss:2.4447 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.17324957251548767, mae:0.2523272931575775, mape:0.647412896156311, mspe:37.609737396240234 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9477
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2642492
	speed: 0.0189s/iter; left time: 254.5697s
Epoch: 1 cost time: 2.4859910011291504
Epoch: 1, Steps: 136 Train Loss: 0.3669 (Forecasting Loss:0.3412 + XiCon Loss:2.5744 x Lambda(0.01)), Vali MSE Loss: 0.2653 Test MSE Loss: 0.3812
Validation loss decreased (inf --> 0.265304).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1710835
	speed: 0.0184s/iter; left time: 245.7949s
Epoch: 2 cost time: 2.4028918743133545
Epoch: 2, Steps: 136 Train Loss: 0.1965 (Forecasting Loss:0.1714 + XiCon Loss:2.5095 x Lambda(0.01)), Vali MSE Loss: 0.1691 Test MSE Loss: 0.2535
Validation loss decreased (0.265304 --> 0.169142).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1647316
	speed: 0.0192s/iter; left time: 254.2886s
Epoch: 3 cost time: 2.51711106300354
Epoch: 3, Steps: 136 Train Loss: 0.1664 (Forecasting Loss:0.1415 + XiCon Loss:2.4877 x Lambda(0.01)), Vali MSE Loss: 0.1555 Test MSE Loss: 0.2223
Validation loss decreased (0.169142 --> 0.155499).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1578582
	speed: 0.0208s/iter; left time: 272.8843s
Epoch: 4 cost time: 2.784090995788574
Epoch: 4, Steps: 136 Train Loss: 0.1582 (Forecasting Loss:0.1334 + XiCon Loss:2.4729 x Lambda(0.01)), Vali MSE Loss: 0.1505 Test MSE Loss: 0.2134
Validation loss decreased (0.155499 --> 0.150499).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1475462
	speed: 0.0197s/iter; left time: 254.9199s
Epoch: 5 cost time: 2.5978920459747314
Epoch: 5, Steps: 136 Train Loss: 0.1539 (Forecasting Loss:0.1294 + XiCon Loss:2.4565 x Lambda(0.01)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2105
Validation loss decreased (0.150499 --> 0.143376).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1459224
	speed: 0.0195s/iter; left time: 250.4351s
Epoch: 6 cost time: 2.6217262744903564
Epoch: 6, Steps: 136 Train Loss: 0.1519 (Forecasting Loss:0.1273 + XiCon Loss:2.4602 x Lambda(0.01)), Vali MSE Loss: 0.1426 Test MSE Loss: 0.2084
Validation loss decreased (0.143376 --> 0.142583).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1520698
	speed: 0.0193s/iter; left time: 244.9336s
Epoch: 7 cost time: 2.537235736846924
Epoch: 7, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1263 + XiCon Loss:2.4641 x Lambda(0.01)), Vali MSE Loss: 0.1413 Test MSE Loss: 0.2068
Validation loss decreased (0.142583 --> 0.141306).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1502421
	speed: 0.0183s/iter; left time: 229.5225s
Epoch: 8 cost time: 2.4745242595672607
Epoch: 8, Steps: 136 Train Loss: 0.1503 (Forecasting Loss:0.1257 + XiCon Loss:2.4565 x Lambda(0.01)), Vali MSE Loss: 0.1419 Test MSE Loss: 0.2065
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1552745
	speed: 0.0203s/iter; left time: 251.8696s
Epoch: 9 cost time: 2.6154842376708984
Epoch: 9, Steps: 136 Train Loss: 0.1500 (Forecasting Loss:0.1254 + XiCon Loss:2.4565 x Lambda(0.01)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.2069
Validation loss decreased (0.141306 --> 0.140726).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1519445
	speed: 0.0193s/iter; left time: 237.3006s
Epoch: 10 cost time: 2.7018728256225586
Epoch: 10, Steps: 136 Train Loss: 0.1499 (Forecasting Loss:0.1253 + XiCon Loss:2.4613 x Lambda(0.01)), Vali MSE Loss: 0.1416 Test MSE Loss: 0.2065
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1444706
	speed: 0.0193s/iter; left time: 234.4932s
Epoch: 11 cost time: 2.5268726348876953
Epoch: 11, Steps: 136 Train Loss: 0.1498 (Forecasting Loss:0.1252 + XiCon Loss:2.4579 x Lambda(0.01)), Vali MSE Loss: 0.1406 Test MSE Loss: 0.2067
Validation loss decreased (0.140726 --> 0.140639).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1516587
	speed: 0.0193s/iter; left time: 232.2291s
Epoch: 12 cost time: 2.544130802154541
Epoch: 12, Steps: 136 Train Loss: 0.1498 (Forecasting Loss:0.1251 + XiCon Loss:2.4620 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2068
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1438029
	speed: 0.0235s/iter; left time: 278.3505s
Epoch: 13 cost time: 3.027538537979126
Epoch: 13, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4638 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2067
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1476021
	speed: 0.0190s/iter; left time: 222.4537s
Epoch: 14 cost time: 2.493494987487793
Epoch: 14, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4561 x Lambda(0.01)), Vali MSE Loss: 0.1406 Test MSE Loss: 0.2066
Validation loss decreased (0.140639 --> 0.140608).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1536316
	speed: 0.0200s/iter; left time: 232.4035s
Epoch: 15 cost time: 2.6169633865356445
Epoch: 15, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4541 x Lambda(0.01)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.2066
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1543989
	speed: 0.0190s/iter; left time: 217.8666s
Epoch: 16 cost time: 2.48362135887146
Epoch: 16, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4569 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1442934
	speed: 0.0199s/iter; left time: 224.9494s
Epoch: 17 cost time: 2.6256322860717773
Epoch: 17, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4552 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1512270
	speed: 0.0208s/iter; left time: 233.1700s
Epoch: 18 cost time: 2.680060386657715
Epoch: 18, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4624 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1535968
	speed: 0.0191s/iter; left time: 211.4044s
Epoch: 19 cost time: 2.524273633956909
Epoch: 19, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1251 + XiCon Loss:2.4523 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1458140
	speed: 0.0195s/iter; left time: 213.1572s
Epoch: 20 cost time: 2.5487189292907715
Epoch: 20, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1251 + XiCon Loss:2.4567 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1502570
	speed: 0.0187s/iter; left time: 201.8443s
Epoch: 21 cost time: 2.5930097103118896
Epoch: 21, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4602 x Lambda(0.01)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.2066
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1511568
	speed: 0.0197s/iter; left time: 209.6135s
Epoch: 22 cost time: 2.731548309326172
Epoch: 22, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4616 x Lambda(0.01)), Vali MSE Loss: 0.1406 Test MSE Loss: 0.2066
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1461763
	speed: 0.0197s/iter; left time: 206.5183s
Epoch: 23 cost time: 2.6198554039001465
Epoch: 23, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1251 + XiCon Loss:2.4534 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1492964
	speed: 0.0186s/iter; left time: 192.8248s
Epoch: 24 cost time: 2.440241813659668
Epoch: 24, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4587 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.1695859730243683, mae:0.24353308975696564, mape:0.6068001389503479, mspe:27.99185562133789 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.6208
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2583732
	speed: 0.0193s/iter; left time: 260.4145s
Epoch: 1 cost time: 2.5254294872283936
Epoch: 1, Steps: 136 Train Loss: 0.3579 (Forecasting Loss:0.3323 + XiCon Loss:2.5595 x Lambda(0.01)), Vali MSE Loss: 0.2546 Test MSE Loss: 0.3659
Validation loss decreased (inf --> 0.254643).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1793415
	speed: 0.0216s/iter; left time: 288.2773s
Epoch: 2 cost time: 2.8870046138763428
Epoch: 2, Steps: 136 Train Loss: 0.1961 (Forecasting Loss:0.1709 + XiCon Loss:2.5118 x Lambda(0.01)), Vali MSE Loss: 0.1722 Test MSE Loss: 0.2430
Validation loss decreased (0.254643 --> 0.172217).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1649944
	speed: 0.0221s/iter; left time: 292.7512s
Epoch: 3 cost time: 2.965965747833252
Epoch: 3, Steps: 136 Train Loss: 0.1659 (Forecasting Loss:0.1410 + XiCon Loss:2.4873 x Lambda(0.01)), Vali MSE Loss: 0.1575 Test MSE Loss: 0.2185
Validation loss decreased (0.172217 --> 0.157466).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1586856
	speed: 0.0219s/iter; left time: 286.0976s
Epoch: 4 cost time: 2.9613263607025146
Epoch: 4, Steps: 136 Train Loss: 0.1576 (Forecasting Loss:0.1329 + XiCon Loss:2.4653 x Lambda(0.01)), Vali MSE Loss: 0.1630 Test MSE Loss: 0.2103
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1578906
	speed: 0.0201s/iter; left time: 260.9509s
Epoch: 5 cost time: 2.62490177154541
Epoch: 5, Steps: 136 Train Loss: 0.1538 (Forecasting Loss:0.1292 + XiCon Loss:2.4572 x Lambda(0.01)), Vali MSE Loss: 0.1502 Test MSE Loss: 0.2129
Validation loss decreased (0.157466 --> 0.150225).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1542547
	speed: 0.0204s/iter; left time: 260.9363s
Epoch: 6 cost time: 2.6779861450195312
Epoch: 6, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1272 + XiCon Loss:2.4592 x Lambda(0.01)), Vali MSE Loss: 0.1458 Test MSE Loss: 0.2091
Validation loss decreased (0.150225 --> 0.145771).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1442068
	speed: 0.0204s/iter; left time: 258.5856s
Epoch: 7 cost time: 2.6533496379852295
Epoch: 7, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1262 + XiCon Loss:2.4494 x Lambda(0.01)), Vali MSE Loss: 0.1508 Test MSE Loss: 0.2080
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1494541
	speed: 0.0198s/iter; left time: 247.9174s
Epoch: 8 cost time: 2.613616704940796
Epoch: 8, Steps: 136 Train Loss: 0.1502 (Forecasting Loss:0.1257 + XiCon Loss:2.4487 x Lambda(0.01)), Vali MSE Loss: 0.1475 Test MSE Loss: 0.2076
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1546191
	speed: 0.0211s/iter; left time: 261.4479s
Epoch: 9 cost time: 2.750260829925537
Epoch: 9, Steps: 136 Train Loss: 0.1500 (Forecasting Loss:0.1254 + XiCon Loss:2.4562 x Lambda(0.01)), Vali MSE Loss: 0.1475 Test MSE Loss: 0.2075
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1421693
	speed: 0.0636s/iter; left time: 780.2644s
Epoch: 10 cost time: 7.336724519729614
Epoch: 10, Steps: 136 Train Loss: 0.1498 (Forecasting Loss:0.1253 + XiCon Loss:2.4511 x Lambda(0.01)), Vali MSE Loss: 0.1475 Test MSE Loss: 0.2068
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1492359
	speed: 0.0190s/iter; left time: 230.8006s
Epoch: 11 cost time: 2.5192461013793945
Epoch: 11, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1251 + XiCon Loss:2.4520 x Lambda(0.01)), Vali MSE Loss: 0.1476 Test MSE Loss: 0.2069
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1588732
	speed: 0.0175s/iter; left time: 210.3261s
Epoch: 12 cost time: 2.3094704151153564
Epoch: 12, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1251 + XiCon Loss:2.4533 x Lambda(0.01)), Vali MSE Loss: 0.1477 Test MSE Loss: 0.2072
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1485869
	speed: 0.0195s/iter; left time: 231.3910s
Epoch: 13 cost time: 2.6256744861602783
Epoch: 13, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1251 + XiCon Loss:2.4509 x Lambda(0.01)), Vali MSE Loss: 0.1476 Test MSE Loss: 0.2072
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1605364
	speed: 0.0210s/iter; left time: 245.8434s
Epoch: 14 cost time: 2.7615585327148438
Epoch: 14, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1251 + XiCon Loss:2.4526 x Lambda(0.01)), Vali MSE Loss: 0.1475 Test MSE Loss: 0.2072
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1444506
	speed: 0.0202s/iter; left time: 234.2723s
Epoch: 15 cost time: 2.640471935272217
Epoch: 15, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1251 + XiCon Loss:2.4506 x Lambda(0.01)), Vali MSE Loss: 0.1476 Test MSE Loss: 0.2072
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1409944
	speed: 0.0213s/iter; left time: 243.5503s
Epoch: 16 cost time: 2.7505640983581543
Epoch: 16, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1251 + XiCon Loss:2.4505 x Lambda(0.01)), Vali MSE Loss: 0.1477 Test MSE Loss: 0.2071
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.17114317417144775, mae:0.2470420002937317, mape:0.6253670454025269, mspe:32.52136993408203 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7913
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2649231
	speed: 0.0190s/iter; left time: 256.2037s
Epoch: 1 cost time: 2.5444865226745605
Epoch: 1, Steps: 136 Train Loss: 0.3597 (Forecasting Loss:0.3338 + XiCon Loss:2.5924 x Lambda(0.01)), Vali MSE Loss: 0.2616 Test MSE Loss: 0.3763
Validation loss decreased (inf --> 0.261568).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1760484
	speed: 0.0230s/iter; left time: 307.6780s
Epoch: 2 cost time: 2.917851686477661
Epoch: 2, Steps: 136 Train Loss: 0.1965 (Forecasting Loss:0.1713 + XiCon Loss:2.5182 x Lambda(0.01)), Vali MSE Loss: 0.1730 Test MSE Loss: 0.2420
Validation loss decreased (0.261568 --> 0.173006).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1592647
	speed: 0.0186s/iter; left time: 245.7926s
Epoch: 3 cost time: 2.4882009029388428
Epoch: 3, Steps: 136 Train Loss: 0.1656 (Forecasting Loss:0.1406 + XiCon Loss:2.5041 x Lambda(0.01)), Vali MSE Loss: 0.1546 Test MSE Loss: 0.2384
Validation loss decreased (0.173006 --> 0.154625).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1596840
	speed: 0.0194s/iter; left time: 253.3878s
Epoch: 4 cost time: 2.545616865158081
Epoch: 4, Steps: 136 Train Loss: 0.1576 (Forecasting Loss:0.1327 + XiCon Loss:2.4863 x Lambda(0.01)), Vali MSE Loss: 0.1481 Test MSE Loss: 0.2113
Validation loss decreased (0.154625 --> 0.148077).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1508351
	speed: 0.0199s/iter; left time: 257.4900s
Epoch: 5 cost time: 2.584663152694702
Epoch: 5, Steps: 136 Train Loss: 0.1538 (Forecasting Loss:0.1289 + XiCon Loss:2.4838 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2089
Validation loss decreased (0.148077 --> 0.140855).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1550211
	speed: 0.0218s/iter; left time: 279.2605s
Epoch: 6 cost time: 2.908137559890747
Epoch: 6, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1268 + XiCon Loss:2.4904 x Lambda(0.01)), Vali MSE Loss: 0.1411 Test MSE Loss: 0.2050
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1576266
	speed: 0.0196s/iter; left time: 248.2267s
Epoch: 7 cost time: 2.610136032104492
Epoch: 7, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1258 + XiCon Loss:2.4803 x Lambda(0.01)), Vali MSE Loss: 0.1391 Test MSE Loss: 0.2082
Validation loss decreased (0.140855 --> 0.139081).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1524001
	speed: 0.0191s/iter; left time: 239.8180s
Epoch: 8 cost time: 2.5097031593322754
Epoch: 8, Steps: 136 Train Loss: 0.1501 (Forecasting Loss:0.1253 + XiCon Loss:2.4747 x Lambda(0.01)), Vali MSE Loss: 0.1381 Test MSE Loss: 0.2063
Validation loss decreased (0.139081 --> 0.138052).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1489750
	speed: 0.0193s/iter; left time: 240.1852s
Epoch: 9 cost time: 2.5351755619049072
Epoch: 9, Steps: 136 Train Loss: 0.1499 (Forecasting Loss:0.1250 + XiCon Loss:2.4826 x Lambda(0.01)), Vali MSE Loss: 0.1383 Test MSE Loss: 0.2084
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1500708
	speed: 0.0200s/iter; left time: 245.5780s
Epoch: 10 cost time: 2.6734657287597656
Epoch: 10, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1249 + XiCon Loss:2.4843 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2076
Validation loss decreased (0.138052 --> 0.137825).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1543191
	speed: 0.0197s/iter; left time: 239.7004s
Epoch: 11 cost time: 2.6287760734558105
Epoch: 11, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1249 + XiCon Loss:2.4759 x Lambda(0.01)), Vali MSE Loss: 0.1382 Test MSE Loss: 0.2065
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1551275
	speed: 0.0188s/iter; left time: 225.8091s
Epoch: 12 cost time: 2.4608163833618164
Epoch: 12, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4752 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2070
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1506653
	speed: 0.0198s/iter; left time: 234.4517s
Epoch: 13 cost time: 2.5792734622955322
Epoch: 13, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1248 + XiCon Loss:2.4807 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2069
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1470318
	speed: 0.0195s/iter; left time: 228.7879s
Epoch: 14 cost time: 2.5725629329681396
Epoch: 14, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4767 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2070
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1455653
	speed: 0.0200s/iter; left time: 231.3953s
Epoch: 15 cost time: 2.7217965126037598
Epoch: 15, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1247 + XiCon Loss:2.4824 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2070
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1520798
	speed: 0.0206s/iter; left time: 235.8672s
Epoch: 16 cost time: 2.87094783782959
Epoch: 16, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1247 + XiCon Loss:2.4771 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2070
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1520726
	speed: 0.0199s/iter; left time: 225.0022s
Epoch: 17 cost time: 2.5894663333892822
Epoch: 17, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4825 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
Validation loss decreased (0.137825 --> 0.137806).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1508344
	speed: 0.0184s/iter; left time: 205.7162s
Epoch: 18 cost time: 2.432800531387329
Epoch: 18, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4773 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2070
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1525394
	speed: 0.0194s/iter; left time: 214.3436s
Epoch: 19 cost time: 2.4931020736694336
Epoch: 19, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4794 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2069
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1514347
	speed: 0.0196s/iter; left time: 213.5845s
Epoch: 20 cost time: 2.5584418773651123
Epoch: 20, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4753 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2069
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1441967
	speed: 0.0211s/iter; left time: 226.9977s
Epoch: 21 cost time: 2.771390676498413
Epoch: 21, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4802 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1381103
	speed: 0.0204s/iter; left time: 216.8166s
Epoch: 22 cost time: 2.6921768188476562
Epoch: 22, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4797 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1452506
	speed: 0.0212s/iter; left time: 222.3213s
Epoch: 23 cost time: 2.7517123222351074
Epoch: 23, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4783 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
Validation loss decreased (0.137806 --> 0.137773).  Saving model ...
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1437401
	speed: 0.0192s/iter; left time: 199.2771s
Epoch: 24 cost time: 2.5537526607513428
Epoch: 24, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4798 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1508202
	speed: 0.0190s/iter; left time: 195.0031s
Epoch: 25 cost time: 2.5197665691375732
Epoch: 25, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4831 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1477588
	speed: 0.0223s/iter; left time: 225.6963s
Epoch: 26 cost time: 2.9217772483825684
Epoch: 26, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4818 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1476624
	speed: 0.0197s/iter; left time: 196.1216s
Epoch: 27 cost time: 2.560541868209839
Epoch: 27, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4842 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2069
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1556614
	speed: 0.0196s/iter; left time: 192.9291s
Epoch: 28 cost time: 2.5629985332489014
Epoch: 28, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4779 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1557623
	speed: 0.0189s/iter; left time: 183.1860s
Epoch: 29 cost time: 2.4960832595825195
Epoch: 29, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4798 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1534571
	speed: 0.0185s/iter; left time: 177.2707s
Epoch: 30 cost time: 2.464343786239624
Epoch: 30, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4777 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.1431995
	speed: 0.0235s/iter; left time: 221.4340s
Epoch: 31 cost time: 3.013941526412964
Epoch: 31, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1247 + XiCon Loss:2.4860 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2069
Validation loss decreased (0.137773 --> 0.137714).  Saving model ...
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.1516259
	speed: 0.0197s/iter; left time: 183.0344s
Epoch: 32 cost time: 2.548692226409912
Epoch: 32, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4831 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2069
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.1516909
	speed: 0.0195s/iter; left time: 178.1902s
Epoch: 33 cost time: 2.55659818649292
Epoch: 33, Steps: 136 Train Loss: 0.1493 (Forecasting Loss:0.1246 + XiCon Loss:2.4703 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.1484179
	speed: 0.0189s/iter; left time: 170.4026s
Epoch: 34 cost time: 2.490307092666626
Epoch: 34, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1247 + XiCon Loss:2.4698 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.820766091346741e-13
	iters: 100, epoch: 35 | loss: 0.1496319
	speed: 0.0191s/iter; left time: 169.4922s
Epoch: 35 cost time: 2.539290189743042
Epoch: 35, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1248 + XiCon Loss:2.4819 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.9103830456733704e-13
	iters: 100, epoch: 36 | loss: 0.1484776
	speed: 0.0227s/iter; left time: 198.1212s
Epoch: 36 cost time: 2.974055528640747
Epoch: 36, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1247 + XiCon Loss:2.4811 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2069
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4551915228366852e-13
	iters: 100, epoch: 37 | loss: 0.1532381
	speed: 0.0189s/iter; left time: 162.9938s
Epoch: 37 cost time: 2.5359764099121094
Epoch: 37, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1247 + XiCon Loss:2.4811 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.275957614183426e-14
	iters: 100, epoch: 38 | loss: 0.1366847
	speed: 0.0195s/iter; left time: 164.8580s
Epoch: 38 cost time: 2.5251622200012207
Epoch: 38, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1247 + XiCon Loss:2.4908 x Lambda(0.01)), Vali MSE Loss: 0.1379 Test MSE Loss: 0.2069
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.637978807091713e-14
	iters: 100, epoch: 39 | loss: 0.1527940
	speed: 0.0194s/iter; left time: 161.9331s
Epoch: 39 cost time: 2.5774905681610107
Epoch: 39, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4853 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8189894035458565e-14
	iters: 100, epoch: 40 | loss: 0.1454886
	speed: 0.0196s/iter; left time: 160.6292s
Epoch: 40 cost time: 2.5511958599090576
Epoch: 40, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1247 + XiCon Loss:2.4855 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2069
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.094947017729283e-15
	iters: 100, epoch: 41 | loss: 0.1433981
	speed: 0.0221s/iter; left time: 177.9240s
Epoch: 41 cost time: 2.8963308334350586
Epoch: 41, Steps: 136 Train Loss: 0.1495 (Forecasting Loss:0.1247 + XiCon Loss:2.4780 x Lambda(0.01)), Vali MSE Loss: 0.1378 Test MSE Loss: 0.2069
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.16904376447200775, mae:0.2448553889989853, mape:0.6134939193725586, mspe:27.182159423828125 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1720+-0.00389, MAE:0.2477+-0.00464, MAPE:0.6232+-0.01918, MSPE:30.8735+-5.31535, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=2160, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.99, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7849
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2419222
	speed: 0.0295s/iter; left time: 365.8063s
Epoch: 1 cost time: 3.4369711875915527
Epoch: 1, Steps: 125 Train Loss: 0.3529 (Forecasting Loss:0.3502 + XiCon Loss:2.6517 x Lambda(0.001)), Vali MSE Loss: 0.2760 Test MSE Loss: 0.3744
Validation loss decreased (inf --> 0.276001).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1672472
	speed: 0.0215s/iter; left time: 263.5511s
Epoch: 2 cost time: 2.644360303878784
Epoch: 2, Steps: 125 Train Loss: 0.1820 (Forecasting Loss:0.1794 + XiCon Loss:2.5961 x Lambda(0.001)), Vali MSE Loss: 0.1956 Test MSE Loss: 0.2423
Validation loss decreased (0.276001 --> 0.195582).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1510870
	speed: 0.0225s/iter; left time: 273.3261s
Epoch: 3 cost time: 2.7690305709838867
Epoch: 3, Steps: 125 Train Loss: 0.1503 (Forecasting Loss:0.1477 + XiCon Loss:2.5637 x Lambda(0.001)), Vali MSE Loss: 0.1810 Test MSE Loss: 0.2217
Validation loss decreased (0.195582 --> 0.180958).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1290714
	speed: 0.0226s/iter; left time: 271.2491s
Epoch: 4 cost time: 2.7416160106658936
Epoch: 4, Steps: 125 Train Loss: 0.1427 (Forecasting Loss:0.1401 + XiCon Loss:2.5577 x Lambda(0.001)), Vali MSE Loss: 0.1829 Test MSE Loss: 0.2277
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1443196
	speed: 0.0221s/iter; left time: 263.4163s
Epoch: 5 cost time: 2.67441725730896
Epoch: 5, Steps: 125 Train Loss: 0.1386 (Forecasting Loss:0.1360 + XiCon Loss:2.5567 x Lambda(0.001)), Vali MSE Loss: 0.1808 Test MSE Loss: 0.2193
Validation loss decreased (0.180958 --> 0.180794).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1329073
	speed: 0.0236s/iter; left time: 278.1223s
Epoch: 6 cost time: 2.824976921081543
Epoch: 6, Steps: 125 Train Loss: 0.1367 (Forecasting Loss:0.1341 + XiCon Loss:2.5687 x Lambda(0.001)), Vali MSE Loss: 0.1803 Test MSE Loss: 0.2130
Validation loss decreased (0.180794 --> 0.180306).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1311220
	speed: 0.0224s/iter; left time: 261.1682s
Epoch: 7 cost time: 2.734318971633911
Epoch: 7, Steps: 125 Train Loss: 0.1357 (Forecasting Loss:0.1332 + XiCon Loss:2.5651 x Lambda(0.001)), Vali MSE Loss: 0.1813 Test MSE Loss: 0.2154
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1392008
	speed: 0.0219s/iter; left time: 252.0172s
Epoch: 8 cost time: 2.689000129699707
Epoch: 8, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5511 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
Validation loss decreased (0.180306 --> 0.180054).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1329055
	speed: 0.0214s/iter; left time: 243.5162s
Epoch: 9 cost time: 2.621591091156006
Epoch: 9, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1323 + XiCon Loss:2.5561 x Lambda(0.001)), Vali MSE Loss: 0.1804 Test MSE Loss: 0.2126
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1354121
	speed: 0.0210s/iter; left time: 236.9842s
Epoch: 10 cost time: 2.588747024536133
Epoch: 10, Steps: 125 Train Loss: 0.1348 (Forecasting Loss:0.1322 + XiCon Loss:2.5557 x Lambda(0.001)), Vali MSE Loss: 0.1799 Test MSE Loss: 0.2130
Validation loss decreased (0.180054 --> 0.179942).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1444881
	speed: 0.0241s/iter; left time: 268.5848s
Epoch: 11 cost time: 2.9779610633850098
Epoch: 11, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1321 + XiCon Loss:2.5611 x Lambda(0.001)), Vali MSE Loss: 0.1799 Test MSE Loss: 0.2114
Validation loss decreased (0.179942 --> 0.179876).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1387841
	speed: 0.0220s/iter; left time: 242.8203s
Epoch: 12 cost time: 2.7336316108703613
Epoch: 12, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1321 + XiCon Loss:2.5511 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1291935
	speed: 0.0223s/iter; left time: 243.3037s
Epoch: 13 cost time: 2.715862512588501
Epoch: 13, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1320 + XiCon Loss:2.5581 x Lambda(0.001)), Vali MSE Loss: 0.1804 Test MSE Loss: 0.2117
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1318814
	speed: 0.0221s/iter; left time: 238.5147s
Epoch: 14 cost time: 2.7152531147003174
Epoch: 14, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1320 + XiCon Loss:2.5561 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1379248
	speed: 0.0215s/iter; left time: 229.2864s
Epoch: 15 cost time: 2.636836290359497
Epoch: 15, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5621 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1399503
	speed: 0.0235s/iter; left time: 247.6272s
Epoch: 16 cost time: 2.8276829719543457
Epoch: 16, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5599 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1297215
	speed: 0.0225s/iter; left time: 234.2756s
Epoch: 17 cost time: 2.740374803543091
Epoch: 17, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1320 + XiCon Loss:2.5641 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1304283
	speed: 0.0218s/iter; left time: 223.8702s
Epoch: 18 cost time: 2.6732332706451416
Epoch: 18, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1320 + XiCon Loss:2.5617 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1308730
	speed: 0.0214s/iter; left time: 217.3715s
Epoch: 19 cost time: 2.622143030166626
Epoch: 19, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.5637 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1366135
	speed: 0.0226s/iter; left time: 226.5559s
Epoch: 20 cost time: 2.8054251670837402
Epoch: 20, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5559 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1430159
	speed: 0.0225s/iter; left time: 222.8753s
Epoch: 21 cost time: 2.7481415271759033
Epoch: 21, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1320 + XiCon Loss:2.5512 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.17389751970767975, mae:0.24889890849590302, mape:0.5951973795890808, mspe:24.608861923217773 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.6060
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2371122
	speed: 0.0220s/iter; left time: 273.0966s
Epoch: 1 cost time: 2.7936248779296875
Epoch: 1, Steps: 125 Train Loss: 0.3436 (Forecasting Loss:0.3410 + XiCon Loss:2.6218 x Lambda(0.001)), Vali MSE Loss: 0.2649 Test MSE Loss: 0.3614
Validation loss decreased (inf --> 0.264936).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1586841
	speed: 0.0265s/iter; left time: 325.3147s
Epoch: 2 cost time: 3.1892659664154053
Epoch: 2, Steps: 125 Train Loss: 0.1831 (Forecasting Loss:0.1804 + XiCon Loss:2.6694 x Lambda(0.001)), Vali MSE Loss: 0.1748 Test MSE Loss: 0.2428
Validation loss decreased (0.264936 --> 0.174755).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1469672
	speed: 0.0233s/iter; left time: 283.5723s
Epoch: 3 cost time: 2.8074419498443604
Epoch: 3, Steps: 125 Train Loss: 0.1507 (Forecasting Loss:0.1482 + XiCon Loss:2.5912 x Lambda(0.001)), Vali MSE Loss: 0.1643 Test MSE Loss: 0.2149
Validation loss decreased (0.174755 --> 0.164252).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1315618
	speed: 0.0226s/iter; left time: 271.3281s
Epoch: 4 cost time: 2.7856087684631348
Epoch: 4, Steps: 125 Train Loss: 0.1428 (Forecasting Loss:0.1402 + XiCon Loss:2.5701 x Lambda(0.001)), Vali MSE Loss: 0.1563 Test MSE Loss: 0.2132
Validation loss decreased (0.164252 --> 0.156286).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1413631
	speed: 0.0224s/iter; left time: 266.2073s
Epoch: 5 cost time: 2.710092306137085
Epoch: 5, Steps: 125 Train Loss: 0.1390 (Forecasting Loss:0.1364 + XiCon Loss:2.5684 x Lambda(0.001)), Vali MSE Loss: 0.1556 Test MSE Loss: 0.2068
Validation loss decreased (0.156286 --> 0.155635).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1402873
	speed: 0.0250s/iter; left time: 293.8645s
Epoch: 6 cost time: 3.103473424911499
Epoch: 6, Steps: 125 Train Loss: 0.1373 (Forecasting Loss:0.1347 + XiCon Loss:2.5660 x Lambda(0.001)), Vali MSE Loss: 0.1530 Test MSE Loss: 0.2035
Validation loss decreased (0.155635 --> 0.153044).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1249238
	speed: 0.0532s/iter; left time: 619.3021s
Epoch: 7 cost time: 6.9165565967559814
Epoch: 7, Steps: 125 Train Loss: 0.1363 (Forecasting Loss:0.1337 + XiCon Loss:2.5632 x Lambda(0.001)), Vali MSE Loss: 0.1518 Test MSE Loss: 0.2032
Validation loss decreased (0.153044 --> 0.151785).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1297830
	speed: 0.0296s/iter; left time: 340.8277s
Epoch: 8 cost time: 3.494065523147583
Epoch: 8, Steps: 125 Train Loss: 0.1356 (Forecasting Loss:0.1331 + XiCon Loss:2.5625 x Lambda(0.001)), Vali MSE Loss: 0.1515 Test MSE Loss: 0.2049
Validation loss decreased (0.151785 --> 0.151505).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1318334
	speed: 0.0205s/iter; left time: 233.9157s
Epoch: 9 cost time: 2.5162527561187744
Epoch: 9, Steps: 125 Train Loss: 0.1354 (Forecasting Loss:0.1329 + XiCon Loss:2.5589 x Lambda(0.001)), Vali MSE Loss: 0.1520 Test MSE Loss: 0.2034
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1378350
	speed: 0.0191s/iter; left time: 215.2248s
Epoch: 10 cost time: 2.334958076477051
Epoch: 10, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1327 + XiCon Loss:2.5591 x Lambda(0.001)), Vali MSE Loss: 0.1505 Test MSE Loss: 0.2046
Validation loss decreased (0.151505 --> 0.150526).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1329231
	speed: 0.0243s/iter; left time: 270.5138s
Epoch: 11 cost time: 2.9389355182647705
Epoch: 11, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5682 x Lambda(0.001)), Vali MSE Loss: 0.1507 Test MSE Loss: 0.2044
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1318311
	speed: 0.0230s/iter; left time: 253.6419s
Epoch: 12 cost time: 2.8695998191833496
Epoch: 12, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5631 x Lambda(0.001)), Vali MSE Loss: 0.1502 Test MSE Loss: 0.2046
Validation loss decreased (0.150526 --> 0.150179).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1321222
	speed: 0.0228s/iter; left time: 248.2770s
Epoch: 13 cost time: 2.7979886531829834
Epoch: 13, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5560 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
Validation loss decreased (0.150179 --> 0.150121).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1328650
	speed: 0.0254s/iter; left time: 274.0092s
Epoch: 14 cost time: 3.194678544998169
Epoch: 14, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5639 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
Validation loss decreased (0.150121 --> 0.150070).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1346458
	speed: 0.0232s/iter; left time: 246.8535s
Epoch: 15 cost time: 2.836554765701294
Epoch: 15, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5673 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1300577
	speed: 0.0227s/iter; left time: 238.9064s
Epoch: 16 cost time: 2.8023836612701416
Epoch: 16, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5742 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1293949
	speed: 0.0228s/iter; left time: 237.0452s
Epoch: 17 cost time: 2.7637722492218018
Epoch: 17, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5642 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1372559
	speed: 0.0253s/iter; left time: 260.0534s
Epoch: 18 cost time: 3.0909934043884277
Epoch: 18, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5687 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2049
Validation loss decreased (0.150070 --> 0.150029).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1300570
	speed: 0.0232s/iter; left time: 235.4580s
Epoch: 19 cost time: 2.8303511142730713
Epoch: 19, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5655 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1380743
	speed: 0.0226s/iter; left time: 226.7271s
Epoch: 20 cost time: 2.8073601722717285
Epoch: 20, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5645 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1406822
	speed: 0.0221s/iter; left time: 218.6251s
Epoch: 21 cost time: 2.7034690380096436
Epoch: 21, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5644 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1302372
	speed: 0.0217s/iter; left time: 211.9052s
Epoch: 22 cost time: 2.807487726211548
Epoch: 22, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5643 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1316621
	speed: 0.0226s/iter; left time: 218.4510s
Epoch: 23 cost time: 2.742243766784668
Epoch: 23, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5590 x Lambda(0.001)), Vali MSE Loss: 0.1502 Test MSE Loss: 0.2048
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1290768
	speed: 0.0220s/iter; left time: 209.7207s
Epoch: 24 cost time: 2.6711649894714355
Epoch: 24, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5643 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1355128
	speed: 0.0230s/iter; left time: 216.6680s
Epoch: 25 cost time: 2.797653913497925
Epoch: 25, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5584 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1321802
	speed: 0.0218s/iter; left time: 201.7559s
Epoch: 26 cost time: 2.641113519668579
Epoch: 26, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5630 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2048
Validation loss decreased (0.150029 --> 0.150025).  Saving model ...
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1337280
	speed: 0.0256s/iter; left time: 234.5546s
Epoch: 27 cost time: 3.235360622406006
Epoch: 27, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5612 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2048
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1368522
	speed: 0.0218s/iter; left time: 197.0627s
Epoch: 28 cost time: 2.715632677078247
Epoch: 28, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5548 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1393524
	speed: 0.0216s/iter; left time: 192.5867s
Epoch: 29 cost time: 2.6328141689300537
Epoch: 29, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5587 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1421365
	speed: 0.0233s/iter; left time: 204.7688s
Epoch: 30 cost time: 2.7971746921539307
Epoch: 30, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5650 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.1481161
	speed: 0.0219s/iter; left time: 189.1813s
Epoch: 31 cost time: 2.671381711959839
Epoch: 31, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5666 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2048
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.1362678
	speed: 0.0252s/iter; left time: 214.6518s
Epoch: 32 cost time: 3.0445995330810547
Epoch: 32, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5599 x Lambda(0.001)), Vali MSE Loss: 0.1502 Test MSE Loss: 0.2048
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.1383210
	speed: 0.0213s/iter; left time: 179.2445s
Epoch: 33 cost time: 2.619302272796631
Epoch: 33, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5609 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.1428722
	speed: 0.0216s/iter; left time: 178.5702s
Epoch: 34 cost time: 2.6491363048553467
Epoch: 34, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5667 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.820766091346741e-13
	iters: 100, epoch: 35 | loss: 0.1310794
	speed: 0.0233s/iter; left time: 189.6114s
Epoch: 35 cost time: 2.8293464183807373
Epoch: 35, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5597 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.9103830456733704e-13
	iters: 100, epoch: 36 | loss: 0.1359035
	speed: 0.0223s/iter; left time: 179.3419s
Epoch: 36 cost time: 2.721356153488159
Epoch: 36, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5638 x Lambda(0.001)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2048
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16569648683071136, mae:0.24400123953819275, mape:0.606308102607727, mspe:31.962238311767578 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.6205
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2394971
	speed: 0.0224s/iter; left time: 277.8878s
Epoch: 1 cost time: 2.7291815280914307
Epoch: 1, Steps: 125 Train Loss: 0.3427 (Forecasting Loss:0.3401 + XiCon Loss:2.6495 x Lambda(0.001)), Vali MSE Loss: 0.2615 Test MSE Loss: 0.3602
Validation loss decreased (inf --> 0.261461).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1648345
	speed: 0.0231s/iter; left time: 283.9143s
Epoch: 2 cost time: 2.8972244262695312
Epoch: 2, Steps: 125 Train Loss: 0.1816 (Forecasting Loss:0.1789 + XiCon Loss:2.6616 x Lambda(0.001)), Vali MSE Loss: 0.1884 Test MSE Loss: 0.2312
Validation loss decreased (0.261461 --> 0.188445).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1510108
	speed: 0.0266s/iter; left time: 323.8022s
Epoch: 3 cost time: 3.234605312347412
Epoch: 3, Steps: 125 Train Loss: 0.1509 (Forecasting Loss:0.1483 + XiCon Loss:2.6074 x Lambda(0.001)), Vali MSE Loss: 0.1579 Test MSE Loss: 0.2271
Validation loss decreased (0.188445 --> 0.157946).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1422023
	speed: 0.0257s/iter; left time: 308.7840s
Epoch: 4 cost time: 3.1854031085968018
Epoch: 4, Steps: 125 Train Loss: 0.1429 (Forecasting Loss:0.1403 + XiCon Loss:2.5921 x Lambda(0.001)), Vali MSE Loss: 0.1498 Test MSE Loss: 0.2118
Validation loss decreased (0.157946 --> 0.149802).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1341668
	speed: 0.0252s/iter; left time: 300.0342s
Epoch: 5 cost time: 3.086780071258545
Epoch: 5, Steps: 125 Train Loss: 0.1390 (Forecasting Loss:0.1364 + XiCon Loss:2.5828 x Lambda(0.001)), Vali MSE Loss: 0.1457 Test MSE Loss: 0.2123
Validation loss decreased (0.149802 --> 0.145661).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1425426
	speed: 0.0261s/iter; left time: 307.1295s
Epoch: 6 cost time: 3.15940260887146
Epoch: 6, Steps: 125 Train Loss: 0.1371 (Forecasting Loss:0.1346 + XiCon Loss:2.5723 x Lambda(0.001)), Vali MSE Loss: 0.1460 Test MSE Loss: 0.2100
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1286724
	speed: 0.0269s/iter; left time: 313.6134s
Epoch: 7 cost time: 3.244823455810547
Epoch: 7, Steps: 125 Train Loss: 0.1361 (Forecasting Loss:0.1335 + XiCon Loss:2.5674 x Lambda(0.001)), Vali MSE Loss: 0.1449 Test MSE Loss: 0.2050
Validation loss decreased (0.145661 --> 0.144910).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1333787
	speed: 0.0259s/iter; left time: 298.2295s
Epoch: 8 cost time: 3.2096378803253174
Epoch: 8, Steps: 125 Train Loss: 0.1357 (Forecasting Loss:0.1331 + XiCon Loss:2.5763 x Lambda(0.001)), Vali MSE Loss: 0.1444 Test MSE Loss: 0.2074
Validation loss decreased (0.144910 --> 0.144436).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1403832
	speed: 0.0251s/iter; left time: 286.7273s
Epoch: 9 cost time: 3.0937681198120117
Epoch: 9, Steps: 125 Train Loss: 0.1353 (Forecasting Loss:0.1328 + XiCon Loss:2.5771 x Lambda(0.001)), Vali MSE Loss: 0.1436 Test MSE Loss: 0.2064
Validation loss decreased (0.144436 --> 0.143624).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1316451
	speed: 0.0255s/iter; left time: 287.2180s
Epoch: 10 cost time: 3.136500835418701
Epoch: 10, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1327 + XiCon Loss:2.5701 x Lambda(0.001)), Vali MSE Loss: 0.1438 Test MSE Loss: 0.2068
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1375813
	speed: 0.0284s/iter; left time: 317.1866s
Epoch: 11 cost time: 3.453528642654419
Epoch: 11, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1326 + XiCon Loss:2.5772 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2067
Validation loss decreased (0.143624 --> 0.143404).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1399811
	speed: 0.0268s/iter; left time: 295.9750s
Epoch: 12 cost time: 3.266497850418091
Epoch: 12, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5702 x Lambda(0.001)), Vali MSE Loss: 0.1435 Test MSE Loss: 0.2066
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1357173
	speed: 0.0263s/iter; left time: 286.3306s
Epoch: 13 cost time: 3.238412380218506
Epoch: 13, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5757 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2067
Validation loss decreased (0.143404 --> 0.143358).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1349571
	speed: 0.0254s/iter; left time: 273.2435s
Epoch: 14 cost time: 3.134589910507202
Epoch: 14, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5782 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1361480
	speed: 0.0291s/iter; left time: 310.1444s
Epoch: 15 cost time: 3.517102003097534
Epoch: 15, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5796 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2067
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1323447
	speed: 0.0261s/iter; left time: 274.3006s
Epoch: 16 cost time: 3.176706552505493
Epoch: 16, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5794 x Lambda(0.001)), Vali MSE Loss: 0.1433 Test MSE Loss: 0.2068
Validation loss decreased (0.143358 --> 0.143348).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1431105
	speed: 0.0256s/iter; left time: 266.5560s
Epoch: 17 cost time: 3.146517515182495
Epoch: 17, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5773 x Lambda(0.001)), Vali MSE Loss: 0.1433 Test MSE Loss: 0.2068
Validation loss decreased (0.143348 --> 0.143328).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1416438
	speed: 0.0259s/iter; left time: 266.3740s
Epoch: 18 cost time: 3.1851449012756348
Epoch: 18, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5773 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1407253
	speed: 0.0272s/iter; left time: 276.2365s
Epoch: 19 cost time: 3.456361770629883
Epoch: 19, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5754 x Lambda(0.001)), Vali MSE Loss: 0.1433 Test MSE Loss: 0.2068
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1398379
	speed: 0.0257s/iter; left time: 257.9422s
Epoch: 20 cost time: 3.1713976860046387
Epoch: 20, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5763 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1349055
	speed: 0.0249s/iter; left time: 246.5347s
Epoch: 21 cost time: 3.066169023513794
Epoch: 21, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5765 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1404448
	speed: 0.0259s/iter; left time: 253.0694s
Epoch: 22 cost time: 3.1466586589813232
Epoch: 22, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5693 x Lambda(0.001)), Vali MSE Loss: 0.1433 Test MSE Loss: 0.2068
Validation loss decreased (0.143328 --> 0.143328).  Saving model ...
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1323898
	speed: 0.0271s/iter; left time: 261.6433s
Epoch: 23 cost time: 3.355614423751831
Epoch: 23, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5802 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1367566
	speed: 0.0259s/iter; left time: 246.7128s
Epoch: 24 cost time: 3.1623873710632324
Epoch: 24, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5818 x Lambda(0.001)), Vali MSE Loss: 0.1433 Test MSE Loss: 0.2068
Validation loss decreased (0.143328 --> 0.143302).  Saving model ...
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1365932
	speed: 0.0260s/iter; left time: 244.7754s
Epoch: 25 cost time: 3.17272686958313
Epoch: 25, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1324 + XiCon Loss:2.5743 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1337717
	speed: 0.0267s/iter; left time: 247.3484s
Epoch: 26 cost time: 3.2269744873046875
Epoch: 26, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5792 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1312991
	speed: 0.0258s/iter; left time: 236.3622s
Epoch: 27 cost time: 3.2831952571868896
Epoch: 27, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5752 x Lambda(0.001)), Vali MSE Loss: 0.1433 Test MSE Loss: 0.2068
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1326842
	speed: 0.0258s/iter; left time: 232.9958s
Epoch: 28 cost time: 3.1827213764190674
Epoch: 28, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5773 x Lambda(0.001)), Vali MSE Loss: 0.1433 Test MSE Loss: 0.2068
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1264112
	speed: 0.0256s/iter; left time: 227.4604s
Epoch: 29 cost time: 3.180267572402954
Epoch: 29, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5726 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1368668
	speed: 0.0258s/iter; left time: 226.2003s
Epoch: 30 cost time: 3.147848129272461
Epoch: 30, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5720 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.1297627
	speed: 0.0252s/iter; left time: 217.9305s
Epoch: 31 cost time: 3.1518619060516357
Epoch: 31, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5763 x Lambda(0.001)), Vali MSE Loss: 0.1433 Test MSE Loss: 0.2068
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.1354112
	speed: 0.0265s/iter; left time: 226.0717s
Epoch: 32 cost time: 3.228872776031494
Epoch: 32, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5794 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.1281631
	speed: 0.0259s/iter; left time: 217.4925s
Epoch: 33 cost time: 3.2446937561035156
Epoch: 33, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5778 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.1461253
	speed: 0.0267s/iter; left time: 220.9593s
Epoch: 34 cost time: 3.400057077407837
Epoch: 34, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.5779 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2068
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16686037182807922, mae:0.24666394293308258, mape:0.6034489870071411, mspe:28.62337875366211 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0442
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2348068
	speed: 0.0278s/iter; left time: 344.4302s
Epoch: 1 cost time: 3.2947850227355957
Epoch: 1, Steps: 125 Train Loss: 0.3460 (Forecasting Loss:0.3434 + XiCon Loss:2.6319 x Lambda(0.001)), Vali MSE Loss: 0.2622 Test MSE Loss: 0.3583
Validation loss decreased (inf --> 0.262227).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1751792
	speed: 0.0244s/iter; left time: 299.8277s
Epoch: 2 cost time: 2.9975826740264893
Epoch: 2, Steps: 125 Train Loss: 0.1819 (Forecasting Loss:0.1793 + XiCon Loss:2.6724 x Lambda(0.001)), Vali MSE Loss: 0.1764 Test MSE Loss: 0.2370
Validation loss decreased (0.262227 --> 0.176394).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1525782
	speed: 0.0242s/iter; left time: 293.8811s
Epoch: 3 cost time: 2.9396450519561768
Epoch: 3, Steps: 125 Train Loss: 0.1491 (Forecasting Loss:0.1464 + XiCon Loss:2.6371 x Lambda(0.001)), Vali MSE Loss: 0.1666 Test MSE Loss: 0.2133
Validation loss decreased (0.176394 --> 0.166567).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1276049
	speed: 0.0281s/iter; left time: 338.3848s
Epoch: 4 cost time: 3.3347272872924805
Epoch: 4, Steps: 125 Train Loss: 0.1415 (Forecasting Loss:0.1389 + XiCon Loss:2.6250 x Lambda(0.001)), Vali MSE Loss: 0.1576 Test MSE Loss: 0.2122
Validation loss decreased (0.166567 --> 0.157634).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1320727
	speed: 0.0245s/iter; left time: 292.0568s
Epoch: 5 cost time: 2.990605354309082
Epoch: 5, Steps: 125 Train Loss: 0.1378 (Forecasting Loss:0.1352 + XiCon Loss:2.6136 x Lambda(0.001)), Vali MSE Loss: 0.1578 Test MSE Loss: 0.2081
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1343904
	speed: 0.0244s/iter; left time: 286.7757s
Epoch: 6 cost time: 2.999338388442993
Epoch: 6, Steps: 125 Train Loss: 0.1361 (Forecasting Loss:0.1335 + XiCon Loss:2.6161 x Lambda(0.001)), Vali MSE Loss: 0.1536 Test MSE Loss: 0.2058
Validation loss decreased (0.157634 --> 0.153574).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1356044
	speed: 0.0291s/iter; left time: 339.1489s
Epoch: 7 cost time: 3.4988715648651123
Epoch: 7, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1324 + XiCon Loss:2.6139 x Lambda(0.001)), Vali MSE Loss: 0.1533 Test MSE Loss: 0.2060
Validation loss decreased (0.153574 --> 0.153262).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1306306
	speed: 0.0245s/iter; left time: 281.9508s
Epoch: 8 cost time: 2.964974880218506
Epoch: 8, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1321 + XiCon Loss:2.6156 x Lambda(0.001)), Vali MSE Loss: 0.1540 Test MSE Loss: 0.2018
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1387064
	speed: 0.0250s/iter; left time: 284.6132s
Epoch: 9 cost time: 3.0545835494995117
Epoch: 9, Steps: 125 Train Loss: 0.1344 (Forecasting Loss:0.1317 + XiCon Loss:2.6142 x Lambda(0.001)), Vali MSE Loss: 0.1538 Test MSE Loss: 0.2022
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1461644
	speed: 0.0238s/iter; left time: 268.7320s
Epoch: 10 cost time: 2.9122021198272705
Epoch: 10, Steps: 125 Train Loss: 0.1342 (Forecasting Loss:0.1315 + XiCon Loss:2.6146 x Lambda(0.001)), Vali MSE Loss: 0.1527 Test MSE Loss: 0.2024
Validation loss decreased (0.153262 --> 0.152662).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1444554
	speed: 0.0248s/iter; left time: 276.2139s
Epoch: 11 cost time: 3.1078741550445557
Epoch: 11, Steps: 125 Train Loss: 0.1341 (Forecasting Loss:0.1315 + XiCon Loss:2.6164 x Lambda(0.001)), Vali MSE Loss: 0.1526 Test MSE Loss: 0.2030
Validation loss decreased (0.152662 --> 0.152557).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1292929
	speed: 0.0264s/iter; left time: 290.6286s
Epoch: 12 cost time: 3.163300037384033
Epoch: 12, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1314 + XiCon Loss:2.6193 x Lambda(0.001)), Vali MSE Loss: 0.1530 Test MSE Loss: 0.2027
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1278519
	speed: 0.0267s/iter; left time: 290.7980s
Epoch: 13 cost time: 3.1981964111328125
Epoch: 13, Steps: 125 Train Loss: 0.1341 (Forecasting Loss:0.1315 + XiCon Loss:2.6150 x Lambda(0.001)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2028
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1263534
	speed: 0.0228s/iter; left time: 245.7316s
Epoch: 14 cost time: 3.400243043899536
Epoch: 14, Steps: 125 Train Loss: 0.1341 (Forecasting Loss:0.1314 + XiCon Loss:2.6174 x Lambda(0.001)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2028
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1294193
	speed: 0.0250s/iter; left time: 266.5338s
Epoch: 15 cost time: 3.01131272315979
Epoch: 15, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1314 + XiCon Loss:2.6043 x Lambda(0.001)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2028
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1394295
	speed: 0.0242s/iter; left time: 254.4293s
Epoch: 16 cost time: 2.9167985916137695
Epoch: 16, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1314 + XiCon Loss:2.6145 x Lambda(0.001)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2028
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1431898
	speed: 0.0241s/iter; left time: 251.0274s
Epoch: 17 cost time: 2.9737181663513184
Epoch: 17, Steps: 125 Train Loss: 0.1341 (Forecasting Loss:0.1314 + XiCon Loss:2.6148 x Lambda(0.001)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2028
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1330851
	speed: 0.0247s/iter; left time: 253.5443s
Epoch: 18 cost time: 3.039602041244507
Epoch: 18, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1314 + XiCon Loss:2.6141 x Lambda(0.001)), Vali MSE Loss: 0.1527 Test MSE Loss: 0.2028
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1311982
	speed: 0.0266s/iter; left time: 269.9174s
Epoch: 19 cost time: 3.3119513988494873
Epoch: 19, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1314 + XiCon Loss:2.6125 x Lambda(0.001)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2028
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1370687
	speed: 0.0249s/iter; left time: 249.7268s
Epoch: 20 cost time: 3.11940598487854
Epoch: 20, Steps: 125 Train Loss: 0.1341 (Forecasting Loss:0.1315 + XiCon Loss:2.6090 x Lambda(0.001)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2028
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1438292
	speed: 0.0238s/iter; left time: 235.9598s
Epoch: 21 cost time: 2.989560842514038
Epoch: 21, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1314 + XiCon Loss:2.6139 x Lambda(0.001)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2028
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.1646304577589035, mae:0.24143315851688385, mape:0.5846485495567322, mspe:25.213781356811523 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.1046
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2443282
	speed: 0.0251s/iter; left time: 311.3602s
Epoch: 1 cost time: 3.0365028381347656
Epoch: 1, Steps: 125 Train Loss: 0.3505 (Forecasting Loss:0.3478 + XiCon Loss:2.6371 x Lambda(0.001)), Vali MSE Loss: 0.2710 Test MSE Loss: 0.3719
Validation loss decreased (inf --> 0.270974).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1651476
	speed: 0.0256s/iter; left time: 313.7326s
Epoch: 2 cost time: 3.1490275859832764
Epoch: 2, Steps: 125 Train Loss: 0.1827 (Forecasting Loss:0.1801 + XiCon Loss:2.6302 x Lambda(0.001)), Vali MSE Loss: 0.1815 Test MSE Loss: 0.2359
Validation loss decreased (0.270974 --> 0.181478).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1482475
	speed: 0.0259s/iter; left time: 314.6123s
Epoch: 3 cost time: 3.10971736907959
Epoch: 3, Steps: 125 Train Loss: 0.1502 (Forecasting Loss:0.1475 + XiCon Loss:2.6221 x Lambda(0.001)), Vali MSE Loss: 0.1727 Test MSE Loss: 0.2169
Validation loss decreased (0.181478 --> 0.172658).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1466406
	speed: 0.0251s/iter; left time: 302.0009s
Epoch: 4 cost time: 3.0433685779571533
Epoch: 4, Steps: 125 Train Loss: 0.1431 (Forecasting Loss:0.1405 + XiCon Loss:2.6101 x Lambda(0.001)), Vali MSE Loss: 0.1639 Test MSE Loss: 0.2123
Validation loss decreased (0.172658 --> 0.163944).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1263567
	speed: 0.0249s/iter; left time: 295.7878s
Epoch: 5 cost time: 3.017357587814331
Epoch: 5, Steps: 125 Train Loss: 0.1392 (Forecasting Loss:0.1366 + XiCon Loss:2.5945 x Lambda(0.001)), Vali MSE Loss: 0.1659 Test MSE Loss: 0.2000
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1300496
	speed: 0.0259s/iter; left time: 305.3629s
Epoch: 6 cost time: 3.140143394470215
Epoch: 6, Steps: 125 Train Loss: 0.1373 (Forecasting Loss:0.1347 + XiCon Loss:2.5905 x Lambda(0.001)), Vali MSE Loss: 0.1605 Test MSE Loss: 0.2044
Validation loss decreased (0.163944 --> 0.160495).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1386992
	speed: 0.0283s/iter; left time: 329.8846s
Epoch: 7 cost time: 3.3615520000457764
Epoch: 7, Steps: 125 Train Loss: 0.1363 (Forecasting Loss:0.1337 + XiCon Loss:2.5903 x Lambda(0.001)), Vali MSE Loss: 0.1610 Test MSE Loss: 0.2076
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1349881
	speed: 0.0241s/iter; left time: 277.4052s
Epoch: 8 cost time: 2.9526689052581787
Epoch: 8, Steps: 125 Train Loss: 0.1358 (Forecasting Loss:0.1332 + XiCon Loss:2.5877 x Lambda(0.001)), Vali MSE Loss: 0.1610 Test MSE Loss: 0.2040
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1323658
	speed: 0.0251s/iter; left time: 286.6741s
Epoch: 9 cost time: 3.0859804153442383
Epoch: 9, Steps: 125 Train Loss: 0.1355 (Forecasting Loss:0.1329 + XiCon Loss:2.5931 x Lambda(0.001)), Vali MSE Loss: 0.1586 Test MSE Loss: 0.2045
Validation loss decreased (0.160495 --> 0.158637).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1379091
	speed: 0.0283s/iter; left time: 319.0552s
Epoch: 10 cost time: 3.4130125045776367
Epoch: 10, Steps: 125 Train Loss: 0.1353 (Forecasting Loss:0.1327 + XiCon Loss:2.5933 x Lambda(0.001)), Vali MSE Loss: 0.1601 Test MSE Loss: 0.2033
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1338562
	speed: 0.0257s/iter; left time: 286.3551s
Epoch: 11 cost time: 3.0757744312286377
Epoch: 11, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1327 + XiCon Loss:2.5851 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2038
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1293250
	speed: 0.0240s/iter; left time: 265.0393s
Epoch: 12 cost time: 2.9200539588928223
Epoch: 12, Steps: 125 Train Loss: 0.1353 (Forecasting Loss:0.1327 + XiCon Loss:2.5861 x Lambda(0.001)), Vali MSE Loss: 0.1597 Test MSE Loss: 0.2037
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1383447
	speed: 0.0243s/iter; left time: 265.1430s
Epoch: 13 cost time: 2.968123435974121
Epoch: 13, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1326 + XiCon Loss:2.5877 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2037
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1507922
	speed: 0.0244s/iter; left time: 262.5345s
Epoch: 14 cost time: 2.992919683456421
Epoch: 14, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1326 + XiCon Loss:2.5818 x Lambda(0.001)), Vali MSE Loss: 0.1601 Test MSE Loss: 0.2035
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1428608
	speed: 0.0250s/iter; left time: 266.1774s
Epoch: 15 cost time: 3.013845682144165
Epoch: 15, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1326 + XiCon Loss:2.5852 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2035
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1430687
	speed: 0.0251s/iter; left time: 264.1377s
Epoch: 16 cost time: 3.0395102500915527
Epoch: 16, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1326 + XiCon Loss:2.5803 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2035
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1341137
	speed: 0.0247s/iter; left time: 257.0027s
Epoch: 17 cost time: 3.0060622692108154
Epoch: 17, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1325 + XiCon Loss:2.5824 x Lambda(0.001)), Vali MSE Loss: 0.1599 Test MSE Loss: 0.2035
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1368377
	speed: 0.0300s/iter; left time: 308.5694s
Epoch: 18 cost time: 3.4505157470703125
Epoch: 18, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1326 + XiCon Loss:2.5892 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2035
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1376611
	speed: 0.0240s/iter; left time: 243.7048s
Epoch: 19 cost time: 2.9191653728485107
Epoch: 19, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1326 + XiCon Loss:2.5942 x Lambda(0.001)), Vali MSE Loss: 0.1599 Test MSE Loss: 0.2035
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.1669689118862152, mae:0.2420656681060791, mape:0.5908357501029968, mspe:29.035083770751953 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1676+-0.00452, MAE:0.2446+-0.00390, MAPE:0.5961+-0.01107, MSPE:27.8887+-3.74358, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
