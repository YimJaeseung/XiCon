Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.0001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.01, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8946
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2226714
	speed: 0.0207s/iter; left time: 323.5615s
Epoch: 1 cost time: 2.900566339492798
Epoch: 1, Steps: 157 Train Loss: 0.3032 (Forecasting Loss:0.3029 + XiCon Loss:2.5208 x Lambda(0.0001)), Vali MSE Loss: 0.2370 Test MSE Loss: 0.3368
Validation loss decreased (inf --> 0.236992).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1321419
	speed: 0.0170s/iter; left time: 263.0768s
Epoch: 2 cost time: 2.521294116973877
Epoch: 2, Steps: 157 Train Loss: 0.1432 (Forecasting Loss:0.1429 + XiCon Loss:2.5318 x Lambda(0.0001)), Vali MSE Loss: 0.1458 Test MSE Loss: 0.1997
Validation loss decreased (0.236992 --> 0.145778).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1101661
	speed: 0.0169s/iter; left time: 258.8052s
Epoch: 3 cost time: 2.4744956493377686
Epoch: 3, Steps: 157 Train Loss: 0.1128 (Forecasting Loss:0.1126 + XiCon Loss:2.5285 x Lambda(0.0001)), Vali MSE Loss: 0.1328 Test MSE Loss: 0.1875
Validation loss decreased (0.145778 --> 0.132799).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1221783
	speed: 0.0186s/iter; left time: 282.1117s
Epoch: 4 cost time: 2.7665598392486572
Epoch: 4, Steps: 157 Train Loss: 0.1052 (Forecasting Loss:0.1049 + XiCon Loss:2.5310 x Lambda(0.0001)), Vali MSE Loss: 0.1264 Test MSE Loss: 0.1783
Validation loss decreased (0.132799 --> 0.126369).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0999064
	speed: 0.0155s/iter; left time: 232.1379s
Epoch: 5 cost time: 2.3864216804504395
Epoch: 5, Steps: 157 Train Loss: 0.1014 (Forecasting Loss:0.1012 + XiCon Loss:2.5454 x Lambda(0.0001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1745
Validation loss decreased (0.126369 --> 0.123244).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0843030
	speed: 0.0165s/iter; left time: 244.8253s
Epoch: 6 cost time: 2.4361448287963867
Epoch: 6, Steps: 157 Train Loss: 0.0996 (Forecasting Loss:0.0994 + XiCon Loss:2.5540 x Lambda(0.0001)), Vali MSE Loss: 0.1217 Test MSE Loss: 0.1725
Validation loss decreased (0.123244 --> 0.121740).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0932329
	speed: 0.0175s/iter; left time: 257.1780s
Epoch: 7 cost time: 2.628408432006836
Epoch: 7, Steps: 157 Train Loss: 0.0985 (Forecasting Loss:0.0983 + XiCon Loss:2.5606 x Lambda(0.0001)), Vali MSE Loss: 0.1213 Test MSE Loss: 0.1716
Validation loss decreased (0.121740 --> 0.121336).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.0937766
	speed: 0.0167s/iter; left time: 242.0860s
Epoch: 8 cost time: 2.44441294670105
Epoch: 8, Steps: 157 Train Loss: 0.0980 (Forecasting Loss:0.0978 + XiCon Loss:2.5582 x Lambda(0.0001)), Vali MSE Loss: 0.1216 Test MSE Loss: 0.1714
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0973366
	speed: 0.0189s/iter; left time: 271.8228s
Epoch: 9 cost time: 2.6952731609344482
Epoch: 9, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0976 + XiCon Loss:2.5635 x Lambda(0.0001)), Vali MSE Loss: 0.1206 Test MSE Loss: 0.1702
Validation loss decreased (0.121336 --> 0.120550).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0977262
	speed: 0.0166s/iter; left time: 235.3262s
Epoch: 10 cost time: 2.5345048904418945
Epoch: 10, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5626 x Lambda(0.0001)), Vali MSE Loss: 0.1212 Test MSE Loss: 0.1702
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0979028
	speed: 0.0165s/iter; left time: 231.2279s
Epoch: 11 cost time: 2.4439656734466553
Epoch: 11, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5634 x Lambda(0.0001)), Vali MSE Loss: 0.1209 Test MSE Loss: 0.1701
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1021033
	speed: 0.0175s/iter; left time: 243.0505s
Epoch: 12 cost time: 2.6963040828704834
Epoch: 12, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0973 + XiCon Loss:2.5611 x Lambda(0.0001)), Vali MSE Loss: 0.1209 Test MSE Loss: 0.1700
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0978795
	speed: 0.0176s/iter; left time: 241.4684s
Epoch: 13 cost time: 2.609841823577881
Epoch: 13, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0973 + XiCon Loss:2.5677 x Lambda(0.0001)), Vali MSE Loss: 0.1210 Test MSE Loss: 0.1700
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1178198
	speed: 0.0176s/iter; left time: 239.3273s
Epoch: 14 cost time: 2.5918807983398438
Epoch: 14, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5602 x Lambda(0.0001)), Vali MSE Loss: 0.1210 Test MSE Loss: 0.1700
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1051920
	speed: 0.0169s/iter; left time: 226.1176s
Epoch: 15 cost time: 2.498530387878418
Epoch: 15, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0973 + XiCon Loss:2.5662 x Lambda(0.0001)), Vali MSE Loss: 0.1210 Test MSE Loss: 0.1699
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1006774
	speed: 0.0184s/iter; left time: 243.2334s
Epoch: 16 cost time: 2.7055764198303223
Epoch: 16, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0973 + XiCon Loss:2.5623 x Lambda(0.0001)), Vali MSE Loss: 0.1210 Test MSE Loss: 0.1699
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0940962
	speed: 0.0161s/iter; left time: 210.9489s
Epoch: 17 cost time: 2.3966848850250244
Epoch: 17, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0973 + XiCon Loss:2.5652 x Lambda(0.0001)), Vali MSE Loss: 0.1210 Test MSE Loss: 0.1700
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1090941
	speed: 0.0171s/iter; left time: 221.4000s
Epoch: 18 cost time: 2.5080385208129883
Epoch: 18, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0972 + XiCon Loss:2.5680 x Lambda(0.0001)), Vali MSE Loss: 0.1210 Test MSE Loss: 0.1700
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0875371
	speed: 0.0171s/iter; left time: 217.8269s
Epoch: 19 cost time: 2.585193395614624
Epoch: 19, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5687 x Lambda(0.0001)), Vali MSE Loss: 0.1208 Test MSE Loss: 0.1700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.13234730064868927, mae:0.20809601247310638, mape:0.4854985773563385, mspe:12.454615592956543 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9223
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2256684
	speed: 0.0180s/iter; left time: 280.0679s
Epoch: 1 cost time: 2.615189790725708
Epoch: 1, Steps: 157 Train Loss: 0.2948 (Forecasting Loss:0.2946 + XiCon Loss:2.5118 x Lambda(0.0001)), Vali MSE Loss: 0.2281 Test MSE Loss: 0.3268
Validation loss decreased (inf --> 0.228137).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1402542
	speed: 0.0164s/iter; left time: 252.6095s
Epoch: 2 cost time: 2.5939362049102783
Epoch: 2, Steps: 157 Train Loss: 0.1422 (Forecasting Loss:0.1420 + XiCon Loss:2.5516 x Lambda(0.0001)), Vali MSE Loss: 0.1406 Test MSE Loss: 0.2007
Validation loss decreased (0.228137 --> 0.140640).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1194883
	speed: 0.0172s/iter; left time: 263.6027s
Epoch: 3 cost time: 2.5360612869262695
Epoch: 3, Steps: 157 Train Loss: 0.1112 (Forecasting Loss:0.1110 + XiCon Loss:2.5468 x Lambda(0.0001)), Vali MSE Loss: 0.1236 Test MSE Loss: 0.1783
Validation loss decreased (0.140640 --> 0.123563).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.0878694
	speed: 0.0172s/iter; left time: 259.6939s
Epoch: 4 cost time: 2.5445475578308105
Epoch: 4, Steps: 157 Train Loss: 0.1041 (Forecasting Loss:0.1039 + XiCon Loss:2.5385 x Lambda(0.0001)), Vali MSE Loss: 0.1188 Test MSE Loss: 0.1718
Validation loss decreased (0.123563 --> 0.118769).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0865772
	speed: 0.0158s/iter; left time: 236.2360s
Epoch: 5 cost time: 2.378812551498413
Epoch: 5, Steps: 157 Train Loss: 0.1007 (Forecasting Loss:0.1004 + XiCon Loss:2.5526 x Lambda(0.0001)), Vali MSE Loss: 0.1156 Test MSE Loss: 0.1676
Validation loss decreased (0.118769 --> 0.115564).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0942226
	speed: 0.0171s/iter; left time: 253.9198s
Epoch: 6 cost time: 2.522737979888916
Epoch: 6, Steps: 157 Train Loss: 0.0989 (Forecasting Loss:0.0987 + XiCon Loss:2.5496 x Lambda(0.0001)), Vali MSE Loss: 0.1145 Test MSE Loss: 0.1654
Validation loss decreased (0.115564 --> 0.114545).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1099915
	speed: 0.0175s/iter; left time: 257.2047s
Epoch: 7 cost time: 2.643643856048584
Epoch: 7, Steps: 157 Train Loss: 0.0980 (Forecasting Loss:0.0978 + XiCon Loss:2.5502 x Lambda(0.0001)), Vali MSE Loss: 0.1139 Test MSE Loss: 0.1645
Validation loss decreased (0.114545 --> 0.113932).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1017445
	speed: 0.0170s/iter; left time: 245.9554s
Epoch: 8 cost time: 2.5126824378967285
Epoch: 8, Steps: 157 Train Loss: 0.0975 (Forecasting Loss:0.0973 + XiCon Loss:2.5422 x Lambda(0.0001)), Vali MSE Loss: 0.1136 Test MSE Loss: 0.1641
Validation loss decreased (0.113932 --> 0.113582).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1007782
	speed: 0.0164s/iter; left time: 234.6899s
Epoch: 9 cost time: 2.484755039215088
Epoch: 9, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0970 + XiCon Loss:2.5445 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1640
Validation loss decreased (0.113582 --> 0.113247).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0917394
	speed: 0.0162s/iter; left time: 229.6670s
Epoch: 10 cost time: 2.409700393676758
Epoch: 10, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0969 + XiCon Loss:2.5536 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1640
Validation loss decreased (0.113247 --> 0.113196).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0994852
	speed: 0.0164s/iter; left time: 229.9750s
Epoch: 11 cost time: 2.4346227645874023
Epoch: 11, Steps: 157 Train Loss: 0.0971 (Forecasting Loss:0.0969 + XiCon Loss:2.5479 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1639
Validation loss decreased (0.113196 --> 0.113189).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1064181
	speed: 0.0168s/iter; left time: 233.2307s
Epoch: 12 cost time: 2.486860752105713
Epoch: 12, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5546 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
Validation loss decreased (0.113189 --> 0.113095).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0969630
	speed: 0.0176s/iter; left time: 241.1897s
Epoch: 13 cost time: 2.629274606704712
Epoch: 13, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0968 + XiCon Loss:2.5491 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0923755
	speed: 0.0171s/iter; left time: 232.0052s
Epoch: 14 cost time: 2.6103012561798096
Epoch: 14, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5554 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
Validation loss decreased (0.113095 --> 0.112990).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.0930562
	speed: 0.0188s/iter; left time: 251.8333s
Epoch: 15 cost time: 2.701517343521118
Epoch: 15, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5497 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1032709
	speed: 0.0177s/iter; left time: 234.5580s
Epoch: 16 cost time: 2.570249557495117
Epoch: 16, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5514 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
Validation loss decreased (0.112990 --> 0.112938).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0952177
	speed: 0.0175s/iter; left time: 229.6366s
Epoch: 17 cost time: 2.6961987018585205
Epoch: 17, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5462 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
Validation loss decreased (0.112938 --> 0.112915).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1035694
	speed: 0.0175s/iter; left time: 225.7741s
Epoch: 18 cost time: 2.534482479095459
Epoch: 18, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0965 + XiCon Loss:2.5536 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1083109
	speed: 0.0198s/iter; left time: 252.6899s
Epoch: 19 cost time: 2.8353078365325928
Epoch: 19, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5483 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.0804090
	speed: 0.0162s/iter; left time: 204.0649s
Epoch: 20 cost time: 2.433483839035034
Epoch: 20, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5530 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1129676
	speed: 0.0179s/iter; left time: 222.8003s
Epoch: 21 cost time: 2.625098943710327
Epoch: 21, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5505 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.0946230
	speed: 0.0167s/iter; left time: 204.9588s
Epoch: 22 cost time: 2.5203492641448975
Epoch: 22, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5507 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1052123
	speed: 0.0175s/iter; left time: 212.0199s
Epoch: 23 cost time: 2.6091837882995605
Epoch: 23, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5503 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1018524
	speed: 0.0167s/iter; left time: 200.3184s
Epoch: 24 cost time: 2.4759442806243896
Epoch: 24, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5561 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.0899781
	speed: 0.0175s/iter; left time: 207.4115s
Epoch: 25 cost time: 2.6001522541046143
Epoch: 25, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5476 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
Validation loss decreased (0.112915 --> 0.112906).  Saving model ...
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.0987670
	speed: 0.0179s/iter; left time: 209.0608s
Epoch: 26 cost time: 2.6332383155822754
Epoch: 26, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5512 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1030546
	speed: 0.0172s/iter; left time: 197.8081s
Epoch: 27 cost time: 2.525362491607666
Epoch: 27, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5524 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
Validation loss decreased (0.112906 --> 0.112880).  Saving model ...
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.0889979
	speed: 0.0165s/iter; left time: 187.8334s
Epoch: 28 cost time: 2.502235174179077
Epoch: 28, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5520 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1050073
	speed: 0.0174s/iter; left time: 194.5142s
Epoch: 29 cost time: 2.564235210418701
Epoch: 29, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5509 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.0987021
	speed: 0.0161s/iter; left time: 177.7379s
Epoch: 30 cost time: 2.43704891204834
Epoch: 30, Steps: 157 Train Loss: 0.0968 (Forecasting Loss:0.0966 + XiCon Loss:2.5513 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1638
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.0937196
	speed: 0.0186s/iter; left time: 202.5985s
Epoch: 31 cost time: 2.7563247680664062
Epoch: 31, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5547 x Lambda(0.0001)), Vali MSE Loss: 0.1132 Test MSE Loss: 0.1638
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.0909503
	speed: 0.0179s/iter; left time: 191.9104s
Epoch: 32 cost time: 2.683358669281006
Epoch: 32, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0967 + XiCon Loss:2.5506 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.0990615
	speed: 0.0179s/iter; left time: 189.1725s
Epoch: 33 cost time: 2.616340160369873
Epoch: 33, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5491 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.0830162
	speed: 0.0163s/iter; left time: 170.2760s
Epoch: 34 cost time: 2.414417028427124
Epoch: 34, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5509 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.820766091346741e-13
	iters: 100, epoch: 35 | loss: 0.1081407
	speed: 0.0208s/iter; left time: 212.9941s
Epoch: 35 cost time: 2.9265060424804688
Epoch: 35, Steps: 157 Train Loss: 0.0970 (Forecasting Loss:0.0967 + XiCon Loss:2.5504 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.9103830456733704e-13
	iters: 100, epoch: 36 | loss: 0.1050979
	speed: 0.0175s/iter; left time: 176.5128s
Epoch: 36 cost time: 2.5917019844055176
Epoch: 36, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5537 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1638
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4551915228366852e-13
	iters: 100, epoch: 37 | loss: 0.1058341
	speed: 0.0165s/iter; left time: 164.5290s
Epoch: 37 cost time: 2.4140172004699707
Epoch: 37, Steps: 157 Train Loss: 0.0969 (Forecasting Loss:0.0966 + XiCon Loss:2.5557 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.1282586306333542, mae:0.19940347969532013, mape:0.444013386964798, mspe:7.991743087768555 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0207
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2274440
	speed: 0.0184s/iter; left time: 287.4817s
Epoch: 1 cost time: 2.7054574489593506
Epoch: 1, Steps: 157 Train Loss: 0.3187 (Forecasting Loss:0.3184 + XiCon Loss:2.5363 x Lambda(0.0001)), Vali MSE Loss: 0.2324 Test MSE Loss: 0.3325
Validation loss decreased (inf --> 0.232375).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1347963
	speed: 0.0167s/iter; left time: 257.9210s
Epoch: 2 cost time: 2.5076537132263184
Epoch: 2, Steps: 157 Train Loss: 0.1450 (Forecasting Loss:0.1447 + XiCon Loss:2.6142 x Lambda(0.0001)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2029
Validation loss decreased (0.232375 --> 0.140799).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1084034
	speed: 0.0189s/iter; left time: 288.2168s
Epoch: 3 cost time: 2.7793996334075928
Epoch: 3, Steps: 157 Train Loss: 0.1132 (Forecasting Loss:0.1129 + XiCon Loss:2.5920 x Lambda(0.0001)), Vali MSE Loss: 0.1271 Test MSE Loss: 0.1799
Validation loss decreased (0.140799 --> 0.127090).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1040823
	speed: 0.0176s/iter; left time: 265.6787s
Epoch: 4 cost time: 2.6204802989959717
Epoch: 4, Steps: 157 Train Loss: 0.1062 (Forecasting Loss:0.1060 + XiCon Loss:2.5859 x Lambda(0.0001)), Vali MSE Loss: 0.1226 Test MSE Loss: 0.1729
Validation loss decreased (0.127090 --> 0.122623).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0943996
	speed: 0.0174s/iter; left time: 259.7907s
Epoch: 5 cost time: 2.5351028442382812
Epoch: 5, Steps: 157 Train Loss: 0.1026 (Forecasting Loss:0.1023 + XiCon Loss:2.5674 x Lambda(0.0001)), Vali MSE Loss: 0.1195 Test MSE Loss: 0.1699
Validation loss decreased (0.122623 --> 0.119498).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0994085
	speed: 0.0176s/iter; left time: 260.7120s
Epoch: 6 cost time: 2.609903335571289
Epoch: 6, Steps: 157 Train Loss: 0.1009 (Forecasting Loss:0.1006 + XiCon Loss:2.5665 x Lambda(0.0001)), Vali MSE Loss: 0.1183 Test MSE Loss: 0.1678
Validation loss decreased (0.119498 --> 0.118296).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0990235
	speed: 0.0139s/iter; left time: 203.6037s
Epoch: 7 cost time: 2.045179843902588
Epoch: 7, Steps: 157 Train Loss: 0.0999 (Forecasting Loss:0.0996 + XiCon Loss:2.5580 x Lambda(0.0001)), Vali MSE Loss: 0.1169 Test MSE Loss: 0.1677
Validation loss decreased (0.118296 --> 0.116865).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.0868962
	speed: 0.0622s/iter; left time: 901.3647s
Epoch: 8 cost time: 8.968221426010132
Epoch: 8, Steps: 157 Train Loss: 0.0993 (Forecasting Loss:0.0991 + XiCon Loss:2.5580 x Lambda(0.0001)), Vali MSE Loss: 0.1171 Test MSE Loss: 0.1669
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0905173
	speed: 0.0201s/iter; left time: 288.1500s
Epoch: 9 cost time: 2.787372350692749
Epoch: 9, Steps: 157 Train Loss: 0.0991 (Forecasting Loss:0.0988 + XiCon Loss:2.5628 x Lambda(0.0001)), Vali MSE Loss: 0.1165 Test MSE Loss: 0.1664
Validation loss decreased (0.116865 --> 0.116534).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0989534
	speed: 0.0145s/iter; left time: 206.3795s
Epoch: 10 cost time: 2.165963888168335
Epoch: 10, Steps: 157 Train Loss: 0.0989 (Forecasting Loss:0.0986 + XiCon Loss:2.5610 x Lambda(0.0001)), Vali MSE Loss: 0.1164 Test MSE Loss: 0.1661
Validation loss decreased (0.116534 --> 0.116362).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1019086
	speed: 0.0137s/iter; left time: 192.3387s
Epoch: 11 cost time: 2.0744729042053223
Epoch: 11, Steps: 157 Train Loss: 0.0989 (Forecasting Loss:0.0987 + XiCon Loss:2.5616 x Lambda(0.0001)), Vali MSE Loss: 0.1163 Test MSE Loss: 0.1660
Validation loss decreased (0.116362 --> 0.116336).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1070220
	speed: 0.0163s/iter; left time: 225.8897s
Epoch: 12 cost time: 2.396601915359497
Epoch: 12, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0986 + XiCon Loss:2.5610 x Lambda(0.0001)), Vali MSE Loss: 0.1164 Test MSE Loss: 0.1661
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0884366
	speed: 0.0167s/iter; left time: 228.5465s
Epoch: 13 cost time: 2.467519521713257
Epoch: 13, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0985 + XiCon Loss:2.5535 x Lambda(0.0001)), Vali MSE Loss: 0.1165 Test MSE Loss: 0.1661
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1012990
	speed: 0.0178s/iter; left time: 241.3346s
Epoch: 14 cost time: 2.638881206512451
Epoch: 14, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0985 + XiCon Loss:2.5605 x Lambda(0.0001)), Vali MSE Loss: 0.1164 Test MSE Loss: 0.1661
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.0944467
	speed: 0.0176s/iter; left time: 236.2793s
Epoch: 15 cost time: 2.574631929397583
Epoch: 15, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0985 + XiCon Loss:2.5652 x Lambda(0.0001)), Vali MSE Loss: 0.1166 Test MSE Loss: 0.1661
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0924628
	speed: 0.0166s/iter; left time: 219.5653s
Epoch: 16 cost time: 2.4298744201660156
Epoch: 16, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0984 + XiCon Loss:2.5595 x Lambda(0.0001)), Vali MSE Loss: 0.1164 Test MSE Loss: 0.1661
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0958088
	speed: 0.0160s/iter; left time: 208.8624s
Epoch: 17 cost time: 2.42802095413208
Epoch: 17, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0986 + XiCon Loss:2.5585 x Lambda(0.0001)), Vali MSE Loss: 0.1165 Test MSE Loss: 0.1661
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.0867881
	speed: 0.0185s/iter; left time: 239.0796s
Epoch: 18 cost time: 2.6326746940612793
Epoch: 18, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5619 x Lambda(0.0001)), Vali MSE Loss: 0.1164 Test MSE Loss: 0.1661
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0944940
	speed: 0.0163s/iter; left time: 208.8590s
Epoch: 19 cost time: 2.427595376968384
Epoch: 19, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5616 x Lambda(0.0001)), Vali MSE Loss: 0.1165 Test MSE Loss: 0.1661
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.0969505
	speed: 0.0160s/iter; left time: 201.5779s
Epoch: 20 cost time: 2.3205807209014893
Epoch: 20, Steps: 157 Train Loss: 0.0987 (Forecasting Loss:0.0985 + XiCon Loss:2.5625 x Lambda(0.0001)), Vali MSE Loss: 0.1164 Test MSE Loss: 0.1661
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1118145
	speed: 0.0166s/iter; left time: 206.5318s
Epoch: 21 cost time: 2.468592882156372
Epoch: 21, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5615 x Lambda(0.0001)), Vali MSE Loss: 0.1165 Test MSE Loss: 0.1661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.13053561747074127, mae:0.2015279084444046, mape:0.46483132243156433, mspe:10.20245361328125 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8970
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2187514
	speed: 0.0178s/iter; left time: 278.0070s
Epoch: 1 cost time: 2.6392009258270264
Epoch: 1, Steps: 157 Train Loss: 0.3057 (Forecasting Loss:0.3055 + XiCon Loss:2.5106 x Lambda(0.0001)), Vali MSE Loss: 0.2334 Test MSE Loss: 0.3343
Validation loss decreased (inf --> 0.233443).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1220073
	speed: 0.0174s/iter; left time: 268.5934s
Epoch: 2 cost time: 2.5843207836151123
Epoch: 2, Steps: 157 Train Loss: 0.1418 (Forecasting Loss:0.1415 + XiCon Loss:2.5638 x Lambda(0.0001)), Vali MSE Loss: 0.1393 Test MSE Loss: 0.2011
Validation loss decreased (0.233443 --> 0.139346).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1149767
	speed: 0.0157s/iter; left time: 240.6884s
Epoch: 3 cost time: 2.37357759475708
Epoch: 3, Steps: 157 Train Loss: 0.1118 (Forecasting Loss:0.1116 + XiCon Loss:2.5637 x Lambda(0.0001)), Vali MSE Loss: 0.1276 Test MSE Loss: 0.1850
Validation loss decreased (0.139346 --> 0.127627).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1150999
	speed: 0.0155s/iter; left time: 235.0294s
Epoch: 4 cost time: 2.4664692878723145
Epoch: 4, Steps: 157 Train Loss: 0.1049 (Forecasting Loss:0.1046 + XiCon Loss:2.5631 x Lambda(0.0001)), Vali MSE Loss: 0.1206 Test MSE Loss: 0.1754
Validation loss decreased (0.127627 --> 0.120584).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.0881911
	speed: 0.0170s/iter; left time: 255.2653s
Epoch: 5 cost time: 2.500507354736328
Epoch: 5, Steps: 157 Train Loss: 0.1012 (Forecasting Loss:0.1009 + XiCon Loss:2.5555 x Lambda(0.0001)), Vali MSE Loss: 0.1154 Test MSE Loss: 0.1698
Validation loss decreased (0.120584 --> 0.115371).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.0915519
	speed: 0.0163s/iter; left time: 242.0340s
Epoch: 6 cost time: 2.4005954265594482
Epoch: 6, Steps: 157 Train Loss: 0.0993 (Forecasting Loss:0.0991 + XiCon Loss:2.5579 x Lambda(0.0001)), Vali MSE Loss: 0.1141 Test MSE Loss: 0.1688
Validation loss decreased (0.115371 --> 0.114106).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0874912
	speed: 0.0167s/iter; left time: 244.3458s
Epoch: 7 cost time: 2.4753406047821045
Epoch: 7, Steps: 157 Train Loss: 0.0984 (Forecasting Loss:0.0982 + XiCon Loss:2.5596 x Lambda(0.0001)), Vali MSE Loss: 0.1137 Test MSE Loss: 0.1679
Validation loss decreased (0.114106 --> 0.113680).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.0990746
	speed: 0.0177s/iter; left time: 256.0478s
Epoch: 8 cost time: 2.6419365406036377
Epoch: 8, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0977 + XiCon Loss:2.5631 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1666
Validation loss decreased (0.113680 --> 0.113079).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1183919
	speed: 0.0172s/iter; left time: 246.2398s
Epoch: 9 cost time: 2.523524284362793
Epoch: 9, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5658 x Lambda(0.0001)), Vali MSE Loss: 0.1131 Test MSE Loss: 0.1665
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0979375
	speed: 0.0179s/iter; left time: 254.5974s
Epoch: 10 cost time: 2.575394868850708
Epoch: 10, Steps: 157 Train Loss: 0.0974 (Forecasting Loss:0.0971 + XiCon Loss:2.5573 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1663
Validation loss decreased (0.113079 --> 0.112889).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1090508
	speed: 0.0169s/iter; left time: 236.5709s
Epoch: 11 cost time: 2.510061264038086
Epoch: 11, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5652 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1662
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.0978749
	speed: 0.0177s/iter; left time: 246.1166s
Epoch: 12 cost time: 2.548581600189209
Epoch: 12, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5578 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1662
Validation loss decreased (0.112889 --> 0.112716).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.0864780
	speed: 0.0160s/iter; left time: 219.8050s
Epoch: 13 cost time: 2.436474323272705
Epoch: 13, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5661 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1661
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0951735
	speed: 0.0164s/iter; left time: 222.9807s
Epoch: 14 cost time: 2.515639543533325
Epoch: 14, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5622 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1661
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.0998972
	speed: 0.0177s/iter; left time: 236.6272s
Epoch: 15 cost time: 2.641507625579834
Epoch: 15, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0970 + XiCon Loss:2.5602 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1661
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0921489
	speed: 0.0162s/iter; left time: 214.9013s
Epoch: 16 cost time: 2.4563872814178467
Epoch: 16, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5566 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1661
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1109600
	speed: 0.0193s/iter; left time: 252.2718s
Epoch: 17 cost time: 2.8214361667633057
Epoch: 17, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5527 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1661
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1087477
	speed: 0.0162s/iter; left time: 209.0962s
Epoch: 18 cost time: 2.3870885372161865
Epoch: 18, Steps: 157 Train Loss: 0.0972 (Forecasting Loss:0.0969 + XiCon Loss:2.5533 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1661
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0858984
	speed: 0.0186s/iter; left time: 237.6320s
Epoch: 19 cost time: 2.675647258758545
Epoch: 19, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5623 x Lambda(0.0001)), Vali MSE Loss: 0.1129 Test MSE Loss: 0.1661
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1015751
	speed: 0.0161s/iter; left time: 203.6396s
Epoch: 20 cost time: 2.4135122299194336
Epoch: 20, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0970 + XiCon Loss:2.5604 x Lambda(0.0001)), Vali MSE Loss: 0.1128 Test MSE Loss: 0.1661
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.0967882
	speed: 0.0160s/iter; left time: 199.0229s
Epoch: 21 cost time: 2.417341947555542
Epoch: 21, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0970 + XiCon Loss:2.5586 x Lambda(0.0001)), Vali MSE Loss: 0.1130 Test MSE Loss: 0.1661
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.0938136
	speed: 0.0173s/iter; left time: 212.7639s
Epoch: 22 cost time: 2.6577248573303223
Epoch: 22, Steps: 157 Train Loss: 0.0973 (Forecasting Loss:0.0971 + XiCon Loss:2.5542 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.13091011345386505, mae:0.20146434009075165, mape:0.45056772232055664, mspe:7.606706142425537 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:71649
train 10095
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7810
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10095
val 3415
test 3413
	iters: 100, epoch: 1 | loss: 0.2199572
	speed: 0.0179s/iter; left time: 278.8307s
Epoch: 1 cost time: 2.676492929458618
Epoch: 1, Steps: 157 Train Loss: 0.3219 (Forecasting Loss:0.3217 + XiCon Loss:2.5040 x Lambda(0.0001)), Vali MSE Loss: 0.2389 Test MSE Loss: 0.3414
Validation loss decreased (inf --> 0.238938).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1357086
	speed: 0.0167s/iter; left time: 257.4999s
Epoch: 2 cost time: 2.4765732288360596
Epoch: 2, Steps: 157 Train Loss: 0.1446 (Forecasting Loss:0.1444 + XiCon Loss:2.5263 x Lambda(0.0001)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.1961
Validation loss decreased (0.238938 --> 0.140664).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.0960351
	speed: 0.0165s/iter; left time: 251.7991s
Epoch: 3 cost time: 2.5033724308013916
Epoch: 3, Steps: 157 Train Loss: 0.1124 (Forecasting Loss:0.1121 + XiCon Loss:2.5334 x Lambda(0.0001)), Vali MSE Loss: 0.1259 Test MSE Loss: 0.1796
Validation loss decreased (0.140664 --> 0.125883).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.0954392
	speed: 0.0165s/iter; left time: 250.2693s
Epoch: 4 cost time: 2.4797959327697754
Epoch: 4, Steps: 157 Train Loss: 0.1045 (Forecasting Loss:0.1043 + XiCon Loss:2.5294 x Lambda(0.0001)), Vali MSE Loss: 0.1192 Test MSE Loss: 0.1726
Validation loss decreased (0.125883 --> 0.119180).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1145247
	speed: 0.0167s/iter; left time: 250.0876s
Epoch: 5 cost time: 2.504272222518921
Epoch: 5, Steps: 157 Train Loss: 0.1013 (Forecasting Loss:0.1011 + XiCon Loss:2.5162 x Lambda(0.0001)), Vali MSE Loss: 0.1166 Test MSE Loss: 0.1699
Validation loss decreased (0.119180 --> 0.116558).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1059959
	speed: 0.0166s/iter; left time: 246.4972s
Epoch: 6 cost time: 2.5267984867095947
Epoch: 6, Steps: 157 Train Loss: 0.0997 (Forecasting Loss:0.0994 + XiCon Loss:2.5072 x Lambda(0.0001)), Vali MSE Loss: 0.1141 Test MSE Loss: 0.1658
Validation loss decreased (0.116558 --> 0.114074).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.0962997
	speed: 0.0164s/iter; left time: 240.2261s
Epoch: 7 cost time: 2.511070489883423
Epoch: 7, Steps: 157 Train Loss: 0.0988 (Forecasting Loss:0.0985 + XiCon Loss:2.5035 x Lambda(0.0001)), Vali MSE Loss: 0.1134 Test MSE Loss: 0.1654
Validation loss decreased (0.114074 --> 0.113354).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1116660
	speed: 0.0173s/iter; left time: 250.2219s
Epoch: 8 cost time: 2.5585429668426514
Epoch: 8, Steps: 157 Train Loss: 0.0982 (Forecasting Loss:0.0979 + XiCon Loss:2.5010 x Lambda(0.0001)), Vali MSE Loss: 0.1127 Test MSE Loss: 0.1641
Validation loss decreased (0.113354 --> 0.112694).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.0924233
	speed: 0.0541s/iter; left time: 775.7276s
Epoch: 9 cost time: 7.830117225646973
Epoch: 9, Steps: 157 Train Loss: 0.0979 (Forecasting Loss:0.0977 + XiCon Loss:2.5046 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1639
Validation loss decreased (0.112694 --> 0.112273).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.0829563
	speed: 0.0220s/iter; left time: 311.6790s
Epoch: 10 cost time: 3.061628818511963
Epoch: 10, Steps: 157 Train Loss: 0.0978 (Forecasting Loss:0.0976 + XiCon Loss:2.4953 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1638
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.0875208
	speed: 0.0153s/iter; left time: 214.6523s
Epoch: 11 cost time: 2.235417604446411
Epoch: 11, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5015 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1637
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1066175
	speed: 0.0134s/iter; left time: 186.0923s
Epoch: 12 cost time: 2.0243072509765625
Epoch: 12, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5017 x Lambda(0.0001)), Vali MSE Loss: 0.1121 Test MSE Loss: 0.1636
Validation loss decreased (0.112273 --> 0.112097).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1067638
	speed: 0.0179s/iter; left time: 245.1776s
Epoch: 13 cost time: 2.6836984157562256
Epoch: 13, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5015 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.0960869
	speed: 0.0162s/iter; left time: 219.9551s
Epoch: 14 cost time: 2.4657647609710693
Epoch: 14, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.4999 x Lambda(0.0001)), Vali MSE Loss: 0.1120 Test MSE Loss: 0.1636
Validation loss decreased (0.112097 --> 0.112026).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1068697
	speed: 0.0162s/iter; left time: 216.9691s
Epoch: 15 cost time: 2.448408842086792
Epoch: 15, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.4994 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.0851554
	speed: 0.0168s/iter; left time: 222.9499s
Epoch: 16 cost time: 2.4817378520965576
Epoch: 16, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.4985 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.0840986
	speed: 0.0178s/iter; left time: 232.5566s
Epoch: 17 cost time: 2.528182029724121
Epoch: 17, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.4987 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1034188
	speed: 0.0174s/iter; left time: 225.5459s
Epoch: 18 cost time: 2.5523180961608887
Epoch: 18, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.4946 x Lambda(0.0001)), Vali MSE Loss: 0.1120 Test MSE Loss: 0.1636
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.0856842
	speed: 0.0163s/iter; left time: 208.7103s
Epoch: 19 cost time: 2.4047436714172363
Epoch: 19, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0973 + XiCon Loss:2.5028 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1008046
	speed: 0.0173s/iter; left time: 217.9529s
Epoch: 20 cost time: 2.6058261394500732
Epoch: 20, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5006 x Lambda(0.0001)), Vali MSE Loss: 0.1121 Test MSE Loss: 0.1636
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1009520
	speed: 0.0188s/iter; left time: 234.2010s
Epoch: 21 cost time: 2.8861732482910156
Epoch: 21, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.5033 x Lambda(0.0001)), Vali MSE Loss: 0.1120 Test MSE Loss: 0.1636
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1013029
	speed: 0.0182s/iter; left time: 223.3499s
Epoch: 22 cost time: 2.8464221954345703
Epoch: 22, Steps: 157 Train Loss: 0.0974 (Forecasting Loss:0.0971 + XiCon Loss:2.5043 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.0857524
	speed: 0.0184s/iter; left time: 223.3491s
Epoch: 23 cost time: 2.694239616394043
Epoch: 23, Steps: 157 Train Loss: 0.0976 (Forecasting Loss:0.0974 + XiCon Loss:2.4980 x Lambda(0.0001)), Vali MSE Loss: 0.1122 Test MSE Loss: 0.1636
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.0891440
	speed: 0.0182s/iter; left time: 218.2238s
Epoch: 24 cost time: 2.6738152503967285
Epoch: 24, Steps: 157 Train Loss: 0.0977 (Forecasting Loss:0.0974 + XiCon Loss:2.5031 x Lambda(0.0001)), Vali MSE Loss: 0.1123 Test MSE Loss: 0.1636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl96_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (53, 64, 96, 1) (53, 64, 96, 1)
test shape: (3392, 96, 1) (3392, 96, 1)
mse:0.1283874213695526, mae:0.1988191157579422, mape:0.4407108724117279, mspe:7.695815563201904 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1301+-0.00217, MAE:0.2019+-0.00458, MAPE:0.4571+-0.02280, MSPE:9.1903+-2.62356, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.01, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8767
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2358655
	speed: 0.0252s/iter; left time: 367.9653s
Epoch: 1 cost time: 3.484339714050293
Epoch: 1, Steps: 147 Train Loss: 0.3303 (Forecasting Loss:0.3278 + XiCon Loss:2.5212 x Lambda(0.001)), Vali MSE Loss: 0.2527 Test MSE Loss: 0.3559
Validation loss decreased (inf --> 0.252671).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1445225
	speed: 0.0264s/iter; left time: 381.1522s
Epoch: 2 cost time: 3.3840925693511963
Epoch: 2, Steps: 147 Train Loss: 0.1590 (Forecasting Loss:0.1566 + XiCon Loss:2.4622 x Lambda(0.001)), Vali MSE Loss: 0.1527 Test MSE Loss: 0.2157
Validation loss decreased (0.252671 --> 0.152652).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1376184
	speed: 0.0185s/iter; left time: 264.9702s
Epoch: 3 cost time: 2.6019392013549805
Epoch: 3, Steps: 147 Train Loss: 0.1276 (Forecasting Loss:0.1251 + XiCon Loss:2.4290 x Lambda(0.001)), Vali MSE Loss: 0.1418 Test MSE Loss: 0.2017
Validation loss decreased (0.152652 --> 0.141834).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1152316
	speed: 0.0188s/iter; left time: 265.8261s
Epoch: 4 cost time: 2.6003835201263428
Epoch: 4, Steps: 147 Train Loss: 0.1203 (Forecasting Loss:0.1178 + XiCon Loss:2.4348 x Lambda(0.001)), Vali MSE Loss: 0.1364 Test MSE Loss: 0.1925
Validation loss decreased (0.141834 --> 0.136431).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1216796
	speed: 0.0198s/iter; left time: 277.0174s
Epoch: 5 cost time: 2.676635503768921
Epoch: 5, Steps: 147 Train Loss: 0.1168 (Forecasting Loss:0.1143 + XiCon Loss:2.4313 x Lambda(0.001)), Vali MSE Loss: 0.1341 Test MSE Loss: 0.1895
Validation loss decreased (0.136431 --> 0.134078).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1168226
	speed: 0.0187s/iter; left time: 259.7418s
Epoch: 6 cost time: 2.6069281101226807
Epoch: 6, Steps: 147 Train Loss: 0.1148 (Forecasting Loss:0.1124 + XiCon Loss:2.4216 x Lambda(0.001)), Vali MSE Loss: 0.1316 Test MSE Loss: 0.1842
Validation loss decreased (0.134078 --> 0.131649).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1177366
	speed: 0.0183s/iter; left time: 250.7499s
Epoch: 7 cost time: 2.549206256866455
Epoch: 7, Steps: 147 Train Loss: 0.1139 (Forecasting Loss:0.1114 + XiCon Loss:2.4198 x Lambda(0.001)), Vali MSE Loss: 0.1306 Test MSE Loss: 0.1842
Validation loss decreased (0.131649 --> 0.130595).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1131319
	speed: 0.0192s/iter; left time: 260.4911s
Epoch: 8 cost time: 2.6771860122680664
Epoch: 8, Steps: 147 Train Loss: 0.1132 (Forecasting Loss:0.1108 + XiCon Loss:2.4222 x Lambda(0.001)), Vali MSE Loss: 0.1306 Test MSE Loss: 0.1830
Validation loss decreased (0.130595 --> 0.130553).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1205900
	speed: 0.0196s/iter; left time: 262.6944s
Epoch: 9 cost time: 2.783761739730835
Epoch: 9, Steps: 147 Train Loss: 0.1130 (Forecasting Loss:0.1105 + XiCon Loss:2.4274 x Lambda(0.001)), Vali MSE Loss: 0.1304 Test MSE Loss: 0.1840
Validation loss decreased (0.130553 --> 0.130398).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1045117
	speed: 0.0198s/iter; left time: 262.8795s
Epoch: 10 cost time: 2.7684102058410645
Epoch: 10, Steps: 147 Train Loss: 0.1129 (Forecasting Loss:0.1105 + XiCon Loss:2.4304 x Lambda(0.001)), Vali MSE Loss: 0.1305 Test MSE Loss: 0.1832
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1130124
	speed: 0.0191s/iter; left time: 251.2799s
Epoch: 11 cost time: 2.6958200931549072
Epoch: 11, Steps: 147 Train Loss: 0.1128 (Forecasting Loss:0.1104 + XiCon Loss:2.4214 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1830
Validation loss decreased (0.130398 --> 0.130202).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1206423
	speed: 0.0179s/iter; left time: 232.5745s
Epoch: 12 cost time: 2.5140774250030518
Epoch: 12, Steps: 147 Train Loss: 0.1128 (Forecasting Loss:0.1103 + XiCon Loss:2.4262 x Lambda(0.001)), Vali MSE Loss: 0.1301 Test MSE Loss: 0.1830
Validation loss decreased (0.130202 --> 0.130128).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1098306
	speed: 0.0185s/iter; left time: 237.1351s
Epoch: 13 cost time: 2.5740997791290283
Epoch: 13, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4220 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1143379
	speed: 0.0179s/iter; left time: 227.1170s
Epoch: 14 cost time: 2.5858399868011475
Epoch: 14, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4235 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1093227
	speed: 0.0182s/iter; left time: 227.7469s
Epoch: 15 cost time: 2.517604112625122
Epoch: 15, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4251 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1091032
	speed: 0.0184s/iter; left time: 227.5260s
Epoch: 16 cost time: 2.6567165851593018
Epoch: 16, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4197 x Lambda(0.001)), Vali MSE Loss: 0.1303 Test MSE Loss: 0.1831
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1209154
	speed: 0.0206s/iter; left time: 252.5766s
Epoch: 17 cost time: 2.9014813899993896
Epoch: 17, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4186 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1072163
	speed: 0.0185s/iter; left time: 223.3567s
Epoch: 18 cost time: 2.6082262992858887
Epoch: 18, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4199 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1117207
	speed: 0.0193s/iter; left time: 230.4353s
Epoch: 19 cost time: 2.666165828704834
Epoch: 19, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4212 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1036272
	speed: 0.0191s/iter; left time: 224.9836s
Epoch: 20 cost time: 2.699319362640381
Epoch: 20, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1102 + XiCon Loss:2.4229 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1043682
	speed: 0.0184s/iter; left time: 215.0209s
Epoch: 21 cost time: 2.5907678604125977
Epoch: 21, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4171 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1089726
	speed: 0.0183s/iter; left time: 210.7527s
Epoch: 22 cost time: 2.5544567108154297
Epoch: 22, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4212 x Lambda(0.001)), Vali MSE Loss: 0.1302 Test MSE Loss: 0.1831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14264610409736633, mae:0.22333873808383942, mape:0.5590954422950745, mspe:22.112834930419922 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8756
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2236719
	speed: 0.0206s/iter; left time: 301.2149s
Epoch: 1 cost time: 2.846511125564575
Epoch: 1, Steps: 147 Train Loss: 0.3193 (Forecasting Loss:0.3168 + XiCon Loss:2.4943 x Lambda(0.001)), Vali MSE Loss: 0.2435 Test MSE Loss: 0.3467
Validation loss decreased (inf --> 0.243474).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1452386
	speed: 0.0183s/iter; left time: 263.8832s
Epoch: 2 cost time: 2.6268274784088135
Epoch: 2, Steps: 147 Train Loss: 0.1586 (Forecasting Loss:0.1561 + XiCon Loss:2.5222 x Lambda(0.001)), Vali MSE Loss: 0.1512 Test MSE Loss: 0.2140
Validation loss decreased (0.243474 --> 0.151180).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1238325
	speed: 0.0184s/iter; left time: 263.8485s
Epoch: 3 cost time: 2.616302728652954
Epoch: 3, Steps: 147 Train Loss: 0.1264 (Forecasting Loss:0.1239 + XiCon Loss:2.4824 x Lambda(0.001)), Vali MSE Loss: 0.1381 Test MSE Loss: 0.1937
Validation loss decreased (0.151180 --> 0.138138).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1165911
	speed: 0.0191s/iter; left time: 270.9887s
Epoch: 4 cost time: 2.718472480773926
Epoch: 4, Steps: 147 Train Loss: 0.1194 (Forecasting Loss:0.1169 + XiCon Loss:2.4563 x Lambda(0.001)), Vali MSE Loss: 0.1310 Test MSE Loss: 0.1865
Validation loss decreased (0.138138 --> 0.130984).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1168408
	speed: 0.0184s/iter; left time: 257.7964s
Epoch: 5 cost time: 2.559401750564575
Epoch: 5, Steps: 147 Train Loss: 0.1157 (Forecasting Loss:0.1133 + XiCon Loss:2.4400 x Lambda(0.001)), Vali MSE Loss: 0.1260 Test MSE Loss: 0.1851
Validation loss decreased (0.130984 --> 0.125965).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1052925
	speed: 0.0187s/iter; left time: 259.2838s
Epoch: 6 cost time: 2.644949436187744
Epoch: 6, Steps: 147 Train Loss: 0.1139 (Forecasting Loss:0.1115 + XiCon Loss:2.4433 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1834
Validation loss decreased (0.125965 --> 0.124878).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1181236
	speed: 0.0197s/iter; left time: 270.0729s
Epoch: 7 cost time: 2.746445417404175
Epoch: 7, Steps: 147 Train Loss: 0.1130 (Forecasting Loss:0.1105 + XiCon Loss:2.4420 x Lambda(0.001)), Vali MSE Loss: 0.1239 Test MSE Loss: 0.1831
Validation loss decreased (0.124878 --> 0.123902).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1146428
	speed: 0.0203s/iter; left time: 275.6798s
Epoch: 8 cost time: 2.759888172149658
Epoch: 8, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4382 x Lambda(0.001)), Vali MSE Loss: 0.1236 Test MSE Loss: 0.1819
Validation loss decreased (0.123902 --> 0.123626).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1159407
	speed: 0.0196s/iter; left time: 262.6675s
Epoch: 9 cost time: 2.7293896675109863
Epoch: 9, Steps: 147 Train Loss: 0.1122 (Forecasting Loss:0.1098 + XiCon Loss:2.4337 x Lambda(0.001)), Vali MSE Loss: 0.1234 Test MSE Loss: 0.1819
Validation loss decreased (0.123626 --> 0.123401).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1185882
	speed: 0.0194s/iter; left time: 257.4957s
Epoch: 10 cost time: 2.6695549488067627
Epoch: 10, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4458 x Lambda(0.001)), Vali MSE Loss: 0.1235 Test MSE Loss: 0.1814
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1162373
	speed: 0.0186s/iter; left time: 243.9082s
Epoch: 11 cost time: 2.5953850746154785
Epoch: 11, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4337 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
Validation loss decreased (0.123401 --> 0.123228).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1113358
	speed: 0.0181s/iter; left time: 235.5203s
Epoch: 12 cost time: 2.603537082672119
Epoch: 12, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4387 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1814
Validation loss decreased (0.123228 --> 0.123219).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1189489
	speed: 0.0190s/iter; left time: 243.8410s
Epoch: 13 cost time: 2.6668519973754883
Epoch: 13, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4311 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1814
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1115806
	speed: 0.0194s/iter; left time: 246.6419s
Epoch: 14 cost time: 2.7175064086914062
Epoch: 14, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4394 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1051951
	speed: 0.0195s/iter; left time: 244.4141s
Epoch: 15 cost time: 2.6913135051727295
Epoch: 15, Steps: 147 Train Loss: 0.1118 (Forecasting Loss:0.1094 + XiCon Loss:2.4326 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
Validation loss decreased (0.123219 --> 0.123195).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1124804
	speed: 0.0199s/iter; left time: 246.5652s
Epoch: 16 cost time: 2.840252637863159
Epoch: 16, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4404 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1073074
	speed: 0.0185s/iter; left time: 227.0042s
Epoch: 17 cost time: 2.632044792175293
Epoch: 17, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4414 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1211322
	speed: 0.0195s/iter; left time: 236.0521s
Epoch: 18 cost time: 2.6766953468322754
Epoch: 18, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4405 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1159103
	speed: 0.0199s/iter; left time: 237.9100s
Epoch: 19 cost time: 2.945451498031616
Epoch: 19, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4450 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1057058
	speed: 0.0192s/iter; left time: 226.2753s
Epoch: 20 cost time: 2.6427581310272217
Epoch: 20, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4378 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
Validation loss decreased (0.123195 --> 0.123175).  Saving model ...
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1067758
	speed: 0.0180s/iter; left time: 209.4888s
Epoch: 21 cost time: 2.5736284255981445
Epoch: 21, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4345 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1167357
	speed: 0.0183s/iter; left time: 210.6438s
Epoch: 22 cost time: 2.560713052749634
Epoch: 22, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4404 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1180840
	speed: 0.0188s/iter; left time: 213.4750s
Epoch: 23 cost time: 2.6269118785858154
Epoch: 23, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4358 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1141598
	speed: 0.0196s/iter; left time: 219.5743s
Epoch: 24 cost time: 2.693415641784668
Epoch: 24, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4400 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1097554
	speed: 0.0196s/iter; left time: 217.2544s
Epoch: 25 cost time: 2.723503351211548
Epoch: 25, Steps: 147 Train Loss: 0.1118 (Forecasting Loss:0.1094 + XiCon Loss:2.4418 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1144628
	speed: 0.0188s/iter; left time: 204.9515s
Epoch: 26 cost time: 2.5997841358184814
Epoch: 26, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4350 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1056458
	speed: 0.0198s/iter; left time: 213.0753s
Epoch: 27 cost time: 2.776759147644043
Epoch: 27, Steps: 147 Train Loss: 0.1118 (Forecasting Loss:0.1094 + XiCon Loss:2.4393 x Lambda(0.001)), Vali MSE Loss: 0.1233 Test MSE Loss: 0.1815
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1080377
	speed: 0.0198s/iter; left time: 210.6339s
Epoch: 28 cost time: 2.707559108734131
Epoch: 28, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4358 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1106651
	speed: 0.0189s/iter; left time: 197.8574s
Epoch: 29 cost time: 2.6816489696502686
Epoch: 29, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1094 + XiCon Loss:2.4347 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1155086
	speed: 0.0186s/iter; left time: 192.1149s
Epoch: 30 cost time: 2.6403260231018066
Epoch: 30, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4408 x Lambda(0.001)), Vali MSE Loss: 0.1232 Test MSE Loss: 0.1815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.1413697749376297, mae:0.22155825793743134, mape:0.5410493016242981, mspe:19.401811599731445 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 5.1969
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2250956
	speed: 0.0237s/iter; left time: 345.3952s
Epoch: 1 cost time: 3.3379974365234375
Epoch: 1, Steps: 147 Train Loss: 0.3176 (Forecasting Loss:0.3151 + XiCon Loss:2.5100 x Lambda(0.001)), Vali MSE Loss: 0.2427 Test MSE Loss: 0.3452
Validation loss decreased (inf --> 0.242662).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1400532
	speed: 0.0163s/iter; left time: 236.0991s
Epoch: 2 cost time: 2.2730560302734375
Epoch: 2, Steps: 147 Train Loss: 0.1558 (Forecasting Loss:0.1533 + XiCon Loss:2.4659 x Lambda(0.001)), Vali MSE Loss: 0.1516 Test MSE Loss: 0.2149
Validation loss decreased (0.242662 --> 0.151599).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1251627
	speed: 0.0150s/iter; left time: 214.6061s
Epoch: 3 cost time: 2.198773145675659
Epoch: 3, Steps: 147 Train Loss: 0.1260 (Forecasting Loss:0.1235 + XiCon Loss:2.4356 x Lambda(0.001)), Vali MSE Loss: 0.1384 Test MSE Loss: 0.1945
Validation loss decreased (0.151599 --> 0.138357).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1100214
	speed: 0.0178s/iter; left time: 252.3557s
Epoch: 4 cost time: 2.5480663776397705
Epoch: 4, Steps: 147 Train Loss: 0.1184 (Forecasting Loss:0.1160 + XiCon Loss:2.4330 x Lambda(0.001)), Vali MSE Loss: 0.1308 Test MSE Loss: 0.1893
Validation loss decreased (0.138357 --> 0.130750).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1245670
	speed: 0.0181s/iter; left time: 253.3204s
Epoch: 5 cost time: 2.510380983352661
Epoch: 5, Steps: 147 Train Loss: 0.1151 (Forecasting Loss:0.1127 + XiCon Loss:2.4340 x Lambda(0.001)), Vali MSE Loss: 0.1284 Test MSE Loss: 0.1833
Validation loss decreased (0.130750 --> 0.128425).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1121705
	speed: 0.0194s/iter; left time: 269.5666s
Epoch: 6 cost time: 2.86130428314209
Epoch: 6, Steps: 147 Train Loss: 0.1132 (Forecasting Loss:0.1107 + XiCon Loss:2.4299 x Lambda(0.001)), Vali MSE Loss: 0.1264 Test MSE Loss: 0.1817
Validation loss decreased (0.128425 --> 0.126442).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1206485
	speed: 0.0187s/iter; left time: 256.9418s
Epoch: 7 cost time: 2.6876957416534424
Epoch: 7, Steps: 147 Train Loss: 0.1123 (Forecasting Loss:0.1098 + XiCon Loss:2.4247 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1820
Validation loss decreased (0.126442 --> 0.125244).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1068555
	speed: 0.0179s/iter; left time: 243.5916s
Epoch: 8 cost time: 2.5318398475646973
Epoch: 8, Steps: 147 Train Loss: 0.1117 (Forecasting Loss:0.1093 + XiCon Loss:2.4203 x Lambda(0.001)), Vali MSE Loss: 0.1253 Test MSE Loss: 0.1805
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1035026
	speed: 0.0173s/iter; left time: 232.0046s
Epoch: 9 cost time: 2.4617676734924316
Epoch: 9, Steps: 147 Train Loss: 0.1115 (Forecasting Loss:0.1091 + XiCon Loss:2.4280 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1805
Validation loss decreased (0.125244 --> 0.124917).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1105060
	speed: 0.0201s/iter; left time: 266.3429s
Epoch: 10 cost time: 2.7493746280670166
Epoch: 10, Steps: 147 Train Loss: 0.1114 (Forecasting Loss:0.1089 + XiCon Loss:2.4310 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1806
Validation loss decreased (0.124917 --> 0.124725).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1134838
	speed: 0.0186s/iter; left time: 244.2370s
Epoch: 11 cost time: 2.559927463531494
Epoch: 11, Steps: 147 Train Loss: 0.1113 (Forecasting Loss:0.1088 + XiCon Loss:2.4323 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1131017
	speed: 0.0185s/iter; left time: 240.8240s
Epoch: 12 cost time: 2.6249868869781494
Epoch: 12, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4215 x Lambda(0.001)), Vali MSE Loss: 0.1248 Test MSE Loss: 0.1802
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1108058
	speed: 0.0192s/iter; left time: 246.1288s
Epoch: 13 cost time: 2.700856924057007
Epoch: 13, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4319 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
Validation loss decreased (0.124725 --> 0.124652).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1155957
	speed: 0.0198s/iter; left time: 251.4693s
Epoch: 14 cost time: 2.790064573287964
Epoch: 14, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4271 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1186478
	speed: 0.0182s/iter; left time: 228.7968s
Epoch: 15 cost time: 2.637197732925415
Epoch: 15, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4266 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1131101
	speed: 0.0187s/iter; left time: 231.7429s
Epoch: 16 cost time: 2.6763522624969482
Epoch: 16, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4338 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1097507
	speed: 0.0187s/iter; left time: 228.4674s
Epoch: 17 cost time: 2.6915054321289062
Epoch: 17, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4333 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1104929
	speed: 0.0178s/iter; left time: 215.8525s
Epoch: 18 cost time: 2.5186400413513184
Epoch: 18, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4310 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1145714
	speed: 0.0181s/iter; left time: 216.1729s
Epoch: 19 cost time: 2.5346827507019043
Epoch: 19, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4287 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1130725
	speed: 0.0195s/iter; left time: 230.3149s
Epoch: 20 cost time: 2.683868169784546
Epoch: 20, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4243 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1802
Validation loss decreased (0.124652 --> 0.124644).  Saving model ...
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1132504
	speed: 0.0180s/iter; left time: 209.7055s
Epoch: 21 cost time: 2.5462963581085205
Epoch: 21, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4293 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1111851
	speed: 0.0190s/iter; left time: 219.3119s
Epoch: 22 cost time: 2.6769638061523438
Epoch: 22, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4309 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1123189
	speed: 0.0197s/iter; left time: 224.0322s
Epoch: 23 cost time: 3.0425102710723877
Epoch: 23, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4328 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1128874
	speed: 0.0178s/iter; left time: 199.9214s
Epoch: 24 cost time: 2.5095767974853516
Epoch: 24, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4298 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1088028
	speed: 0.0180s/iter; left time: 199.2552s
Epoch: 25 cost time: 2.599520444869995
Epoch: 25, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4261 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1147996
	speed: 0.0185s/iter; left time: 201.6191s
Epoch: 26 cost time: 2.6569414138793945
Epoch: 26, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4349 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1201381
	speed: 0.0182s/iter; left time: 196.3233s
Epoch: 27 cost time: 2.592690944671631
Epoch: 27, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4254 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1155688
	speed: 0.0230s/iter; left time: 244.3208s
Epoch: 28 cost time: 3.267332077026367
Epoch: 28, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4278 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1097849
	speed: 0.0200s/iter; left time: 209.2637s
Epoch: 29 cost time: 2.7454779148101807
Epoch: 29, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1087 + XiCon Loss:2.4227 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1112886
	speed: 0.0189s/iter; left time: 195.7226s
Epoch: 30 cost time: 2.6020803451538086
Epoch: 30, Steps: 147 Train Loss: 0.1112 (Forecasting Loss:0.1088 + XiCon Loss:2.4279 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.1402590125799179, mae:0.22020241618156433, mape:0.541678249835968, mspe:20.781530380249023 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7142
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2405059
	speed: 0.0181s/iter; left time: 264.2358s
Epoch: 1 cost time: 2.5599594116210938
Epoch: 1, Steps: 147 Train Loss: 0.3221 (Forecasting Loss:0.3196 + XiCon Loss:2.4996 x Lambda(0.001)), Vali MSE Loss: 0.2525 Test MSE Loss: 0.3556
Validation loss decreased (inf --> 0.252462).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1489196
	speed: 0.0181s/iter; left time: 260.9806s
Epoch: 2 cost time: 2.5222690105438232
Epoch: 2, Steps: 147 Train Loss: 0.1581 (Forecasting Loss:0.1556 + XiCon Loss:2.4866 x Lambda(0.001)), Vali MSE Loss: 0.1545 Test MSE Loss: 0.2159
Validation loss decreased (0.252462 --> 0.154539).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1195514
	speed: 0.0190s/iter; left time: 272.3603s
Epoch: 3 cost time: 2.7497332096099854
Epoch: 3, Steps: 147 Train Loss: 0.1269 (Forecasting Loss:0.1244 + XiCon Loss:2.4408 x Lambda(0.001)), Vali MSE Loss: 0.1381 Test MSE Loss: 0.1952
Validation loss decreased (0.154539 --> 0.138111).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1123463
	speed: 0.0192s/iter; left time: 271.5544s
Epoch: 4 cost time: 2.733712673187256
Epoch: 4, Steps: 147 Train Loss: 0.1193 (Forecasting Loss:0.1169 + XiCon Loss:2.4210 x Lambda(0.001)), Vali MSE Loss: 0.1308 Test MSE Loss: 0.1887
Validation loss decreased (0.138111 --> 0.130784).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1080811
	speed: 0.0187s/iter; left time: 261.8643s
Epoch: 5 cost time: 2.615199089050293
Epoch: 5, Steps: 147 Train Loss: 0.1157 (Forecasting Loss:0.1133 + XiCon Loss:2.4212 x Lambda(0.001)), Vali MSE Loss: 0.1279 Test MSE Loss: 0.1829
Validation loss decreased (0.130784 --> 0.127882).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1074211
	speed: 0.0189s/iter; left time: 261.8015s
Epoch: 6 cost time: 2.625676393508911
Epoch: 6, Steps: 147 Train Loss: 0.1139 (Forecasting Loss:0.1115 + XiCon Loss:2.4217 x Lambda(0.001)), Vali MSE Loss: 0.1263 Test MSE Loss: 0.1818
Validation loss decreased (0.127882 --> 0.126299).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1188956
	speed: 0.0176s/iter; left time: 241.6613s
Epoch: 7 cost time: 2.489978551864624
Epoch: 7, Steps: 147 Train Loss: 0.1130 (Forecasting Loss:0.1106 + XiCon Loss:2.4212 x Lambda(0.001)), Vali MSE Loss: 0.1253 Test MSE Loss: 0.1816
Validation loss decreased (0.126299 --> 0.125275).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1096640
	speed: 0.0185s/iter; left time: 251.2070s
Epoch: 8 cost time: 2.723860740661621
Epoch: 8, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1101 + XiCon Loss:2.4172 x Lambda(0.001)), Vali MSE Loss: 0.1250 Test MSE Loss: 0.1811
Validation loss decreased (0.125275 --> 0.125013).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1105558
	speed: 0.0181s/iter; left time: 243.6262s
Epoch: 9 cost time: 2.5464580059051514
Epoch: 9, Steps: 147 Train Loss: 0.1122 (Forecasting Loss:0.1098 + XiCon Loss:2.4190 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1806
Validation loss decreased (0.125013 --> 0.124921).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1075210
	speed: 0.0193s/iter; left time: 256.1391s
Epoch: 10 cost time: 2.775278329849243
Epoch: 10, Steps: 147 Train Loss: 0.1121 (Forecasting Loss:0.1097 + XiCon Loss:2.4235 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1803
Validation loss decreased (0.124921 --> 0.124713).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1110683
	speed: 0.0636s/iter; left time: 835.0658s
Epoch: 11 cost time: 7.938467979431152
Epoch: 11, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4151 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1799
Validation loss decreased (0.124713 --> 0.124679).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1133694
	speed: 0.0188s/iter; left time: 244.7354s
Epoch: 12 cost time: 2.5536341667175293
Epoch: 12, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4264 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
Validation loss decreased (0.124679 --> 0.124650).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1082713
	speed: 0.0160s/iter; left time: 205.9117s
Epoch: 13 cost time: 2.2873148918151855
Epoch: 13, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4243 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
Validation loss decreased (0.124650 --> 0.124594).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1086708
	speed: 0.0171s/iter; left time: 216.6689s
Epoch: 14 cost time: 2.493011474609375
Epoch: 14, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4218 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1093448
	speed: 0.0189s/iter; left time: 236.6439s
Epoch: 15 cost time: 2.610919237136841
Epoch: 15, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4234 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
Validation loss decreased (0.124594 --> 0.124582).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1109874
	speed: 0.0185s/iter; left time: 229.9238s
Epoch: 16 cost time: 2.607217788696289
Epoch: 16, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4200 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1084730
	speed: 0.0188s/iter; left time: 230.3242s
Epoch: 17 cost time: 2.7061495780944824
Epoch: 17, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4246 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1800
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1104443
	speed: 0.0183s/iter; left time: 221.7962s
Epoch: 18 cost time: 2.588057279586792
Epoch: 18, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4150 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1056157
	speed: 0.0194s/iter; left time: 232.2363s
Epoch: 19 cost time: 2.699723482131958
Epoch: 19, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4237 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1800
Validation loss decreased (0.124582 --> 0.124515).  Saving model ...
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1214300
	speed: 0.0190s/iter; left time: 224.8561s
Epoch: 20 cost time: 2.6750717163085938
Epoch: 20, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4262 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1154468
	speed: 0.0191s/iter; left time: 222.1657s
Epoch: 21 cost time: 2.627781867980957
Epoch: 21, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4268 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1133179
	speed: 0.0195s/iter; left time: 224.3542s
Epoch: 22 cost time: 2.70474910736084
Epoch: 22, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4249 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1139581
	speed: 0.0185s/iter; left time: 209.8316s
Epoch: 23 cost time: 2.575092315673828
Epoch: 23, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4199 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1064643
	speed: 0.0248s/iter; left time: 278.7455s
Epoch: 24 cost time: 3.267308235168457
Epoch: 24, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4176 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1208065
	speed: 0.0184s/iter; left time: 203.4524s
Epoch: 25 cost time: 2.650812864303589
Epoch: 25, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4126 x Lambda(0.001)), Vali MSE Loss: 0.1247 Test MSE Loss: 0.1800
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1158308
	speed: 0.0187s/iter; left time: 204.3523s
Epoch: 26 cost time: 2.6448910236358643
Epoch: 26, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1096 + XiCon Loss:2.4174 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1127876
	speed: 0.0224s/iter; left time: 241.0197s
Epoch: 27 cost time: 3.038060426712036
Epoch: 27, Steps: 147 Train Loss: 0.1119 (Forecasting Loss:0.1095 + XiCon Loss:2.4198 x Lambda(0.001)), Vali MSE Loss: 0.1245 Test MSE Loss: 0.1800
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1107088
	speed: 0.0200s/iter; left time: 212.7878s
Epoch: 28 cost time: 2.763202428817749
Epoch: 28, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4224 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1101581
	speed: 0.0184s/iter; left time: 192.6558s
Epoch: 29 cost time: 2.535433292388916
Epoch: 29, Steps: 147 Train Loss: 0.1120 (Forecasting Loss:0.1095 + XiCon Loss:2.4208 x Lambda(0.001)), Vali MSE Loss: 0.1246 Test MSE Loss: 0.1800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14051814377307892, mae:0.2194768488407135, mape:0.5438128113746643, mspe:20.749988555908203 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9988
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 0.2400132
	speed: 0.0181s/iter; left time: 264.1276s
Epoch: 1 cost time: 2.5075066089630127
Epoch: 1, Steps: 147 Train Loss: 0.3308 (Forecasting Loss:0.3282 + XiCon Loss:2.5183 x Lambda(0.001)), Vali MSE Loss: 0.2529 Test MSE Loss: 0.3587
Validation loss decreased (inf --> 0.252879).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1472454
	speed: 0.0197s/iter; left time: 284.8459s
Epoch: 2 cost time: 2.7438161373138428
Epoch: 2, Steps: 147 Train Loss: 0.1598 (Forecasting Loss:0.1573 + XiCon Loss:2.5027 x Lambda(0.001)), Vali MSE Loss: 0.1542 Test MSE Loss: 0.2195
Validation loss decreased (0.252879 --> 0.154162).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1342589
	speed: 0.0195s/iter; left time: 279.2673s
Epoch: 3 cost time: 2.688283681869507
Epoch: 3, Steps: 147 Train Loss: 0.1280 (Forecasting Loss:0.1255 + XiCon Loss:2.4762 x Lambda(0.001)), Vali MSE Loss: 0.1369 Test MSE Loss: 0.1937
Validation loss decreased (0.154162 --> 0.136910).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1236585
	speed: 0.0190s/iter; left time: 269.1942s
Epoch: 4 cost time: 2.637439489364624
Epoch: 4, Steps: 147 Train Loss: 0.1201 (Forecasting Loss:0.1177 + XiCon Loss:2.4624 x Lambda(0.001)), Vali MSE Loss: 0.1311 Test MSE Loss: 0.1895
Validation loss decreased (0.136910 --> 0.131058).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1160991
	speed: 0.0192s/iter; left time: 269.6646s
Epoch: 5 cost time: 2.6861963272094727
Epoch: 5, Steps: 147 Train Loss: 0.1164 (Forecasting Loss:0.1140 + XiCon Loss:2.4640 x Lambda(0.001)), Vali MSE Loss: 0.1279 Test MSE Loss: 0.1827
Validation loss decreased (0.131058 --> 0.127858).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1068390
	speed: 0.0189s/iter; left time: 261.6280s
Epoch: 6 cost time: 2.6486949920654297
Epoch: 6, Steps: 147 Train Loss: 0.1145 (Forecasting Loss:0.1121 + XiCon Loss:2.4578 x Lambda(0.001)), Vali MSE Loss: 0.1266 Test MSE Loss: 0.1833
Validation loss decreased (0.127858 --> 0.126624).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1139632
	speed: 0.0176s/iter; left time: 242.0415s
Epoch: 7 cost time: 2.5276520252227783
Epoch: 7, Steps: 147 Train Loss: 0.1136 (Forecasting Loss:0.1111 + XiCon Loss:2.4492 x Lambda(0.001)), Vali MSE Loss: 0.1260 Test MSE Loss: 0.1840
Validation loss decreased (0.126624 --> 0.125985).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1151886
	speed: 0.0185s/iter; left time: 251.7038s
Epoch: 8 cost time: 2.7023537158966064
Epoch: 8, Steps: 147 Train Loss: 0.1131 (Forecasting Loss:0.1106 + XiCon Loss:2.4582 x Lambda(0.001)), Vali MSE Loss: 0.1254 Test MSE Loss: 0.1809
Validation loss decreased (0.125985 --> 0.125411).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1097876
	speed: 0.0183s/iter; left time: 245.7031s
Epoch: 9 cost time: 2.5481066703796387
Epoch: 9, Steps: 147 Train Loss: 0.1127 (Forecasting Loss:0.1103 + XiCon Loss:2.4497 x Lambda(0.001)), Vali MSE Loss: 0.1252 Test MSE Loss: 0.1816
Validation loss decreased (0.125411 --> 0.125151).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1134237
	speed: 0.0192s/iter; left time: 255.1541s
Epoch: 10 cost time: 2.6912126541137695
Epoch: 10, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1101 + XiCon Loss:2.4475 x Lambda(0.001)), Vali MSE Loss: 0.1251 Test MSE Loss: 0.1817
Validation loss decreased (0.125151 --> 0.125069).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1107540
	speed: 0.0194s/iter; left time: 254.1324s
Epoch: 11 cost time: 2.6833267211914062
Epoch: 11, Steps: 147 Train Loss: 0.1126 (Forecasting Loss:0.1102 + XiCon Loss:2.4491 x Lambda(0.001)), Vali MSE Loss: 0.1250 Test MSE Loss: 0.1813
Validation loss decreased (0.125069 --> 0.124977).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1101989
	speed: 0.0199s/iter; left time: 258.3621s
Epoch: 12 cost time: 2.683849573135376
Epoch: 12, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1101 + XiCon Loss:2.4515 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
Validation loss decreased (0.124977 --> 0.124923).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1127941
	speed: 0.0177s/iter; left time: 227.6071s
Epoch: 13 cost time: 2.5167229175567627
Epoch: 13, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4487 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1191349
	speed: 0.0196s/iter; left time: 248.9637s
Epoch: 14 cost time: 2.7177915573120117
Epoch: 14, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4511 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
Validation loss decreased (0.124923 --> 0.124877).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1138634
	speed: 0.0199s/iter; left time: 249.9553s
Epoch: 15 cost time: 2.780529737472534
Epoch: 15, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1100 + XiCon Loss:2.4544 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1103399
	speed: 0.0184s/iter; left time: 228.0761s
Epoch: 16 cost time: 2.581430196762085
Epoch: 16, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1100 + XiCon Loss:2.4493 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1057199
	speed: 0.0176s/iter; left time: 215.9639s
Epoch: 17 cost time: 2.533892869949341
Epoch: 17, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1100 + XiCon Loss:2.4519 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
Validation loss decreased (0.124877 --> 0.124857).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1067442
	speed: 0.0211s/iter; left time: 254.8099s
Epoch: 18 cost time: 2.998114585876465
Epoch: 18, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1100 + XiCon Loss:2.4437 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1155483
	speed: 0.0186s/iter; left time: 222.5590s
Epoch: 19 cost time: 2.6177830696105957
Epoch: 19, Steps: 147 Train Loss: 0.1124 (Forecasting Loss:0.1100 + XiCon Loss:2.4472 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1113161
	speed: 0.0194s/iter; left time: 229.6193s
Epoch: 20 cost time: 2.7032980918884277
Epoch: 20, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4533 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1074525
	speed: 0.0185s/iter; left time: 215.6948s
Epoch: 21 cost time: 2.664268732070923
Epoch: 21, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4491 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1132643
	speed: 0.0197s/iter; left time: 227.2936s
Epoch: 22 cost time: 4.191105604171753
Epoch: 22, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4466 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1104882
	speed: 0.0390s/iter; left time: 443.2603s
Epoch: 23 cost time: 4.691450357437134
Epoch: 23, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4521 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1146773
	speed: 0.0182s/iter; left time: 204.4378s
Epoch: 24 cost time: 2.4741058349609375
Epoch: 24, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4555 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1188283
	speed: 0.0154s/iter; left time: 170.1403s
Epoch: 25 cost time: 2.1795601844787598
Epoch: 25, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4488 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1159462
	speed: 0.0178s/iter; left time: 194.5671s
Epoch: 26 cost time: 2.492544651031494
Epoch: 26, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1100 + XiCon Loss:2.4497 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1084940
	speed: 0.0184s/iter; left time: 198.4135s
Epoch: 27 cost time: 2.595672607421875
Epoch: 27, Steps: 147 Train Loss: 0.1125 (Forecasting Loss:0.1101 + XiCon Loss:2.4532 x Lambda(0.001)), Vali MSE Loss: 0.1249 Test MSE Loss: 0.1811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14129319787025452, mae:0.22098557651042938, mape:0.5466593503952026, mspe:21.046735763549805 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1412+-0.00116, MAE:0.2211+-0.00183, MAPE:0.5465+-0.00918, MSPE:20.8186+-1.20071, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.01, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=1440, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.01, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9452
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2693188
	speed: 0.0239s/iter; left time: 322.2917s
Epoch: 1 cost time: 3.1469504833221436
Epoch: 1, Steps: 136 Train Loss: 0.3624 (Forecasting Loss:0.3373 + XiCon Loss:2.5129 x Lambda(0.01)), Vali MSE Loss: 0.2672 Test MSE Loss: 0.3776
Validation loss decreased (inf --> 0.267181).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1824092
	speed: 0.0211s/iter; left time: 281.5895s
Epoch: 2 cost time: 2.729200601577759
Epoch: 2, Steps: 136 Train Loss: 0.1961 (Forecasting Loss:0.1719 + XiCon Loss:2.4157 x Lambda(0.01)), Vali MSE Loss: 0.1798 Test MSE Loss: 0.2512
Validation loss decreased (0.267181 --> 0.179755).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1648441
	speed: 0.0209s/iter; left time: 277.1130s
Epoch: 3 cost time: 2.729285478591919
Epoch: 3, Steps: 136 Train Loss: 0.1648 (Forecasting Loss:0.1410 + XiCon Loss:2.3786 x Lambda(0.01)), Vali MSE Loss: 0.1633 Test MSE Loss: 0.2315
Validation loss decreased (0.179755 --> 0.163344).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1536701
	speed: 0.0193s/iter; left time: 252.5378s
Epoch: 4 cost time: 2.568249225616455
Epoch: 4, Steps: 136 Train Loss: 0.1567 (Forecasting Loss:0.1331 + XiCon Loss:2.3580 x Lambda(0.01)), Vali MSE Loss: 0.1581 Test MSE Loss: 0.2151
Validation loss decreased (0.163344 --> 0.158072).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1549506
	speed: 0.0243s/iter; left time: 314.9582s
Epoch: 5 cost time: 3.1513655185699463
Epoch: 5, Steps: 136 Train Loss: 0.1528 (Forecasting Loss:0.1292 + XiCon Loss:2.3549 x Lambda(0.01)), Vali MSE Loss: 0.1572 Test MSE Loss: 0.2129
Validation loss decreased (0.158072 --> 0.157217).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1531852
	speed: 0.0195s/iter; left time: 250.2328s
Epoch: 6 cost time: 2.6365251541137695
Epoch: 6, Steps: 136 Train Loss: 0.1508 (Forecasting Loss:0.1273 + XiCon Loss:2.3465 x Lambda(0.01)), Vali MSE Loss: 0.1568 Test MSE Loss: 0.2139
Validation loss decreased (0.157217 --> 0.156796).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1464099
	speed: 0.0203s/iter; left time: 258.1243s
Epoch: 7 cost time: 2.681727886199951
Epoch: 7, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1263 + XiCon Loss:2.3420 x Lambda(0.01)), Vali MSE Loss: 0.1550 Test MSE Loss: 0.2144
Validation loss decreased (0.156796 --> 0.154958).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1437819
	speed: 0.0221s/iter; left time: 277.7499s
Epoch: 8 cost time: 2.8427164554595947
Epoch: 8, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1257 + XiCon Loss:2.3388 x Lambda(0.01)), Vali MSE Loss: 0.1565 Test MSE Loss: 0.2138
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1540801
	speed: 0.0206s/iter; left time: 256.1792s
Epoch: 9 cost time: 2.800359010696411
Epoch: 9, Steps: 136 Train Loss: 0.1488 (Forecasting Loss:0.1254 + XiCon Loss:2.3415 x Lambda(0.01)), Vali MSE Loss: 0.1556 Test MSE Loss: 0.2132
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1488462
	speed: 0.0212s/iter; left time: 259.7169s
Epoch: 10 cost time: 2.7345495223999023
Epoch: 10, Steps: 136 Train Loss: 0.1487 (Forecasting Loss:0.1253 + XiCon Loss:2.3423 x Lambda(0.01)), Vali MSE Loss: 0.1557 Test MSE Loss: 0.2130
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1493967
	speed: 0.0212s/iter; left time: 257.4973s
Epoch: 11 cost time: 2.816418409347534
Epoch: 11, Steps: 136 Train Loss: 0.1485 (Forecasting Loss:0.1252 + XiCon Loss:2.3367 x Lambda(0.01)), Vali MSE Loss: 0.1563 Test MSE Loss: 0.2125
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1539229
	speed: 0.0204s/iter; left time: 245.2579s
Epoch: 12 cost time: 2.6913557052612305
Epoch: 12, Steps: 136 Train Loss: 0.1485 (Forecasting Loss:0.1251 + XiCon Loss:2.3407 x Lambda(0.01)), Vali MSE Loss: 0.1561 Test MSE Loss: 0.2130
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1531821
	speed: 0.0207s/iter; left time: 245.8248s
Epoch: 13 cost time: 2.7187023162841797
Epoch: 13, Steps: 136 Train Loss: 0.1484 (Forecasting Loss:0.1251 + XiCon Loss:2.3352 x Lambda(0.01)), Vali MSE Loss: 0.1559 Test MSE Loss: 0.2130
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1577988
	speed: 0.0202s/iter; left time: 236.6071s
Epoch: 14 cost time: 2.6488559246063232
Epoch: 14, Steps: 136 Train Loss: 0.1485 (Forecasting Loss:0.1251 + XiCon Loss:2.3451 x Lambda(0.01)), Vali MSE Loss: 0.1559 Test MSE Loss: 0.2131
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1435342
	speed: 0.0208s/iter; left time: 241.0620s
Epoch: 15 cost time: 2.717663049697876
Epoch: 15, Steps: 136 Train Loss: 0.1484 (Forecasting Loss:0.1250 + XiCon Loss:2.3374 x Lambda(0.01)), Vali MSE Loss: 0.1560 Test MSE Loss: 0.2131
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1543479
	speed: 0.0194s/iter; left time: 222.4501s
Epoch: 16 cost time: 2.5615086555480957
Epoch: 16, Steps: 136 Train Loss: 0.1484 (Forecasting Loss:0.1250 + XiCon Loss:2.3384 x Lambda(0.01)), Vali MSE Loss: 0.1560 Test MSE Loss: 0.2131
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1404078
	speed: 0.0215s/iter; left time: 243.6612s
Epoch: 17 cost time: 2.905186891555786
Epoch: 17, Steps: 136 Train Loss: 0.1484 (Forecasting Loss:0.1250 + XiCon Loss:2.3398 x Lambda(0.01)), Vali MSE Loss: 0.1559 Test MSE Loss: 0.2131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.17741553485393524, mae:0.2513721287250519, mape:0.6249879002571106, mspe:28.9140682220459 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.7175
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2642567
	speed: 0.0206s/iter; left time: 278.5141s
Epoch: 1 cost time: 2.8596575260162354
Epoch: 1, Steps: 136 Train Loss: 0.3608 (Forecasting Loss:0.3358 + XiCon Loss:2.4992 x Lambda(0.01)), Vali MSE Loss: 0.2650 Test MSE Loss: 0.3800
Validation loss decreased (inf --> 0.265032).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1805266
	speed: 0.0219s/iter; left time: 292.5473s
Epoch: 2 cost time: 2.7982888221740723
Epoch: 2, Steps: 136 Train Loss: 0.1971 (Forecasting Loss:0.1728 + XiCon Loss:2.4267 x Lambda(0.01)), Vali MSE Loss: 0.1685 Test MSE Loss: 0.2505
Validation loss decreased (0.265032 --> 0.168548).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1703934
	speed: 0.0206s/iter; left time: 272.3671s
Epoch: 3 cost time: 2.6890201568603516
Epoch: 3, Steps: 136 Train Loss: 0.1665 (Forecasting Loss:0.1428 + XiCon Loss:2.3711 x Lambda(0.01)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2240
Validation loss decreased (0.168548 --> 0.152854).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1520672
	speed: 0.0205s/iter; left time: 268.1517s
Epoch: 4 cost time: 2.689009666442871
Epoch: 4, Steps: 136 Train Loss: 0.1588 (Forecasting Loss:0.1351 + XiCon Loss:2.3689 x Lambda(0.01)), Vali MSE Loss: 0.1454 Test MSE Loss: 0.2148
Validation loss decreased (0.152854 --> 0.145406).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1417903
	speed: 0.0227s/iter; left time: 293.8105s
Epoch: 5 cost time: 2.9646475315093994
Epoch: 5, Steps: 136 Train Loss: 0.1549 (Forecasting Loss:0.1312 + XiCon Loss:2.3643 x Lambda(0.01)), Vali MSE Loss: 0.1414 Test MSE Loss: 0.2214
Validation loss decreased (0.145406 --> 0.141373).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1526479
	speed: 0.0217s/iter; left time: 277.9611s
Epoch: 6 cost time: 2.8576090335845947
Epoch: 6, Steps: 136 Train Loss: 0.1530 (Forecasting Loss:0.1294 + XiCon Loss:2.3657 x Lambda(0.01)), Vali MSE Loss: 0.1386 Test MSE Loss: 0.2178
Validation loss decreased (0.141373 --> 0.138561).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1463466
	speed: 0.0232s/iter; left time: 294.7726s
Epoch: 7 cost time: 3.016127109527588
Epoch: 7, Steps: 136 Train Loss: 0.1519 (Forecasting Loss:0.1283 + XiCon Loss:2.3593 x Lambda(0.01)), Vali MSE Loss: 0.1377 Test MSE Loss: 0.2158
Validation loss decreased (0.138561 --> 0.137721).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1506855
	speed: 0.0228s/iter; left time: 286.1017s
Epoch: 8 cost time: 2.9747090339660645
Epoch: 8, Steps: 136 Train Loss: 0.1514 (Forecasting Loss:0.1277 + XiCon Loss:2.3668 x Lambda(0.01)), Vali MSE Loss: 0.1372 Test MSE Loss: 0.2168
Validation loss decreased (0.137721 --> 0.137215).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1520501
	speed: 0.0231s/iter; left time: 286.1507s
Epoch: 9 cost time: 2.9866955280303955
Epoch: 9, Steps: 136 Train Loss: 0.1510 (Forecasting Loss:0.1274 + XiCon Loss:2.3618 x Lambda(0.01)), Vali MSE Loss: 0.1372 Test MSE Loss: 0.2145
Validation loss decreased (0.137215 --> 0.137154).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1368272
	speed: 0.0231s/iter; left time: 283.3708s
Epoch: 10 cost time: 3.0181734561920166
Epoch: 10, Steps: 136 Train Loss: 0.1508 (Forecasting Loss:0.1272 + XiCon Loss:2.3652 x Lambda(0.01)), Vali MSE Loss: 0.1369 Test MSE Loss: 0.2159
Validation loss decreased (0.137154 --> 0.136930).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1476692
	speed: 0.0227s/iter; left time: 275.2307s
Epoch: 11 cost time: 3.0277554988861084
Epoch: 11, Steps: 136 Train Loss: 0.1508 (Forecasting Loss:0.1272 + XiCon Loss:2.3691 x Lambda(0.01)), Vali MSE Loss: 0.1369 Test MSE Loss: 0.2158
Validation loss decreased (0.136930 --> 0.136909).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1450449
	speed: 0.0219s/iter; left time: 262.7038s
Epoch: 12 cost time: 2.8912737369537354
Epoch: 12, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1271 + XiCon Loss:2.3605 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2156
Validation loss decreased (0.136909 --> 0.136750).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1572944
	speed: 0.0249s/iter; left time: 295.0115s
Epoch: 13 cost time: 3.198833465576172
Epoch: 13, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1270 + XiCon Loss:2.3618 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2156
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1533915
	speed: 0.0261s/iter; left time: 306.3854s
Epoch: 14 cost time: 3.415290594100952
Epoch: 14, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1270 + XiCon Loss:2.3620 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2156
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1439890
	speed: 0.0223s/iter; left time: 258.2979s
Epoch: 15 cost time: 2.9928340911865234
Epoch: 15, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1270 + XiCon Loss:2.3584 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2156
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1527473
	speed: 0.0224s/iter; left time: 256.6134s
Epoch: 16 cost time: 2.97694730758667
Epoch: 16, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1270 + XiCon Loss:2.3649 x Lambda(0.01)), Vali MSE Loss: 0.1367 Test MSE Loss: 0.2157
Validation loss decreased (0.136750 --> 0.136714).  Saving model ...
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1506836
	speed: 0.0236s/iter; left time: 267.5883s
Epoch: 17 cost time: 3.065507411956787
Epoch: 17, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1270 + XiCon Loss:2.3611 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1552341
	speed: 0.0218s/iter; left time: 244.0031s
Epoch: 18 cost time: 2.8895769119262695
Epoch: 18, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1270 + XiCon Loss:2.3612 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1548684
	speed: 0.0215s/iter; left time: 237.2843s
Epoch: 19 cost time: 2.8450605869293213
Epoch: 19, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1270 + XiCon Loss:2.3659 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1527946
	speed: 0.0249s/iter; left time: 271.3239s
Epoch: 20 cost time: 3.3588650226593018
Epoch: 20, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1270 + XiCon Loss:2.3575 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1546500
	speed: 0.0227s/iter; left time: 244.9053s
Epoch: 21 cost time: 3.0035464763641357
Epoch: 21, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1270 + XiCon Loss:2.3614 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1483393
	speed: 0.0231s/iter; left time: 245.8269s
Epoch: 22 cost time: 3.043386936187744
Epoch: 22, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1270 + XiCon Loss:2.3675 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1538020
	speed: 0.0234s/iter; left time: 245.8051s
Epoch: 23 cost time: 3.1271047592163086
Epoch: 23, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1269 + XiCon Loss:2.3674 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1459700
	speed: 0.0221s/iter; left time: 228.9404s
Epoch: 24 cost time: 2.871143341064453
Epoch: 24, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1270 + XiCon Loss:2.3641 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1533757
	speed: 0.0222s/iter; left time: 226.9253s
Epoch: 25 cost time: 2.8873684406280518
Epoch: 25, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1270 + XiCon Loss:2.3648 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1553063
	speed: 0.0215s/iter; left time: 217.4372s
Epoch: 26 cost time: 2.8606297969818115
Epoch: 26, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1270 + XiCon Loss:2.3665 x Lambda(0.01)), Vali MSE Loss: 0.1368 Test MSE Loss: 0.2157
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.17463074624538422, mae:0.2567025125026703, mape:0.6637814044952393, mspe:38.77876663208008 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0211
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2634287
	speed: 0.0195s/iter; left time: 263.7604s
Epoch: 1 cost time: 2.538726568222046
Epoch: 1, Steps: 136 Train Loss: 0.3661 (Forecasting Loss:0.3412 + XiCon Loss:2.4929 x Lambda(0.01)), Vali MSE Loss: 0.2653 Test MSE Loss: 0.3811
Validation loss decreased (inf --> 0.265310).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1706992
	speed: 0.0296s/iter; left time: 395.9909s
Epoch: 2 cost time: 5.173664093017578
Epoch: 2, Steps: 136 Train Loss: 0.1957 (Forecasting Loss:0.1714 + XiCon Loss:2.4309 x Lambda(0.01)), Vali MSE Loss: 0.1693 Test MSE Loss: 0.2561
Validation loss decreased (0.265310 --> 0.169334).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1640786
	speed: 0.0361s/iter; left time: 477.8724s
Epoch: 3 cost time: 4.245637655258179
Epoch: 3, Steps: 136 Train Loss: 0.1655 (Forecasting Loss:0.1414 + XiCon Loss:2.4122 x Lambda(0.01)), Vali MSE Loss: 0.1531 Test MSE Loss: 0.2234
Validation loss decreased (0.169334 --> 0.153064).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1568203
	speed: 0.0186s/iter; left time: 242.9650s
Epoch: 4 cost time: 2.434380292892456
Epoch: 4, Steps: 136 Train Loss: 0.1573 (Forecasting Loss:0.1333 + XiCon Loss:2.4050 x Lambda(0.01)), Vali MSE Loss: 0.1501 Test MSE Loss: 0.2144
Validation loss decreased (0.153064 --> 0.150095).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1469049
	speed: 0.0171s/iter; left time: 221.0372s
Epoch: 5 cost time: 2.2397749423980713
Epoch: 5, Steps: 136 Train Loss: 0.1533 (Forecasting Loss:0.1294 + XiCon Loss:2.3918 x Lambda(0.01)), Vali MSE Loss: 0.1422 Test MSE Loss: 0.2134
Validation loss decreased (0.150095 --> 0.142183).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1454353
	speed: 0.0208s/iter; left time: 266.8518s
Epoch: 6 cost time: 2.8127007484436035
Epoch: 6, Steps: 136 Train Loss: 0.1514 (Forecasting Loss:0.1274 + XiCon Loss:2.3953 x Lambda(0.01)), Vali MSE Loss: 0.1432 Test MSE Loss: 0.2091
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1514873
	speed: 0.0222s/iter; left time: 281.1583s
Epoch: 7 cost time: 2.90341854095459
Epoch: 7, Steps: 136 Train Loss: 0.1504 (Forecasting Loss:0.1264 + XiCon Loss:2.3957 x Lambda(0.01)), Vali MSE Loss: 0.1412 Test MSE Loss: 0.2079
Validation loss decreased (0.142183 --> 0.141245).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1498095
	speed: 0.0215s/iter; left time: 270.3610s
Epoch: 8 cost time: 2.8183741569519043
Epoch: 8, Steps: 136 Train Loss: 0.1497 (Forecasting Loss:0.1258 + XiCon Loss:2.3890 x Lambda(0.01)), Vali MSE Loss: 0.1415 Test MSE Loss: 0.2075
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1547846
	speed: 0.0226s/iter; left time: 280.3464s
Epoch: 9 cost time: 2.9614522457122803
Epoch: 9, Steps: 136 Train Loss: 0.1494 (Forecasting Loss:0.1255 + XiCon Loss:2.3908 x Lambda(0.01)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.2078
Validation loss decreased (0.141245 --> 0.140714).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1515057
	speed: 0.0211s/iter; left time: 259.2832s
Epoch: 10 cost time: 2.746751308441162
Epoch: 10, Steps: 136 Train Loss: 0.1493 (Forecasting Loss:0.1254 + XiCon Loss:2.3942 x Lambda(0.01)), Vali MSE Loss: 0.1415 Test MSE Loss: 0.2071
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1438113
	speed: 0.0205s/iter; left time: 248.9651s
Epoch: 11 cost time: 2.7077810764312744
Epoch: 11, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1253 + XiCon Loss:2.3902 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2074
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1510803
	speed: 0.0201s/iter; left time: 240.7417s
Epoch: 12 cost time: 2.6499698162078857
Epoch: 12, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1252 + XiCon Loss:2.3930 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2075
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1432192
	speed: 0.0245s/iter; left time: 291.2323s
Epoch: 13 cost time: 3.1216981410980225
Epoch: 13, Steps: 136 Train Loss: 0.1492 (Forecasting Loss:0.1252 + XiCon Loss:2.3954 x Lambda(0.01)), Vali MSE Loss: 0.1410 Test MSE Loss: 0.2073
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1466767
	speed: 0.0215s/iter; left time: 251.9952s
Epoch: 14 cost time: 2.7774131298065186
Epoch: 14, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1252 + XiCon Loss:2.3899 x Lambda(0.01)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.2072
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1529749
	speed: 0.0214s/iter; left time: 248.4101s
Epoch: 15 cost time: 2.81672739982605
Epoch: 15, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1252 + XiCon Loss:2.3864 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2072
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1538724
	speed: 0.0224s/iter; left time: 256.6817s
Epoch: 16 cost time: 2.948134183883667
Epoch: 16, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1252 + XiCon Loss:2.3907 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2072
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1438395
	speed: 0.0219s/iter; left time: 247.9630s
Epoch: 17 cost time: 2.820896863937378
Epoch: 17, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1252 + XiCon Loss:2.3885 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2072
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1508965
	speed: 0.0219s/iter; left time: 244.8160s
Epoch: 18 cost time: 2.823927640914917
Epoch: 18, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1252 + XiCon Loss:2.3946 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2072
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1529440
	speed: 0.0221s/iter; left time: 244.6429s
Epoch: 19 cost time: 2.91300892829895
Epoch: 19, Steps: 136 Train Loss: 0.1491 (Forecasting Loss:0.1252 + XiCon Loss:2.3876 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2072
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.16988080739974976, mae:0.24575269222259521, mape:0.6238229274749756, mspe:32.211299896240234 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8998
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2618842
	speed: 0.0224s/iter; left time: 303.0006s
Epoch: 1 cost time: 2.9337430000305176
Epoch: 1, Steps: 136 Train Loss: 0.3614 (Forecasting Loss:0.3369 + XiCon Loss:2.4535 x Lambda(0.01)), Vali MSE Loss: 0.2654 Test MSE Loss: 0.3801
Validation loss decreased (inf --> 0.265359).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1742075
	speed: 0.0222s/iter; left time: 296.4347s
Epoch: 2 cost time: 2.997894048690796
Epoch: 2, Steps: 136 Train Loss: 0.1950 (Forecasting Loss:0.1709 + XiCon Loss:2.4022 x Lambda(0.01)), Vali MSE Loss: 0.1668 Test MSE Loss: 0.2447
Validation loss decreased (0.265359 --> 0.166842).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1702646
	speed: 0.0219s/iter; left time: 289.3101s
Epoch: 3 cost time: 2.9471025466918945
Epoch: 3, Steps: 136 Train Loss: 0.1658 (Forecasting Loss:0.1422 + XiCon Loss:2.3561 x Lambda(0.01)), Vali MSE Loss: 0.1536 Test MSE Loss: 0.2241
Validation loss decreased (0.166842 --> 0.153619).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1557602
	speed: 0.0225s/iter; left time: 294.4404s
Epoch: 4 cost time: 2.968557834625244
Epoch: 4, Steps: 136 Train Loss: 0.1587 (Forecasting Loss:0.1352 + XiCon Loss:2.3512 x Lambda(0.01)), Vali MSE Loss: 0.1490 Test MSE Loss: 0.2142
Validation loss decreased (0.153619 --> 0.149026).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1542637
	speed: 0.0225s/iter; left time: 291.0698s
Epoch: 5 cost time: 2.9724977016448975
Epoch: 5, Steps: 136 Train Loss: 0.1549 (Forecasting Loss:0.1313 + XiCon Loss:2.3583 x Lambda(0.01)), Vali MSE Loss: 0.1442 Test MSE Loss: 0.2141
Validation loss decreased (0.149026 --> 0.144200).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1548823
	speed: 0.0238s/iter; left time: 305.6317s
Epoch: 6 cost time: 3.27885365486145
Epoch: 6, Steps: 136 Train Loss: 0.1528 (Forecasting Loss:0.1292 + XiCon Loss:2.3573 x Lambda(0.01)), Vali MSE Loss: 0.1421 Test MSE Loss: 0.2148
Validation loss decreased (0.144200 --> 0.142139).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1511515
	speed: 0.0243s/iter; left time: 307.9578s
Epoch: 7 cost time: 3.171736717224121
Epoch: 7, Steps: 136 Train Loss: 0.1517 (Forecasting Loss:0.1282 + XiCon Loss:2.3491 x Lambda(0.01)), Vali MSE Loss: 0.1403 Test MSE Loss: 0.2148
Validation loss decreased (0.142139 --> 0.140318).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1527728
	speed: 0.0271s/iter; left time: 340.5897s
Epoch: 8 cost time: 3.6339945793151855
Epoch: 8, Steps: 136 Train Loss: 0.1512 (Forecasting Loss:0.1277 + XiCon Loss:2.3488 x Lambda(0.01)), Vali MSE Loss: 0.1402 Test MSE Loss: 0.2128
Validation loss decreased (0.140318 --> 0.140191).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1536338
	speed: 0.0251s/iter; left time: 312.1336s
Epoch: 9 cost time: 3.3639721870422363
Epoch: 9, Steps: 136 Train Loss: 0.1508 (Forecasting Loss:0.1274 + XiCon Loss:2.3410 x Lambda(0.01)), Vali MSE Loss: 0.1400 Test MSE Loss: 0.2120
Validation loss decreased (0.140191 --> 0.139999).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1545957
	speed: 0.0230s/iter; left time: 282.6050s
Epoch: 10 cost time: 3.02944016456604
Epoch: 10, Steps: 136 Train Loss: 0.1508 (Forecasting Loss:0.1273 + XiCon Loss:2.3413 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2124
Validation loss decreased (0.139999 --> 0.139704).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1532517
	speed: 0.0230s/iter; left time: 278.7819s
Epoch: 11 cost time: 3.0652992725372314
Epoch: 11, Steps: 136 Train Loss: 0.1507 (Forecasting Loss:0.1272 + XiCon Loss:2.3482 x Lambda(0.01)), Vali MSE Loss: 0.1398 Test MSE Loss: 0.2113
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1443689
	speed: 0.0234s/iter; left time: 280.5473s
Epoch: 12 cost time: 3.0823757648468018
Epoch: 12, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1272 + XiCon Loss:2.3404 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
Validation loss decreased (0.139704 --> 0.139690).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1502248
	speed: 0.0250s/iter; left time: 296.2422s
Epoch: 13 cost time: 3.2960550785064697
Epoch: 13, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3413 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1552552
	speed: 0.0251s/iter; left time: 294.9144s
Epoch: 14 cost time: 3.205186367034912
Epoch: 14, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1271 + XiCon Loss:2.3484 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1427707
	speed: 0.0238s/iter; left time: 275.5677s
Epoch: 15 cost time: 3.098803997039795
Epoch: 15, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3435 x Lambda(0.01)), Vali MSE Loss: 0.1396 Test MSE Loss: 0.2116
Validation loss decreased (0.139690 --> 0.139642).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1497474
	speed: 0.0239s/iter; left time: 274.3574s
Epoch: 16 cost time: 3.1481144428253174
Epoch: 16, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3435 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1598977
	speed: 0.0239s/iter; left time: 270.1496s
Epoch: 17 cost time: 3.1448516845703125
Epoch: 17, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1271 + XiCon Loss:2.3445 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1503439
	speed: 0.0235s/iter; left time: 262.5756s
Epoch: 18 cost time: 3.104715585708618
Epoch: 18, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3422 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1613566
	speed: 0.0239s/iter; left time: 264.4009s
Epoch: 19 cost time: 3.1877224445343018
Epoch: 19, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1271 + XiCon Loss:2.3446 x Lambda(0.01)), Vali MSE Loss: 0.1396 Test MSE Loss: 0.2116
Validation loss decreased (0.139642 --> 0.139624).  Saving model ...
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1458334
	speed: 0.0249s/iter; left time: 272.2203s
Epoch: 20 cost time: 3.301035165786743
Epoch: 20, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3432 x Lambda(0.01)), Vali MSE Loss: 0.1396 Test MSE Loss: 0.2116
Validation loss decreased (0.139624 --> 0.139619).  Saving model ...
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1416297
	speed: 0.0250s/iter; left time: 269.5888s
Epoch: 21 cost time: 3.2831878662109375
Epoch: 21, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1271 + XiCon Loss:2.3436 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1556433
	speed: 0.0247s/iter; left time: 263.3233s
Epoch: 22 cost time: 3.208542823791504
Epoch: 22, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3443 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1486705
	speed: 0.0234s/iter; left time: 245.4328s
Epoch: 23 cost time: 3.0461246967315674
Epoch: 23, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3418 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1601508
	speed: 0.0233s/iter; left time: 241.6627s
Epoch: 24 cost time: 3.0987541675567627
Epoch: 24, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1270 + XiCon Loss:2.3448 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1433893
	speed: 0.0233s/iter; left time: 238.8383s
Epoch: 25 cost time: 3.0643348693847656
Epoch: 25, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3385 x Lambda(0.01)), Vali MSE Loss: 0.1396 Test MSE Loss: 0.2116
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1564449
	speed: 0.0229s/iter; left time: 230.9858s
Epoch: 26 cost time: 3.084084987640381
Epoch: 26, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1271 + XiCon Loss:2.3461 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1597289
	speed: 0.0234s/iter; left time: 233.1169s
Epoch: 27 cost time: 3.081874370574951
Epoch: 27, Steps: 136 Train Loss: 0.1506 (Forecasting Loss:0.1271 + XiCon Loss:2.3472 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1416262
	speed: 0.0504s/iter; left time: 494.9116s
Epoch: 28 cost time: 7.848820209503174
Epoch: 28, Steps: 136 Train Loss: 0.1504 (Forecasting Loss:0.1270 + XiCon Loss:2.3376 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1443795
	speed: 0.0263s/iter; left time: 255.0399s
Epoch: 29 cost time: 3.3721957206726074
Epoch: 29, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3432 x Lambda(0.01)), Vali MSE Loss: 0.1397 Test MSE Loss: 0.2116
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1431885
	speed: 0.0193s/iter; left time: 184.0764s
Epoch: 30 cost time: 2.530452251434326
Epoch: 30, Steps: 136 Train Loss: 0.1505 (Forecasting Loss:0.1271 + XiCon Loss:2.3441 x Lambda(0.01)), Vali MSE Loss: 0.1396 Test MSE Loss: 0.2116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.17302095890045166, mae:0.25024598836898804, mape:0.6365838646888733, mspe:36.45753479003906 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:977505
train 8751
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8765
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8751
val 2071
test 2069
	iters: 100, epoch: 1 | loss: 0.2622925
	speed: 0.0228s/iter; left time: 307.4833s
Epoch: 1 cost time: 2.9989261627197266
Epoch: 1, Steps: 136 Train Loss: 0.3596 (Forecasting Loss:0.3346 + XiCon Loss:2.4905 x Lambda(0.01)), Vali MSE Loss: 0.2649 Test MSE Loss: 0.3789
Validation loss decreased (inf --> 0.264873).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1844925
	speed: 0.0283s/iter; left time: 378.6658s
Epoch: 2 cost time: 3.7004547119140625
Epoch: 2, Steps: 136 Train Loss: 0.1952 (Forecasting Loss:0.1710 + XiCon Loss:2.4174 x Lambda(0.01)), Vali MSE Loss: 0.1712 Test MSE Loss: 0.2389
Validation loss decreased (0.264873 --> 0.171227).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1686494
	speed: 0.0243s/iter; left time: 320.8060s
Epoch: 3 cost time: 3.173021078109741
Epoch: 3, Steps: 136 Train Loss: 0.1647 (Forecasting Loss:0.1408 + XiCon Loss:2.3926 x Lambda(0.01)), Vali MSE Loss: 0.1546 Test MSE Loss: 0.2228
Validation loss decreased (0.171227 --> 0.154638).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1563671
	speed: 0.0223s/iter; left time: 292.6111s
Epoch: 4 cost time: 2.933567523956299
Epoch: 4, Steps: 136 Train Loss: 0.1557 (Forecasting Loss:0.1319 + XiCon Loss:2.3809 x Lambda(0.01)), Vali MSE Loss: 0.1480 Test MSE Loss: 0.2176
Validation loss decreased (0.154638 --> 0.147958).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1486421
	speed: 0.0218s/iter; left time: 282.6110s
Epoch: 5 cost time: 2.9511196613311768
Epoch: 5, Steps: 136 Train Loss: 0.1515 (Forecasting Loss:0.1278 + XiCon Loss:2.3714 x Lambda(0.01)), Vali MSE Loss: 0.1448 Test MSE Loss: 0.2067
Validation loss decreased (0.147958 --> 0.144764).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1458406
	speed: 0.0215s/iter; left time: 275.9572s
Epoch: 6 cost time: 2.7985846996307373
Epoch: 6, Steps: 136 Train Loss: 0.1496 (Forecasting Loss:0.1258 + XiCon Loss:2.3735 x Lambda(0.01)), Vali MSE Loss: 0.1430 Test MSE Loss: 0.2078
Validation loss decreased (0.144764 --> 0.142994).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1509418
	speed: 0.0219s/iter; left time: 278.2292s
Epoch: 7 cost time: 2.8822529315948486
Epoch: 7, Steps: 136 Train Loss: 0.1485 (Forecasting Loss:0.1248 + XiCon Loss:2.3671 x Lambda(0.01)), Vali MSE Loss: 0.1414 Test MSE Loss: 0.2072
Validation loss decreased (0.142994 --> 0.141391).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1503928
	speed: 0.0235s/iter; left time: 294.6378s
Epoch: 8 cost time: 2.979245662689209
Epoch: 8, Steps: 136 Train Loss: 0.1480 (Forecasting Loss:0.1243 + XiCon Loss:2.3710 x Lambda(0.01)), Vali MSE Loss: 0.1413 Test MSE Loss: 0.2062
Validation loss decreased (0.141391 --> 0.141274).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1488437
	speed: 0.0213s/iter; left time: 263.9945s
Epoch: 9 cost time: 2.797380208969116
Epoch: 9, Steps: 136 Train Loss: 0.1477 (Forecasting Loss:0.1240 + XiCon Loss:2.3670 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2075
Validation loss decreased (0.141274 --> 0.140798).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1509746
	speed: 0.0216s/iter; left time: 264.9939s
Epoch: 10 cost time: 2.8269197940826416
Epoch: 10, Steps: 136 Train Loss: 0.1475 (Forecasting Loss:0.1238 + XiCon Loss:2.3677 x Lambda(0.01)), Vali MSE Loss: 0.1410 Test MSE Loss: 0.2068
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1495674
	speed: 0.0217s/iter; left time: 263.8179s
Epoch: 11 cost time: 2.801454782485962
Epoch: 11, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1238 + XiCon Loss:2.3647 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2065
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1428882
	speed: 0.0211s/iter; left time: 253.6105s
Epoch: 12 cost time: 2.8010120391845703
Epoch: 12, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3696 x Lambda(0.01)), Vali MSE Loss: 0.1411 Test MSE Loss: 0.2066
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1364797
	speed: 0.0213s/iter; left time: 252.6768s
Epoch: 13 cost time: 2.8178908824920654
Epoch: 13, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3679 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1437765
	speed: 0.0207s/iter; left time: 242.9839s
Epoch: 14 cost time: 2.7455098628997803
Epoch: 14, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3670 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1422175
	speed: 0.0210s/iter; left time: 243.6005s
Epoch: 15 cost time: 2.7375621795654297
Epoch: 15, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3688 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
Validation loss decreased (0.140798 --> 0.140786).  Saving model ...
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1490515
	speed: 0.0223s/iter; left time: 256.1415s
Epoch: 16 cost time: 2.93843150138855
Epoch: 16, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3714 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1454171
	speed: 0.0212s/iter; left time: 240.2925s
Epoch: 17 cost time: 2.8239431381225586
Epoch: 17, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3702 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1442650
	speed: 0.0217s/iter; left time: 242.5511s
Epoch: 18 cost time: 2.8438117504119873
Epoch: 18, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1236 + XiCon Loss:2.3733 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2066
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1536920
	speed: 0.0219s/iter; left time: 241.9031s
Epoch: 19 cost time: 2.89483904838562
Epoch: 19, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3665 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1538242
	speed: 0.0217s/iter; left time: 236.9302s
Epoch: 20 cost time: 2.8692214488983154
Epoch: 20, Steps: 136 Train Loss: 0.1473 (Forecasting Loss:0.1236 + XiCon Loss:2.3684 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2066
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1502692
	speed: 0.0214s/iter; left time: 230.5470s
Epoch: 21 cost time: 2.7749948501586914
Epoch: 21, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3670 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1409214
	speed: 0.0219s/iter; left time: 232.6853s
Epoch: 22 cost time: 2.9006402492523193
Epoch: 22, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3739 x Lambda(0.01)), Vali MSE Loss: 0.1407 Test MSE Loss: 0.2066
Validation loss decreased (0.140786 --> 0.140723).  Saving model ...
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1495159
	speed: 0.0232s/iter; left time: 243.4710s
Epoch: 23 cost time: 2.9908342361450195
Epoch: 23, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3709 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2066
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1495841
	speed: 0.0226s/iter; left time: 234.5109s
Epoch: 24 cost time: 2.9382736682891846
Epoch: 24, Steps: 136 Train Loss: 0.1473 (Forecasting Loss:0.1236 + XiCon Loss:2.3621 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1452636
	speed: 0.0229s/iter; left time: 234.3873s
Epoch: 25 cost time: 2.9577157497406006
Epoch: 25, Steps: 136 Train Loss: 0.1472 (Forecasting Loss:0.1236 + XiCon Loss:2.3607 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1476835
	speed: 0.0212s/iter; left time: 213.8850s
Epoch: 26 cost time: 2.7570862770080566
Epoch: 26, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3694 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2066
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1465233
	speed: 0.0224s/iter; left time: 222.9920s
Epoch: 27 cost time: 2.941662073135376
Epoch: 27, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3703 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2066
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1507781
	speed: 0.0220s/iter; left time: 215.9027s
Epoch: 28 cost time: 2.8818905353546143
Epoch: 28, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3698 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2066
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1349060
	speed: 0.0208s/iter; left time: 202.0129s
Epoch: 29 cost time: 2.7574164867401123
Epoch: 29, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3770 x Lambda(0.01)), Vali MSE Loss: 0.1409 Test MSE Loss: 0.2066
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1505747
	speed: 0.0220s/iter; left time: 210.2967s
Epoch: 30 cost time: 2.862515687942505
Epoch: 30, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1236 + XiCon Loss:2.3724 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.1432071
	speed: 0.0235s/iter; left time: 221.4177s
Epoch: 31 cost time: 3.066059112548828
Epoch: 31, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3727 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.1419711
	speed: 0.0213s/iter; left time: 197.7605s
Epoch: 32 cost time: 2.828969717025757
Epoch: 32, Steps: 136 Train Loss: 0.1474 (Forecasting Loss:0.1237 + XiCon Loss:2.3678 x Lambda(0.01)), Vali MSE Loss: 0.1408 Test MSE Loss: 0.2066
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl1440_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2069
test shape: (32, 64, 1440, 1) (32, 64, 1440, 1)
test shape: (2048, 1440, 1) (2048, 1440, 1)
mse:0.16920484602451324, mae:0.24396786093711853, mape:0.6136996150016785, mspe:29.127565383911133 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1728+-0.00422, MAE:0.2496+-0.00622, MAPE:0.6326+-0.02389, MSPE:33.0978+-5.46944, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(wnorm='ReVIN', lambda=0.001, multiscales=[96], train_ratio=0.6, save=False, task_name='long_term_forecast', is_training=1, model_id='XiCon_exp', model='XiCon', data='traffic', root_path='./dataset/traffic', data_path='traffic.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=2160, seasonal_patterns='Monthly', mask_rate=0.25, anomaly_ratio=0.25, patch_len=16, stride=8, affine=0, subtract_last=0, mixer_kernel_size=8, head_dropout=0.0, top_k=5, num_kernels=6, enc_in=1, dec_in=7, c_out=1, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=16, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=10, itr=5, train_epochs=100, batch_size=64, patience=10, learning_rate=0.005, des='Exp', loss='MSE', lradj='type1', pct_start=0.3, loss_flag=2, use_amp=False, cpu_worker=None, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2, omega=0.01, XiCon=True, AutoCon=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.1510
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2418270
	speed: 0.0281s/iter; left time: 348.0046s
Epoch: 1 cost time: 3.3406639099121094
Epoch: 1, Steps: 125 Train Loss: 0.3528 (Forecasting Loss:0.3502 + XiCon Loss:2.5567 x Lambda(0.001)), Vali MSE Loss: 0.2760 Test MSE Loss: 0.3744
Validation loss decreased (inf --> 0.276003).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1672744
	speed: 0.0247s/iter; left time: 302.7043s
Epoch: 2 cost time: 2.9995224475860596
Epoch: 2, Steps: 125 Train Loss: 0.1820 (Forecasting Loss:0.1795 + XiCon Loss:2.5021 x Lambda(0.001)), Vali MSE Loss: 0.1954 Test MSE Loss: 0.2420
Validation loss decreased (0.276003 --> 0.195384).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1510762
	speed: 0.0255s/iter; left time: 310.3698s
Epoch: 3 cost time: 3.2039966583251953
Epoch: 3, Steps: 125 Train Loss: 0.1502 (Forecasting Loss:0.1477 + XiCon Loss:2.4719 x Lambda(0.001)), Vali MSE Loss: 0.1813 Test MSE Loss: 0.2219
Validation loss decreased (0.195384 --> 0.181292).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1289928
	speed: 0.0246s/iter; left time: 296.1717s
Epoch: 4 cost time: 3.071601390838623
Epoch: 4, Steps: 125 Train Loss: 0.1425 (Forecasting Loss:0.1401 + XiCon Loss:2.4651 x Lambda(0.001)), Vali MSE Loss: 0.1824 Test MSE Loss: 0.2274
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1442225
	speed: 0.0243s/iter; left time: 288.8943s
Epoch: 5 cost time: 2.9842138290405273
Epoch: 5, Steps: 125 Train Loss: 0.1385 (Forecasting Loss:0.1360 + XiCon Loss:2.4655 x Lambda(0.001)), Vali MSE Loss: 0.1809 Test MSE Loss: 0.2193
Validation loss decreased (0.181292 --> 0.180895).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1327895
	speed: 0.0252s/iter; left time: 296.2201s
Epoch: 6 cost time: 3.124606132507324
Epoch: 6, Steps: 125 Train Loss: 0.1366 (Forecasting Loss:0.1341 + XiCon Loss:2.4748 x Lambda(0.001)), Vali MSE Loss: 0.1803 Test MSE Loss: 0.2129
Validation loss decreased (0.180895 --> 0.180322).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1310187
	speed: 0.0248s/iter; left time: 288.4179s
Epoch: 7 cost time: 3.0072455406188965
Epoch: 7, Steps: 125 Train Loss: 0.1357 (Forecasting Loss:0.1332 + XiCon Loss:2.4710 x Lambda(0.001)), Vali MSE Loss: 0.1812 Test MSE Loss: 0.2154
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1391257
	speed: 0.0245s/iter; left time: 281.9406s
Epoch: 8 cost time: 3.068647623062134
Epoch: 8, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1326 + XiCon Loss:2.4609 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
Validation loss decreased (0.180322 --> 0.180070).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1328229
	speed: 0.0655s/iter; left time: 746.6271s
Epoch: 9 cost time: 7.8840672969818115
Epoch: 9, Steps: 125 Train Loss: 0.1348 (Forecasting Loss:0.1323 + XiCon Loss:2.4643 x Lambda(0.001)), Vali MSE Loss: 0.1803 Test MSE Loss: 0.2126
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1353032
	speed: 0.0212s/iter; left time: 238.5476s
Epoch: 10 cost time: 2.598099946975708
Epoch: 10, Steps: 125 Train Loss: 0.1347 (Forecasting Loss:0.1322 + XiCon Loss:2.4641 x Lambda(0.001)), Vali MSE Loss: 0.1799 Test MSE Loss: 0.2130
Validation loss decreased (0.180070 --> 0.179932).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1443955
	speed: 0.0191s/iter; left time: 212.4921s
Epoch: 11 cost time: 2.3385815620422363
Epoch: 11, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.4681 x Lambda(0.001)), Vali MSE Loss: 0.1799 Test MSE Loss: 0.2114
Validation loss decreased (0.179932 --> 0.179853).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1387001
	speed: 0.0212s/iter; left time: 233.2425s
Epoch: 12 cost time: 2.6995961666107178
Epoch: 12, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.4608 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1291107
	speed: 0.0248s/iter; left time: 270.3248s
Epoch: 13 cost time: 3.0210423469543457
Epoch: 13, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.4667 x Lambda(0.001)), Vali MSE Loss: 0.1803 Test MSE Loss: 0.2117
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1317767
	speed: 0.0254s/iter; left time: 274.1735s
Epoch: 14 cost time: 3.152954339981079
Epoch: 14, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.4655 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1378397
	speed: 0.0240s/iter; left time: 255.9640s
Epoch: 15 cost time: 2.947079658508301
Epoch: 15, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.4696 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2117
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1398707
	speed: 0.0248s/iter; left time: 261.1530s
Epoch: 16 cost time: 3.0130019187927246
Epoch: 16, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1321 + XiCon Loss:2.4679 x Lambda(0.001)), Vali MSE Loss: 0.1799 Test MSE Loss: 0.2116
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1296229
	speed: 0.0248s/iter; left time: 258.0132s
Epoch: 17 cost time: 3.0682265758514404
Epoch: 17, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.4715 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1303521
	speed: 0.0247s/iter; left time: 253.5079s
Epoch: 18 cost time: 3.047999143600464
Epoch: 18, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.4705 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1307839
	speed: 0.0243s/iter; left time: 246.7374s
Epoch: 19 cost time: 2.9834632873535156
Epoch: 19, Steps: 125 Train Loss: 0.1344 (Forecasting Loss:0.1320 + XiCon Loss:2.4712 x Lambda(0.001)), Vali MSE Loss: 0.1800 Test MSE Loss: 0.2116
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1365240
	speed: 0.0247s/iter; left time: 248.0992s
Epoch: 20 cost time: 3.0093586444854736
Epoch: 20, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1321 + XiCon Loss:2.4654 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1429271
	speed: 0.0237s/iter; left time: 234.4169s
Epoch: 21 cost time: 2.960850954055786
Epoch: 21, Steps: 125 Train Loss: 0.1345 (Forecasting Loss:0.1320 + XiCon Loss:2.4607 x Lambda(0.001)), Vali MSE Loss: 0.1801 Test MSE Loss: 0.2116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.17389674484729767, mae:0.24890576303005219, mape:0.5952208638191223, mspe:24.608959197998047 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.9011
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2370105
	speed: 0.0268s/iter; left time: 332.8221s
Epoch: 1 cost time: 3.2788796424865723
Epoch: 1, Steps: 125 Train Loss: 0.3435 (Forecasting Loss:0.3410 + XiCon Loss:2.5262 x Lambda(0.001)), Vali MSE Loss: 0.2649 Test MSE Loss: 0.3614
Validation loss decreased (inf --> 0.264932).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1585819
	speed: 0.0261s/iter; left time: 320.4660s
Epoch: 2 cost time: 3.1528067588806152
Epoch: 2, Steps: 125 Train Loss: 0.1830 (Forecasting Loss:0.1804 + XiCon Loss:2.5706 x Lambda(0.001)), Vali MSE Loss: 0.1750 Test MSE Loss: 0.2426
Validation loss decreased (0.264932 --> 0.174999).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1467500
	speed: 0.0251s/iter; left time: 305.4968s
Epoch: 3 cost time: 3.0397090911865234
Epoch: 3, Steps: 125 Train Loss: 0.1507 (Forecasting Loss:0.1482 + XiCon Loss:2.4999 x Lambda(0.001)), Vali MSE Loss: 0.1629 Test MSE Loss: 0.2156
Validation loss decreased (0.174999 --> 0.162882).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1314696
	speed: 0.0254s/iter; left time: 306.0142s
Epoch: 4 cost time: 3.141415596008301
Epoch: 4, Steps: 125 Train Loss: 0.1427 (Forecasting Loss:0.1402 + XiCon Loss:2.4801 x Lambda(0.001)), Vali MSE Loss: 0.1546 Test MSE Loss: 0.2139
Validation loss decreased (0.162882 --> 0.154556).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1413100
	speed: 0.0257s/iter; left time: 306.3530s
Epoch: 5 cost time: 3.1835718154907227
Epoch: 5, Steps: 125 Train Loss: 0.1389 (Forecasting Loss:0.1365 + XiCon Loss:2.4761 x Lambda(0.001)), Vali MSE Loss: 0.1552 Test MSE Loss: 0.2069
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1402534
	speed: 0.0253s/iter; left time: 297.8255s
Epoch: 6 cost time: 3.0729424953460693
Epoch: 6, Steps: 125 Train Loss: 0.1372 (Forecasting Loss:0.1347 + XiCon Loss:2.4740 x Lambda(0.001)), Vali MSE Loss: 0.1517 Test MSE Loss: 0.2041
Validation loss decreased (0.154556 --> 0.151728).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1248652
	speed: 0.0247s/iter; left time: 288.1450s
Epoch: 7 cost time: 3.0302820205688477
Epoch: 7, Steps: 125 Train Loss: 0.1362 (Forecasting Loss:0.1337 + XiCon Loss:2.4723 x Lambda(0.001)), Vali MSE Loss: 0.1512 Test MSE Loss: 0.2033
Validation loss decreased (0.151728 --> 0.151190).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1297361
	speed: 0.0289s/iter; left time: 333.5940s
Epoch: 8 cost time: 3.4438536167144775
Epoch: 8, Steps: 125 Train Loss: 0.1356 (Forecasting Loss:0.1331 + XiCon Loss:2.4708 x Lambda(0.001)), Vali MSE Loss: 0.1507 Test MSE Loss: 0.2051
Validation loss decreased (0.151190 --> 0.150697).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1317610
	speed: 0.0243s/iter; left time: 277.1372s
Epoch: 9 cost time: 3.0597383975982666
Epoch: 9, Steps: 125 Train Loss: 0.1354 (Forecasting Loss:0.1329 + XiCon Loss:2.4676 x Lambda(0.001)), Vali MSE Loss: 0.1511 Test MSE Loss: 0.2036
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1377795
	speed: 0.0255s/iter; left time: 287.9251s
Epoch: 10 cost time: 3.119844436645508
Epoch: 10, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1327 + XiCon Loss:2.4685 x Lambda(0.001)), Vali MSE Loss: 0.1499 Test MSE Loss: 0.2047
Validation loss decreased (0.150697 --> 0.149920).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1329143
	speed: 0.0245s/iter; left time: 273.2059s
Epoch: 11 cost time: 3.067918539047241
Epoch: 11, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4760 x Lambda(0.001)), Vali MSE Loss: 0.1500 Test MSE Loss: 0.2045
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1318020
	speed: 0.0254s/iter; left time: 280.4514s
Epoch: 12 cost time: 3.174312114715576
Epoch: 12, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4722 x Lambda(0.001)), Vali MSE Loss: 0.1496 Test MSE Loss: 0.2047
Validation loss decreased (0.149920 --> 0.149557).  Saving model ...
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1320848
	speed: 0.0245s/iter; left time: 266.9958s
Epoch: 13 cost time: 2.99235200881958
Epoch: 13, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4661 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2049
Validation loss decreased (0.149557 --> 0.149468).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1328613
	speed: 0.0249s/iter; left time: 268.5974s
Epoch: 14 cost time: 3.0397722721099854
Epoch: 14, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4735 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
Validation loss decreased (0.149468 --> 0.149429).  Saving model ...
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1346215
	speed: 0.0251s/iter; left time: 267.7744s
Epoch: 15 cost time: 3.1599440574645996
Epoch: 15, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4751 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1300002
	speed: 0.0270s/iter; left time: 284.3390s
Epoch: 16 cost time: 3.264526844024658
Epoch: 16, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4806 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1293129
	speed: 0.0258s/iter; left time: 268.8091s
Epoch: 17 cost time: 3.1118171215057373
Epoch: 17, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1326 + XiCon Loss:2.4721 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1371285
	speed: 0.0247s/iter; left time: 253.6112s
Epoch: 18 cost time: 3.038109064102173
Epoch: 18, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4758 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
Validation loss decreased (0.149429 --> 0.149390).  Saving model ...
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1299766
	speed: 0.0248s/iter; left time: 251.3885s
Epoch: 19 cost time: 3.0391931533813477
Epoch: 19, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4735 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1380363
	speed: 0.0248s/iter; left time: 248.3724s
Epoch: 20 cost time: 3.0019783973693848
Epoch: 20, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4720 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1406748
	speed: 0.0257s/iter; left time: 254.7401s
Epoch: 21 cost time: 3.1064023971557617
Epoch: 21, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4718 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1301615
	speed: 0.0245s/iter; left time: 239.7013s
Epoch: 22 cost time: 2.9808754920959473
Epoch: 22, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4722 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1316706
	speed: 0.0273s/iter; left time: 263.1543s
Epoch: 23 cost time: 3.2797696590423584
Epoch: 23, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4672 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1289710
	speed: 0.0259s/iter; left time: 246.5488s
Epoch: 24 cost time: 3.174147844314575
Epoch: 24, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4728 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1354342
	speed: 0.0247s/iter; left time: 232.1988s
Epoch: 25 cost time: 3.0443859100341797
Epoch: 25, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1326 + XiCon Loss:2.4671 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1321603
	speed: 0.0254s/iter; left time: 235.4712s
Epoch: 26 cost time: 3.136835813522339
Epoch: 26, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4720 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
Validation loss decreased (0.149390 --> 0.149386).  Saving model ...
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1336712
	speed: 0.0253s/iter; left time: 231.4027s
Epoch: 27 cost time: 3.068866491317749
Epoch: 27, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1326 + XiCon Loss:2.4705 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1368534
	speed: 0.0406s/iter; left time: 366.4629s
Epoch: 28 cost time: 5.437769174575806
Epoch: 28, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4650 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1393304
	speed: 0.0501s/iter; left time: 446.0598s
Epoch: 29 cost time: 5.537373065948486
Epoch: 29, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4673 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1421119
	speed: 0.0206s/iter; left time: 180.4844s
Epoch: 30 cost time: 2.5294928550720215
Epoch: 30, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1325 + XiCon Loss:2.4732 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.1480422
	speed: 0.0190s/iter; left time: 164.3711s
Epoch: 31 cost time: 2.3343305587768555
Epoch: 31, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4739 x Lambda(0.001)), Vali MSE Loss: 0.1494 Test MSE Loss: 0.2050
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.1362394
	speed: 0.0259s/iter; left time: 220.5695s
Epoch: 32 cost time: 3.1869184970855713
Epoch: 32, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4689 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.1382871
	speed: 0.0250s/iter; left time: 210.3637s
Epoch: 33 cost time: 3.05000638961792
Epoch: 33, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4699 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.1428339
	speed: 0.0254s/iter; left time: 210.2981s
Epoch: 34 cost time: 3.084162712097168
Epoch: 34, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4733 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.820766091346741e-13
	iters: 100, epoch: 35 | loss: 0.1310413
	speed: 0.0250s/iter; left time: 203.4192s
Epoch: 35 cost time: 3.0241312980651855
Epoch: 35, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4687 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.9103830456733704e-13
	iters: 100, epoch: 36 | loss: 0.1358735
	speed: 0.0261s/iter; left time: 209.3831s
Epoch: 36 cost time: 3.214864730834961
Epoch: 36, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4726 x Lambda(0.001)), Vali MSE Loss: 0.1495 Test MSE Loss: 0.2050
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16575025022029877, mae:0.24417954683303833, mape:0.607380747795105, mspe:32.23957061767578 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0323
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2394012
	speed: 0.0254s/iter; left time: 314.5945s
Epoch: 1 cost time: 3.0839200019836426
Epoch: 1, Steps: 125 Train Loss: 0.3426 (Forecasting Loss:0.3401 + XiCon Loss:2.5550 x Lambda(0.001)), Vali MSE Loss: 0.2615 Test MSE Loss: 0.3602
Validation loss decreased (inf --> 0.261455).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1650674
	speed: 0.0273s/iter; left time: 334.8311s
Epoch: 2 cost time: 3.3964264392852783
Epoch: 2, Steps: 125 Train Loss: 0.1814 (Forecasting Loss:0.1788 + XiCon Loss:2.5596 x Lambda(0.001)), Vali MSE Loss: 0.1851 Test MSE Loss: 0.2329
Validation loss decreased (0.261455 --> 0.185124).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1510756
	speed: 0.0277s/iter; left time: 336.9413s
Epoch: 3 cost time: 3.4089057445526123
Epoch: 3, Steps: 125 Train Loss: 0.1509 (Forecasting Loss:0.1484 + XiCon Loss:2.5071 x Lambda(0.001)), Vali MSE Loss: 0.1566 Test MSE Loss: 0.2272
Validation loss decreased (0.185124 --> 0.156618).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1420178
	speed: 0.0279s/iter; left time: 335.1062s
Epoch: 4 cost time: 3.381791830062866
Epoch: 4, Steps: 125 Train Loss: 0.1429 (Forecasting Loss:0.1404 + XiCon Loss:2.4946 x Lambda(0.001)), Vali MSE Loss: 0.1523 Test MSE Loss: 0.2095
Validation loss decreased (0.156618 --> 0.152287).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1340159
	speed: 0.0291s/iter; left time: 346.0696s
Epoch: 5 cost time: 3.600203037261963
Epoch: 5, Steps: 125 Train Loss: 0.1389 (Forecasting Loss:0.1364 + XiCon Loss:2.4865 x Lambda(0.001)), Vali MSE Loss: 0.1451 Test MSE Loss: 0.2123
Validation loss decreased (0.152287 --> 0.145131).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1425220
	speed: 0.0282s/iter; left time: 331.6481s
Epoch: 6 cost time: 3.4630398750305176
Epoch: 6, Steps: 125 Train Loss: 0.1371 (Forecasting Loss:0.1346 + XiCon Loss:2.4778 x Lambda(0.001)), Vali MSE Loss: 0.1445 Test MSE Loss: 0.2103
Validation loss decreased (0.145131 --> 0.144531).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1285580
	speed: 0.0275s/iter; left time: 320.8541s
Epoch: 7 cost time: 3.4020273685455322
Epoch: 7, Steps: 125 Train Loss: 0.1360 (Forecasting Loss:0.1336 + XiCon Loss:2.4730 x Lambda(0.001)), Vali MSE Loss: 0.1440 Test MSE Loss: 0.2055
Validation loss decreased (0.144531 --> 0.143962).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1333051
	speed: 0.0280s/iter; left time: 322.8226s
Epoch: 8 cost time: 3.412963628768921
Epoch: 8, Steps: 125 Train Loss: 0.1356 (Forecasting Loss:0.1331 + XiCon Loss:2.4803 x Lambda(0.001)), Vali MSE Loss: 0.1434 Test MSE Loss: 0.2080
Validation loss decreased (0.143962 --> 0.143367).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1403293
	speed: 0.0273s/iter; left time: 310.7816s
Epoch: 9 cost time: 3.3481404781341553
Epoch: 9, Steps: 125 Train Loss: 0.1353 (Forecasting Loss:0.1328 + XiCon Loss:2.4811 x Lambda(0.001)), Vali MSE Loss: 0.1427 Test MSE Loss: 0.2069
Validation loss decreased (0.143367 --> 0.142685).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1316049
	speed: 0.0273s/iter; left time: 307.5021s
Epoch: 10 cost time: 3.3097078800201416
Epoch: 10, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1327 + XiCon Loss:2.4747 x Lambda(0.001)), Vali MSE Loss: 0.1428 Test MSE Loss: 0.2073
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1374855
	speed: 0.0276s/iter; left time: 307.3045s
Epoch: 11 cost time: 3.3707168102264404
Epoch: 11, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4809 x Lambda(0.001)), Vali MSE Loss: 0.1425 Test MSE Loss: 0.2072
Validation loss decreased (0.142685 --> 0.142456).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1399763
	speed: 0.0288s/iter; left time: 317.2876s
Epoch: 12 cost time: 3.528533935546875
Epoch: 12, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4753 x Lambda(0.001)), Vali MSE Loss: 0.1426 Test MSE Loss: 0.2070
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1357322
	speed: 0.0282s/iter; left time: 307.2683s
Epoch: 13 cost time: 3.442305564880371
Epoch: 13, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4797 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
Validation loss decreased (0.142456 --> 0.142393).  Saving model ...
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1349041
	speed: 0.0281s/iter; left time: 302.6249s
Epoch: 14 cost time: 3.4490697383880615
Epoch: 14, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4820 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1360872
	speed: 0.0283s/iter; left time: 301.6092s
Epoch: 15 cost time: 3.45685076713562
Epoch: 15, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4834 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1323142
	speed: 0.0321s/iter; left time: 338.2827s
Epoch: 16 cost time: 4.004444122314453
Epoch: 16, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4833 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1430349
	speed: 0.0284s/iter; left time: 294.9404s
Epoch: 17 cost time: 3.444472074508667
Epoch: 17, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1325 + XiCon Loss:2.4816 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
Validation loss decreased (0.142393 --> 0.142380).  Saving model ...
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1416134
	speed: 0.0279s/iter; left time: 286.6720s
Epoch: 18 cost time: 3.6139023303985596
Epoch: 18, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4815 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1406337
	speed: 0.0287s/iter; left time: 291.7405s
Epoch: 19 cost time: 3.5083086490631104
Epoch: 19, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4804 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1397453
	speed: 0.0277s/iter; left time: 277.6179s
Epoch: 20 cost time: 3.436250686645508
Epoch: 20, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1325 + XiCon Loss:2.4802 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1348885
	speed: 0.0279s/iter; left time: 276.3914s
Epoch: 21 cost time: 3.456193447113037
Epoch: 21, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4808 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-09
	iters: 100, epoch: 22 | loss: 0.1404413
	speed: 0.0277s/iter; left time: 270.4585s
Epoch: 22 cost time: 3.3754873275756836
Epoch: 22, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4759 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-09
	iters: 100, epoch: 23 | loss: 0.1322141
	speed: 0.0271s/iter; left time: 261.2035s
Epoch: 23 cost time: 3.3264071941375732
Epoch: 23, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4840 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078125e-09
	iters: 100, epoch: 24 | loss: 0.1367227
	speed: 0.0283s/iter; left time: 269.1619s
Epoch: 24 cost time: 3.445634126663208
Epoch: 24, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4846 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
Validation loss decreased (0.142380 --> 0.142354).  Saving model ...
Updating learning rate to 5.960464477539063e-10
	iters: 100, epoch: 25 | loss: 0.1365365
	speed: 0.0289s/iter; left time: 271.2600s
Epoch: 25 cost time: 3.5848450660705566
Epoch: 25, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1325 + XiCon Loss:2.4795 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.9802322387695313e-10
	iters: 100, epoch: 26 | loss: 0.1337635
	speed: 0.0283s/iter; left time: 262.5846s
Epoch: 26 cost time: 3.4928488731384277
Epoch: 26, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1326 + XiCon Loss:2.4821 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4901161193847657e-10
	iters: 100, epoch: 27 | loss: 0.1312599
	speed: 0.0299s/iter; left time: 273.6141s
Epoch: 27 cost time: 5.005074739456177
Epoch: 27, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4798 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.450580596923828e-11
	iters: 100, epoch: 28 | loss: 0.1326425
	speed: 0.0532s/iter; left time: 480.1935s
Epoch: 28 cost time: 5.950947046279907
Epoch: 28, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4814 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.725290298461914e-11
	iters: 100, epoch: 29 | loss: 0.1263140
	speed: 0.0225s/iter; left time: 200.4486s
Epoch: 29 cost time: 2.7764105796813965
Epoch: 29, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4763 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.862645149230957e-11
	iters: 100, epoch: 30 | loss: 0.1367371
	speed: 0.0214s/iter; left time: 188.2208s
Epoch: 30 cost time: 2.64721417427063
Epoch: 30, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4769 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.313225746154785e-12
	iters: 100, epoch: 31 | loss: 0.1298057
	speed: 0.0297s/iter; left time: 256.9154s
Epoch: 31 cost time: 3.629760503768921
Epoch: 31, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4800 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.656612873077393e-12
	iters: 100, epoch: 32 | loss: 0.1353316
	speed: 0.0282s/iter; left time: 240.8248s
Epoch: 32 cost time: 3.462502956390381
Epoch: 32, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4836 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.3283064365386963e-12
	iters: 100, epoch: 33 | loss: 0.1280454
	speed: 0.0277s/iter; left time: 232.5531s
Epoch: 33 cost time: 3.4024853706359863
Epoch: 33, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4823 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1641532182693482e-12
	iters: 100, epoch: 34 | loss: 0.1461399
	speed: 0.0283s/iter; left time: 234.2473s
Epoch: 34 cost time: 3.4302210807800293
Epoch: 34, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4823 x Lambda(0.001)), Vali MSE Loss: 0.1424 Test MSE Loss: 0.2072
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16705717146396637, mae:0.24737852811813354, mape:0.6084787249565125, mspe:29.361799240112305 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 4.0471
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2347085
	speed: 0.0276s/iter; left time: 342.4904s
Epoch: 1 cost time: 3.4066247940063477
Epoch: 1, Steps: 125 Train Loss: 0.3459 (Forecasting Loss:0.3434 + XiCon Loss:2.5363 x Lambda(0.001)), Vali MSE Loss: 0.2622 Test MSE Loss: 0.3583
Validation loss decreased (inf --> 0.262230).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1751687
	speed: 0.0265s/iter; left time: 324.8623s
Epoch: 2 cost time: 3.250046968460083
Epoch: 2, Steps: 125 Train Loss: 0.1818 (Forecasting Loss:0.1793 + XiCon Loss:2.5782 x Lambda(0.001)), Vali MSE Loss: 0.1773 Test MSE Loss: 0.2361
Validation loss decreased (0.262230 --> 0.177318).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1525538
	speed: 0.0257s/iter; left time: 312.1413s
Epoch: 3 cost time: 3.133471965789795
Epoch: 3, Steps: 125 Train Loss: 0.1490 (Forecasting Loss:0.1464 + XiCon Loss:2.5433 x Lambda(0.001)), Vali MSE Loss: 0.1664 Test MSE Loss: 0.2134
Validation loss decreased (0.177318 --> 0.166442).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1275239
	speed: 0.0247s/iter; left time: 296.9396s
Epoch: 4 cost time: 3.0133097171783447
Epoch: 4, Steps: 125 Train Loss: 0.1414 (Forecasting Loss:0.1389 + XiCon Loss:2.5327 x Lambda(0.001)), Vali MSE Loss: 0.1584 Test MSE Loss: 0.2124
Validation loss decreased (0.166442 --> 0.158431).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1319709
	speed: 0.0264s/iter; left time: 314.1846s
Epoch: 5 cost time: 3.194796562194824
Epoch: 5, Steps: 125 Train Loss: 0.1377 (Forecasting Loss:0.1351 + XiCon Loss:2.5225 x Lambda(0.001)), Vali MSE Loss: 0.1577 Test MSE Loss: 0.2082
Validation loss decreased (0.158431 --> 0.157689).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1342864
	speed: 0.0252s/iter; left time: 296.5264s
Epoch: 6 cost time: 3.089489221572876
Epoch: 6, Steps: 125 Train Loss: 0.1360 (Forecasting Loss:0.1335 + XiCon Loss:2.5245 x Lambda(0.001)), Vali MSE Loss: 0.1537 Test MSE Loss: 0.2058
Validation loss decreased (0.157689 --> 0.153664).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1354967
	speed: 0.0267s/iter; left time: 310.9451s
Epoch: 7 cost time: 3.173487424850464
Epoch: 7, Steps: 125 Train Loss: 0.1349 (Forecasting Loss:0.1324 + XiCon Loss:2.5207 x Lambda(0.001)), Vali MSE Loss: 0.1534 Test MSE Loss: 0.2060
Validation loss decreased (0.153664 --> 0.153403).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1305118
	speed: 0.0253s/iter; left time: 291.2430s
Epoch: 8 cost time: 3.168933391571045
Epoch: 8, Steps: 125 Train Loss: 0.1346 (Forecasting Loss:0.1321 + XiCon Loss:2.5233 x Lambda(0.001)), Vali MSE Loss: 0.1541 Test MSE Loss: 0.2019
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1385804
	speed: 0.0265s/iter; left time: 302.0282s
Epoch: 9 cost time: 3.177687644958496
Epoch: 9, Steps: 125 Train Loss: 0.1343 (Forecasting Loss:0.1317 + XiCon Loss:2.5220 x Lambda(0.001)), Vali MSE Loss: 0.1539 Test MSE Loss: 0.2022
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1460387
	speed: 0.0267s/iter; left time: 300.8829s
Epoch: 10 cost time: 3.2283778190612793
Epoch: 10, Steps: 125 Train Loss: 0.1341 (Forecasting Loss:0.1315 + XiCon Loss:2.5229 x Lambda(0.001)), Vali MSE Loss: 0.1528 Test MSE Loss: 0.2025
Validation loss decreased (0.153403 --> 0.152780).  Saving model ...
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1443556
	speed: 0.0253s/iter; left time: 281.9986s
Epoch: 11 cost time: 3.0789666175842285
Epoch: 11, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1315 + XiCon Loss:2.5244 x Lambda(0.001)), Vali MSE Loss: 0.1527 Test MSE Loss: 0.2031
Validation loss decreased (0.152780 --> 0.152666).  Saving model ...
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1291818
	speed: 0.0269s/iter; left time: 296.2227s
Epoch: 12 cost time: 3.2396607398986816
Epoch: 12, Steps: 125 Train Loss: 0.1339 (Forecasting Loss:0.1314 + XiCon Loss:2.5258 x Lambda(0.001)), Vali MSE Loss: 0.1531 Test MSE Loss: 0.2028
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1277466
	speed: 0.0250s/iter; left time: 272.9367s
Epoch: 13 cost time: 3.0255088806152344
Epoch: 13, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1314 + XiCon Loss:2.5217 x Lambda(0.001)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2028
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1262452
	speed: 0.0249s/iter; left time: 268.2938s
Epoch: 14 cost time: 3.0751535892486572
Epoch: 14, Steps: 125 Train Loss: 0.1339 (Forecasting Loss:0.1314 + XiCon Loss:2.5237 x Lambda(0.001)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2029
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1292913
	speed: 0.0255s/iter; left time: 271.4908s
Epoch: 15 cost time: 3.0921363830566406
Epoch: 15, Steps: 125 Train Loss: 0.1339 (Forecasting Loss:0.1314 + XiCon Loss:2.5133 x Lambda(0.001)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2028
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1393342
	speed: 0.0272s/iter; left time: 286.7765s
Epoch: 16 cost time: 3.273817300796509
Epoch: 16, Steps: 125 Train Loss: 0.1339 (Forecasting Loss:0.1314 + XiCon Loss:2.5219 x Lambda(0.001)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2028
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1430914
	speed: 0.0248s/iter; left time: 257.6902s
Epoch: 17 cost time: 3.0259604454040527
Epoch: 17, Steps: 125 Train Loss: 0.1339 (Forecasting Loss:0.1314 + XiCon Loss:2.5240 x Lambda(0.001)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2028
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1329789
	speed: 0.0247s/iter; left time: 253.5983s
Epoch: 18 cost time: 3.047497034072876
Epoch: 18, Steps: 125 Train Loss: 0.1339 (Forecasting Loss:0.1314 + XiCon Loss:2.5232 x Lambda(0.001)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2028
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1311165
	speed: 0.0246s/iter; left time: 250.1056s
Epoch: 19 cost time: 3.050412178039551
Epoch: 19, Steps: 125 Train Loss: 0.1339 (Forecasting Loss:0.1314 + XiCon Loss:2.5206 x Lambda(0.001)), Vali MSE Loss: 0.1530 Test MSE Loss: 0.2028
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9073486328125e-08
	iters: 100, epoch: 20 | loss: 0.1369680
	speed: 0.0252s/iter; left time: 252.8521s
Epoch: 20 cost time: 3.0428953170776367
Epoch: 20, Steps: 125 Train Loss: 0.1340 (Forecasting Loss:0.1314 + XiCon Loss:2.5169 x Lambda(0.001)), Vali MSE Loss: 0.1530 Test MSE Loss: 0.2028
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.5367431640625e-09
	iters: 100, epoch: 21 | loss: 0.1437371
	speed: 0.0256s/iter; left time: 253.6983s
Epoch: 21 cost time: 3.1220591068267822
Epoch: 21, Steps: 125 Train Loss: 0.1339 (Forecasting Loss:0.1314 + XiCon Loss:2.5215 x Lambda(0.001)), Vali MSE Loss: 0.1529 Test MSE Loss: 0.2028
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.1646418571472168, mae:0.2415582239627838, mape:0.5850564241409302, mspe:25.19624900817871 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:1462785
train 8031
number of available CPU:  16
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Xi-correlation values:[0.99971502 0.97499697] ~ [0. 1.]
Autocorrelation calculation time: 3.8125
>>>>>>>start training : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8031
val 1351
test 1349
	iters: 100, epoch: 1 | loss: 0.2442375
	speed: 0.0253s/iter; left time: 314.0248s
Epoch: 1 cost time: 3.130225419998169
Epoch: 1, Steps: 125 Train Loss: 0.3504 (Forecasting Loss:0.3479 + XiCon Loss:2.5420 x Lambda(0.001)), Vali MSE Loss: 0.2710 Test MSE Loss: 0.3719
Validation loss decreased (inf --> 0.270974).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.1648766
	speed: 0.0246s/iter; left time: 301.9759s
Epoch: 2 cost time: 3.011748790740967
Epoch: 2, Steps: 125 Train Loss: 0.1826 (Forecasting Loss:0.1801 + XiCon Loss:2.5351 x Lambda(0.001)), Vali MSE Loss: 0.1810 Test MSE Loss: 0.2367
Validation loss decreased (0.270974 --> 0.180997).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.1481147
	speed: 0.0257s/iter; left time: 312.8269s
Epoch: 3 cost time: 3.1977670192718506
Epoch: 3, Steps: 125 Train Loss: 0.1501 (Forecasting Loss:0.1476 + XiCon Loss:2.5285 x Lambda(0.001)), Vali MSE Loss: 0.1729 Test MSE Loss: 0.2169
Validation loss decreased (0.180997 --> 0.172906).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.1465765
	speed: 0.0254s/iter; left time: 305.3277s
Epoch: 4 cost time: 3.1062381267547607
Epoch: 4, Steps: 125 Train Loss: 0.1430 (Forecasting Loss:0.1405 + XiCon Loss:2.5167 x Lambda(0.001)), Vali MSE Loss: 0.1639 Test MSE Loss: 0.2123
Validation loss decreased (0.172906 --> 0.163914).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.1262689
	speed: 0.0245s/iter; left time: 291.8765s
Epoch: 5 cost time: 3.008413076400757
Epoch: 5, Steps: 125 Train Loss: 0.1391 (Forecasting Loss:0.1366 + XiCon Loss:2.5021 x Lambda(0.001)), Vali MSE Loss: 0.1659 Test MSE Loss: 0.2000
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.1299388
	speed: 0.0250s/iter; left time: 294.6186s
Epoch: 6 cost time: 2.9491610527038574
Epoch: 6, Steps: 125 Train Loss: 0.1372 (Forecasting Loss:0.1347 + XiCon Loss:2.4980 x Lambda(0.001)), Vali MSE Loss: 0.1605 Test MSE Loss: 0.2044
Validation loss decreased (0.163914 --> 0.160452).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 0.1386115
	speed: 0.0190s/iter; left time: 221.7156s
Epoch: 7 cost time: 2.670698642730713
Epoch: 7, Steps: 125 Train Loss: 0.1362 (Forecasting Loss:0.1337 + XiCon Loss:2.4973 x Lambda(0.001)), Vali MSE Loss: 0.1610 Test MSE Loss: 0.2076
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 0.1349180
	speed: 0.0634s/iter; left time: 730.8287s
Epoch: 8 cost time: 7.106240510940552
Epoch: 8, Steps: 125 Train Loss: 0.1357 (Forecasting Loss:0.1332 + XiCon Loss:2.4953 x Lambda(0.001)), Vali MSE Loss: 0.1610 Test MSE Loss: 0.2040
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 0.1322784
	speed: 0.0220s/iter; left time: 250.5848s
Epoch: 9 cost time: 2.70373272895813
Epoch: 9, Steps: 125 Train Loss: 0.1354 (Forecasting Loss:0.1329 + XiCon Loss:2.4984 x Lambda(0.001)), Vali MSE Loss: 0.1587 Test MSE Loss: 0.2045
Validation loss decreased (0.160452 --> 0.158676).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 0.1378105
	speed: 0.0196s/iter; left time: 220.9342s
Epoch: 10 cost time: 2.4004769325256348
Epoch: 10, Steps: 125 Train Loss: 0.1353 (Forecasting Loss:0.1328 + XiCon Loss:2.4991 x Lambda(0.001)), Vali MSE Loss: 0.1601 Test MSE Loss: 0.2033
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 11 | loss: 0.1337771
	speed: 0.0240s/iter; left time: 267.3233s
Epoch: 11 cost time: 2.915862560272217
Epoch: 11, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1327 + XiCon Loss:2.4920 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2038
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.8828125e-06
	iters: 100, epoch: 12 | loss: 0.1292386
	speed: 0.0253s/iter; left time: 279.4303s
Epoch: 12 cost time: 3.0813426971435547
Epoch: 12, Steps: 125 Train Loss: 0.1352 (Forecasting Loss:0.1327 + XiCon Loss:2.4941 x Lambda(0.001)), Vali MSE Loss: 0.1597 Test MSE Loss: 0.2037
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.44140625e-06
	iters: 100, epoch: 13 | loss: 0.1382507
	speed: 0.0244s/iter; left time: 265.5239s
Epoch: 13 cost time: 2.971250057220459
Epoch: 13, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4959 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2037
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.220703125e-06
	iters: 100, epoch: 14 | loss: 0.1507071
	speed: 0.0270s/iter; left time: 290.4452s
Epoch: 14 cost time: 3.2657053470611572
Epoch: 14, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4901 x Lambda(0.001)), Vali MSE Loss: 0.1602 Test MSE Loss: 0.2035
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.103515625e-07
	iters: 100, epoch: 15 | loss: 0.1427411
	speed: 0.0258s/iter; left time: 274.3275s
Epoch: 15 cost time: 3.1435422897338867
Epoch: 15, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4930 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2035
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.0517578125e-07
	iters: 100, epoch: 16 | loss: 0.1429751
	speed: 0.0252s/iter; left time: 265.5170s
Epoch: 16 cost time: 3.0845513343811035
Epoch: 16, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4895 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2035
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.52587890625e-07
	iters: 100, epoch: 17 | loss: 0.1340195
	speed: 0.0259s/iter; left time: 269.6434s
Epoch: 17 cost time: 3.1015713214874268
Epoch: 17, Steps: 125 Train Loss: 0.1350 (Forecasting Loss:0.1325 + XiCon Loss:2.4907 x Lambda(0.001)), Vali MSE Loss: 0.1599 Test MSE Loss: 0.2035
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.62939453125e-08
	iters: 100, epoch: 18 | loss: 0.1367458
	speed: 0.0247s/iter; left time: 254.1284s
Epoch: 18 cost time: 3.038123369216919
Epoch: 18, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.4956 x Lambda(0.001)), Vali MSE Loss: 0.1600 Test MSE Loss: 0.2035
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.814697265625e-08
	iters: 100, epoch: 19 | loss: 0.1375895
	speed: 0.0237s/iter; left time: 240.1027s
Epoch: 19 cost time: 2.921464204788208
Epoch: 19, Steps: 125 Train Loss: 0.1351 (Forecasting Loss:0.1326 + XiCon Loss:2.5007 x Lambda(0.001)), Vali MSE Loss: 0.1599 Test MSE Loss: 0.2035
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : long_term_forecast_XiCon_exp_XiCon_traffic_ftS_sl336_ll48_pl2160_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1349
test shape: (21, 64, 2160, 1) (21, 64, 2160, 1)
test shape: (1344, 2160, 1) (1344, 2160, 1)
mse:0.16697750985622406, mae:0.24205662310123444, mape:0.5907671451568604, mspe:29.014392852783203 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1677+-0.00450, MAE:0.2448+-0.00402, MAPE:0.5974+-0.01278, MSPE:28.0842+-3.93542, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
